var StarWebPrintTrader=function(t){this.papertype=this.checkedblock=this.url=null,this.timeout=9e4,this.onTimeout=this.onError=this.onReceive=null,this.holdprint_timeout=void 0,this._json=this._url=null,null!=t&&(null!=t.url&&(this.url=t.url),null!=t.checkedblock&&(this.checkedblock=t.checkedblock),null!=t.papertype&&(this.papertype=t.papertype),null!=t.timeout&&(this.timeout=t.timeout),null!=t.holdprint_timeout&&(this.holdprint_timeout=t.holdprint_timeout))},_handlerCallback={};function _onFinish(t){var e=_handlerCallback[t.url],n=t.response;_handlerCallback[t.url]=null,200==t.htmlCode?e.onReceive({traderSuccess:n.slice(n.indexOf("&lt;success&gt;")+15,n.indexOf("&lt;/success&gt;")),traderCode:n.slice(n.indexOf("&lt;code&gt;")+12,n.indexOf("&lt;/code&gt;")),traderStatus:n.slice(n.indexOf("&lt;status&gt;")+14,n.indexOf("&lt;/status&gt;")),status:t.htmlCode,responseText:n}):e.onError({status:t.htmlCode,responseText:n})}StarWebPrintTrader.prototype._callMessageHandler=function(){var t=this;null==_handlerCallback[t._url]?(_handlerCallback[t._url]=t,webkit.messageHandlers.sendMessageHandler.postMessage(t._json)):setTimeout(function(){t._callMessageHandler()},500)},StarWebPrintTrader.prototype.sendMessage=function(t){var e="<root";null!=t.checkedblock?0==t.checkedblock&&(e+=' checkedblock="false"'):0==this.checkedblock&&(e+=' checkedblock="false"'),null!=t.papertype?"normal"==t.papertype?e+=' papertype="normal"':"black_mark"==t.papertype?e+=' papertype="black_mark"':"black_mark_and_detect_at_power_on"==t.papertype&&(e+=' papertype="black_mark_and_detect_at_power_on"'):"normal"==this.papertype?e+=' papertype="normal"':"black_mark"==this.papertype?e+=' papertype="black_mark"':"black_mark_and_detect_at_power_on"==this.papertype&&(e+=' papertype="black_mark_and_detect_at_power_on"'),null!=t.holdprint_timeout?e+=' holdprint_timeout="'+t.holdprint_timeout+'"':null!=this.holdprint_timeout&&(e+=' holdprint_timeout="'+this.holdprint_timeout+'"');var n;e=e+">"+t.request+"</root>";if(n='<StarWebPrint xmlns="http://www.star-m.jp" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Request>',n+=this._encodeEscapeSequence(e),n+="</Request>",n+="</StarWebPrint>",e="",e=null!=t.url?t.url:this.url,/^https?:\/\/(localhost|127\.0\.0\.1):8001\//.test(e.toLowerCase())&&-1!=navigator.userAgent.indexOf("webPRNTSupportMessageHandler"))this._json=JSON.stringify({url:e,body:n}),this._url=e,this._callMessageHandler();else{var i=null;if(window.XMLHttpRequest)i=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(this.onError&&this.onError({status:10001,responseText:"XMLHttpRequest is not supported."}));i=new ActiveXObject("Microsoft.XMLHTTP")}-1==navigator.userAgent.indexOf("iPad;")&&-1==navigator.userAgent.indexOf("iPhone;")&&-1==navigator.userAgent.indexOf("iPod touch;")&&-1==navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("WebPRNTSupportHTTPS")||0!=e.toLowerCase().indexOf("https://localhost")&&0!=e.toLowerCase().indexOf("https://127.0.0.1")||(e="http://"+e.substring(8));try{i.open("POST",e,!0)}catch(s){return void(this.onError&&this.onError({status:10002,responseText:s.message}))}try{null!=t.timeout?i.timeout=t.timeout:this.timeout&&(i.timeout=this.timeout)}catch(o){}i.setRequestHeader("Content-Type","text/xml; charset=UTF-8");var r=this;i.onreadystatechange=function(){if(4==i.readyState)try{if(200==i.status){var t=i.responseXML.getElementsByTagName("Response");if(0<t.length){if(r.onReceive){var e=t[0].childNodes[0].nodeValue;r.onReceive({traderSuccess:e.slice(e.indexOf("<success>")+9,e.indexOf("</success>")),traderCode:e.slice(e.indexOf("<code>")+6,e.indexOf("</code>")),traderStatus:e.slice(e.indexOf("<status>")+8,e.indexOf("</status>")),status:i.status,responseText:i.responseText})}}else r.onError&&r.onError({status:i.status,responseText:i.responseText})}else r.onError&&r.onError({status:i.status,responseText:i.responseText})}catch(n){r.onError&&r.onError({status:0,responseText:"Connection timeout occurred."})}};try{i.ontimeout=function(){r.onTimeout&&r.onTimeout()}}catch(k){}try{i.send(n)}catch(a){this.onError&&this.onError({status:10003,responseText:a.message})}}},StarWebPrintTrader.prototype._onHandlerSuccess=function(t){trader.onReceive&&trader.onReceive(t)},StarWebPrintTrader.prototype._onHandlerError=function(t){trader.onError&&trader.onError(t)},StarWebPrintTrader.prototype.isCoverOpen=function(t){return!!(32&parseInt(t.traderStatus.substr(4,2),16))},StarWebPrintTrader.prototype.isOffLine=function(t){return!!(8&parseInt(t.traderStatus.substr(4,2),16))},StarWebPrintTrader.prototype.isCompulsionSwitchClose=function(t){return!!(4&parseInt(t.traderStatus.substr(4,2),16))},StarWebPrintTrader.prototype.isEtbCommandExecute=function(t){return!!(2&parseInt(t.traderStatus.substr(4,2),16))},StarWebPrintTrader.prototype.isHighTemperatureStop=function(t){return!!(64&parseInt(t.traderStatus.substr(6,2),16))},StarWebPrintTrader.prototype.isNonRecoverableError=function(t){return!!(32&parseInt(t.traderStatus.substr(6,2),16))},StarWebPrintTrader.prototype.isAutoCutterError=function(t){return!!(8&parseInt(t.traderStatus.substr(6,2),16))},StarWebPrintTrader.prototype.isBlackMarkError=function(t){return!!(8&parseInt(t.traderStatus.substr(8,2),16))},StarWebPrintTrader.prototype.isPaperEnd=function(t){return!!(8&parseInt(t.traderStatus.substr(10,2),16))},StarWebPrintTrader.prototype.isPaperNearEnd=function(t){return!!(4&parseInt(t.traderStatus.substr(10,2),16))},StarWebPrintTrader.prototype.isPaperPresent=function(t){return!!(2&parseInt(t.traderStatus.substr(12,2),16))},StarWebPrintTrader.prototype.extractionEtbCounter=function(t){var e=0;return 64&parseInt(t.traderStatus.substr(14,2),16)&&(e|=16),32&parseInt(t.traderStatus.substr(14,2),16)&&(e|=8),8&parseInt(t.traderStatus.substr(14,2),16)&&(e|=4),4&parseInt(t.traderStatus.substr(14,2),16)&&(e|=2),2&parseInt(t.traderStatus.substr(14,2),16)&&(e|=1),e},StarWebPrintTrader.prototype._encodeEscapeSequence=function(t){var e=/[<>&]/g;return e.test(t)&&(t=t.replace(e,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;"}return"&amp;"})),t};var StarWebPrintBuilder=function(){};StarWebPrintBuilder.prototype.createAlignmentElement=function(t){var e="<alignment";return null!=t&&(e+=this._analysisEnumAttribute("position",t.position,/^(left|center|right)$/)),e+"/>"},StarWebPrintBuilder.prototype.createBarcodeElement=function(t){var e;if(null==t)throw Error("Argument is undefined.");if(e="<barcode"+this._analysisEnumAttribute("symbology",t.symbology,/^(UPCE|UPCA|JAN8|JAN13|Code39|ITF|Code128|Code93|NW7)$/),e+=this._analysisEnumAttribute("width",t.width,/^(width[2-4]|width_mode[1-9])$/),e+=this._analysisEnumAttribute("hri",t.hri,/^(false|true)$/),e+=this._analysisValueAttribute("height",t.height,1,255),null==t.data)throw Error('Argument "data" is undefined.');return(e=e+">"+this._encodeEscapeSequenceBinary(t.data))+"</barcode>"},StarWebPrintBuilder.prototype.createBitImageElement=function(t){var e="<bitimage";if(null==t)throw Error("Argument is undefined.");var n=0,i=0,r=0,s=0;if(null!=t.x&&(n=t.x),null!=t.y&&(i=t.y),null!=t.width&&(r=t.width),null!=t.height&&(s=t.height),this._analysisValueAttribute("x",n,0,65535),this._analysisValueAttribute("y",i,0,65535),e+=this._analysisValueAttribute("width",r,0,65535),e+=this._analysisValueAttribute("height",s,0,65535),null==t.context)throw Error('Argument "context" is undefined.');return(e=e+">"+this._encodeRasterImage(t.context.getImageData(n,i,r,s).data,r,s))+"</bitimage>"},StarWebPrintBuilder.prototype.createCutPaperElement=function(t){var e="<cutpaper";return null!=t&&(e+=this._analysisEnumAttribute("feed",t.feed,/^(false|true)$/),e+=this._analysisEnumAttribute("type",t.type,/^(full|partial)$/)),e+"/>"},StarWebPrintBuilder.prototype.createFeedElement=function(t){var e;if(null==t)throw Error("Argument is undefined.");if(null==t.line&&null==t.unit)throw Error('Argument "line / unit" is undefined.');return e="<feed"+this._analysisValueAttribute("line",t.line,1,255),(e+=this._analysisValueAttribute("unit",t.unit,1,255))+"/>"},StarWebPrintBuilder.prototype.createInitializationElement=function(t){var e="<initialization";return null!=t&&(e+=this._analysisEnumAttribute("reset",t.reset,/^(false|true)$/),e+=this._analysisEnumAttribute("print",t.print,/^(false|true)$/)),e+"/>"},StarWebPrintBuilder.prototype.createLogoElement=function(t){var e="<logo";return null!=t&&(e+=this._analysisEnumAttribute("width",t.width,/^(single|double)$/),e+=this._analysisEnumAttribute("height",t.height,/^(single|double)$/),e+=this._analysisValueAttribute("number",t.number,1,255)),e+"/>"},StarWebPrintBuilder.prototype.createPdf417Element=function(t){var e;if(null==t)throw Error("Argument is undefined.");if(e="<pdf417"+this._analysisEnumAttribute("level",t.level,/^(level[0-8])$/),null!=t.line&&(e=0!=t.line?e+this._analysisValueAttribute("line",t.line,3,90):e+' line="0"'),e+=this._analysisValueAttribute("column",t.column,0,30),e+=this._analysisValueAttribute("module",t.module,1,8),e+=this._analysisValueAttribute("aspect",t.aspect,1,8),null==t.data)throw Error('Argument "data" is undefined.');return(e=e+">"+this._encodeEscapeSequenceBinary(t.data))+"</pdf417>"},StarWebPrintBuilder.prototype.createPeripheralElement=function(t){var e="<peripheral";return null!=t&&(e+=this._analysisValueAttribute("channel",t.channel,1,2),e+=this._analysisValueAttribute("on",t.on,1,65535),e+=this._analysisValueAttribute("off",t.off,1,65535)),e+"/>"},StarWebPrintBuilder.prototype.createQrCodeElement=function(t){var e;if(null==t)throw Error("Argument is undefined.");if(e="<qrcode"+this._analysisEnumAttribute("model",t.model,/^(model[12])$/),e+=this._analysisEnumAttribute("level",t.level,/^(level_[lmqh])$/),e+=this._analysisValueAttribute("cell",t.cell,1,8),null==t.data)throw Error('Argument "data" is undefined.');return(e=e+">"+this._encodeEscapeSequenceBinary(t.data))+"</qrcode>"},StarWebPrintBuilder.prototype.createRawDataElement=function(t){if(null==t)throw Error("Argument is undefined.");if(null==t.data)throw Error('Argument "data" is undefined.');return(t="<rawdata>"+this._encodeBase64Binary(t.data))+"</rawdata>"},StarWebPrintBuilder.prototype.createRuledLineElement=function(t){var e="<ruledline";return null!=t&&(e+=this._analysisEnumAttribute("thickness",t.thickness,/^(thin|medium|thick|double_(thin|medium|thick))$/),e+=this._analysisValueAttribute("width",t.width,1,65535)),e+"/>"},StarWebPrintBuilder.prototype.createSoundElement=function(t){var e="<sound";return null!=t&&(e+=this._analysisValueAttribute("channel",t.channel,1,2),e+=this._analysisValueAttribute("repeat",t.repeat,1,20)),e+"/>"},StarWebPrintBuilder.prototype.createTextElement=function(t){var e;if(null==t)throw Error("Argument is undefined.");return e="<text"+this._analysisEnumAttribute("emphasis",t.emphasis,/^(false|true)$/),e+=this._analysisEnumAttribute("invert",t.invert,/^(false|true)$/),e+=this._analysisEnumAttribute("linespace",t.linespace,/^(24|32)$/),e+=this._analysisEnumAttribute("font",t.font,/^(font_[ab])$/),e+=this._analysisEnumAttribute("underline",t.underline,/^(false|true)$/),e+=this._analysisValueAttribute("characterspace",t.characterspace,0,7),e+=this._analysisValueAttribute("width",t.width,1,6),e+=this._analysisValueAttribute("height",t.height,1,6),e+=this._analysisEnumAttribute("codepage",t.codepage,/^(cp(437|737|772|774|851|852|855|857|858|860|861|862|863|864|865|866|869|874|928|932|998|999|1001|1250|1251|1252|2001|3001|3002|3011|3012|3021|3041|3840|3841|3843|3844|3845|3846|3847|3848)|utf8|blank|utf8|shift_jis|gb18030|gb2312|big5|korea)$/),e+=this._analysisEnumAttribute("international",t.international,/^(usa|france|germany|uk|denmark|sweden|italy|spain|japan|norway|denmark2|spain2|latin_america|korea|ireland|legal)$/),null!=t.data?(e+=">",e=1==t.binary?e+this._encodeEscapeSequenceBinary(t.data):e+this._encodeEscapeSequence(t.data),e+="</text>"):e+="/>",e},StarWebPrintBuilder.prototype.createHoldPrintElement=function(t){var e="<holdprint";return null!=t&&(e+=this._analysisEnumAttribute("type",t.type,/^(valid|invalid|default)$/)),e+"/>"},StarWebPrintBuilder.prototype._analysisEnumAttribute=function(t,e,n){if(null!=e){if(!n.test(e))throw Error('Argument "'+t+'" is invalid.');return" "+t+'="'+e+'"'}return""},StarWebPrintBuilder.prototype._analysisValueAttribute=function(t,e,n,i){if(null!=e){if(e<n||e>i)throw Error('Argument "'+t+'" is invalid.');return" "+t+'="'+e+'"'}return""},StarWebPrintBuilder.prototype._encodeEscapeSequence=function(t){var e=/[\\\x00-\x20\x26\x3c\x3e\x7f]/g;return e.test(t)&&(t=t.replace(e,function(t){return"\\"==t?"\\\\":"\\x"+("0"+t.charCodeAt(0).toString(16)).slice(-2)})),t},StarWebPrintBuilder.prototype._encodeEscapeSequenceBinary=function(t){var e=/[\\\x00-\x20\x26\x3c\x3e\x7f-\xff]/g;return e.test(t)&&(t=t.replace(e,function(t){return"\\"==t?"\\\\":"\\x"+("0"+t.charCodeAt(0).toString(16)).slice(-2)})),t},StarWebPrintBuilder.prototype._encodeBase64Binary=function(t){var e="",n=t.length;t+="\0\0";for(var i=0;i<n;i+=3){var r=t.charCodeAt(i)<<16|t.charCodeAt(i+1)<<8|t.charCodeAt(i+2);e=e+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&r))}switch(n%3){case 1:return e.slice(0,-2)+"==";case 2:return e.slice(0,-1)+"="}return e},StarWebPrintBuilder.prototype._encodeRasterImage=function(t,e,n){for(var i=[[-254,-126,-222,-94,-246,-118,-214,-86],[-62,-190,-30,-158,-54,-182,-22,-150],[-206,-78,-238,-110,-198,-70,-230,-102],[-14,-142,-46,-174,-6,-134,-38,-166],[-242,-114,-210,-82,-250,-122,-218,-90],[-50,-178,-18,-146,-58,-186,-26,-154],[-194,-66,-226,-98,-202,-74,-234,-106],[-2,-130,-34,-162,-10,-138,-42,-170]],r="",s=0,o=0;o<n;o++){for(var a=0,c=128,h=0;h<e;h++)((30*t[s]+59*t[s+1]+11*t[s+2])*t[s+3]+12800)/25500-t[s+3]<i[7&o][7&h]&&(a|=c),s+=4,0==(c>>=1)&&(r+=String.fromCharCode(a),a=0,c=128);128!=c&&(r+=String.fromCharCode(a))}for(t=r,r="",e=t.length,t+="\0\0",o=0;o<e;o+=3)n=t.charCodeAt(o)<<16|t.charCodeAt(o+1)<<8|t.charCodeAt(o+2),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n);switch(e%3){case 1:return r.slice(0,-2)+"==";case 2:return r.slice(0,-1)+"="}return r},function(window,undefined){function callbackInfo(){this.callbackInfoList=new Object}function CommBox(t,e,n){this.ERROR_OK="OK",this.ERROR_NOT_OPENED="NOT_OPENED",this.ERROR_MEMBER_NOT_FOUND="MEMBER_NOT_FOUND",this.ERROR_SYSTEM_ERROR="SYSTEM_ERROR",this.boxID=t,this.commBoxManager=e,this.callbackInfo=n,this.onreceive=null,this.connectionObj=this.commBoxManager.connectionObj}function CommBoxManager(){this.ERROR_OK="OK",this.ERROR_BOX_COUNT_OVER="BOX_COUNT_OVER",this.ERROR_BOX_CLIENT_OVER="BOX_CLIENT_OVER",this.ERROR_MEMBERID_ALREADY_USED="MEMBERID_ALREADY_USED",this.ERROR_ALREADY_OPENED="ALREADY_OPENED",this.ERROR_NOT_OPENED="NOT_OPENED",this.ERROR_PARAMETER_ERROR="PARAMETER_ERROR",this.ERROR_SYSTEM_ERROR="SYSTEM_ERROR",this.callbackInfo=new callbackInfo,this.commBoxList=new Array,this.connectionObj=null}function DeviceObjectSelector(){this.type2objectMap={type_scanner:"Scanner",type_keyboard:"Keyboard",type_poskeyboard:"POSKeyboard",type_msr:"MSR",type_cat:"CAT",type_cash_changer:"CashChanger",type_printer:"Printer",type_display:"Display",type_simple_serial:"SimpleSerial",type_hybrid_printer:"HybridPrinter",type_hybrid_printer2:"HybridPrinter2",type_dt:"DeviceTerminal",type_other_peripheral:"OtherPeripheral",type_storage:"GermanyFiscalElement"},this.connectionObj=null}function CashChanger(t,e){this.CONFIG_LEFT_CASH="CONFIG_LEFT_CASH",this.CONFIG_COUNT_MODE="CONFIG_COUNT_MODE",this.MODE_MANUAL_INPUT="MODE_MANUAL_INPUT",this.MODE_AUTOCOUNT="MODE_AUTO_COUNT",this.DEPOSIT_CHANGE="DEPOSIT_CHANGE",this.DEPOSIT_NOCHANGE="DEPOSIT_NOCHANGE",this.DEPOSIT_REPAY="DEPOSIT_REPAY",this.COLLECT_ALL_CASH="ALL_CASH",this.COLLECT_PART_OF_CASH="PART_OF_CASH",this.SUE_POWER_ONLINE=2001,this.SUE_POWER_OFF=2002,this.SUE_POWER_OFFLINE=2003,this.SUE_POWER_OFF_OFFLINE=2004,this.SUE_STATUS_EMPTY=11,this.SUE_STATUS_NEAREMPTY=12,this.SUE_STATUS_EMPTYOK=13,this.SUE_STATUS_FULL=21,this.SUE_STATUS_NEARFULL=22,this.SUE_STATUS_FULLOK=23,this.SUE_STATUS_JAM=31,this.SUE_STATUS_JAMOK=32,this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function CAT(t,e){this.SUE_LOGSTATUS_OK=0,this.SUE_LOGSTATUS_NEARFULL=1,this.SUE_LOGSTATUS_FULL=2,this.SUE_POWER_ONLINE=2001,this.SUE_POWER_OFF_OFFLINE=2004,this.deviceID=t,this.isCrypto=e,this.timeout=0,this.trainingMode=!1,this.connectionObj=null}function DeviceTerminal(t,e){this.deviceID=t,this.isCrypto=e,this.onshutdown=null,this.onrestart=null,this.connectionObj=null}function Display(t,e,n){this.message="",this.deviceID=t,this.isCrypto=e,this.ePosDev=n,this.timeout=1e4,this.onreceive=null,this.onerror=null,this.ASB_NO_RESPONSE=1,this.ASB_DISPLAY_SUCCESS=2,this.SCROLL_OVERWRITE="overwrite",this.SCROLL_VERTICAL="v_scroll",this.SCROLL_HORIZONTAL="h_scroll",this.MOVE_TOP_LEFT="top_left",this.MOVE_TOP_RIGHT="top_right",this.MOVE_BOTTOM_LEFT="bottom_left",this.MOVE_BOTTOM_RIGHT="bottom_right",this.CURSOR_NONE="none",this.CURSOR_UNDERLINE="underline",this.BRIGHTNESS_20=20,this.BRIGHTNESS_40=40,this.BRIGHTNESS_60=60,this.BRIGHTNESS_100=100,this.MARQUEE_WALK="walk",this.MARQUEE_PLACE="place",this.connectionObj=null}callbackInfo.prototype={addCallback:function(t,e){this.callbackInfoList[e]=t},removeCallback:function(t){for(var e in this.callbackInfoList)if(e==t)return void delete this.callbackInfoList[e]},getCallback:function(t){return null!=this.callbackInfoList[t]?this.callbackInfoList[t]:null}},CommBox.prototype={getCommHistory:function(t,e){var n="function"==typeof t?null:t,i="function"==typeof t?t:e,r=null!=n&&null!=n.allHistory&&t.allHistory,s={type:"getcommhistory",box_id:this.boxID,all_history:r},o=MessageFactory.getCommBoxDataMessage(s);return this.commBoxManager.isOpened(this.getBoxId())?(this.callbackInfo.addCallback(i,o.sequence),this.connectionObj.emit(o),o.sequence):(null!=i&&i(this.ERROR_NOT_OPENED,null,o.sequence),o.sequence)},send:function(t,e,n){var i={type:"send",box_id:this.boxID,message:t,member_id:e},r=MessageFactory.getCommBoxDataMessage(i);return this.commBoxManager.isOpened(this.getBoxId())?(this.callbackInfo.addCallback(n,r.sequence),this.connectionObj.emit(r),r.sequence):(null!=n&&n(this.ERROR_NOT_OPENED,0,r.sequence),r.sequence)},client_getcommhistory:function(t,e){var n=t.code,i=t.history_list,r=this.callbackInfo.getCallback(e);this.callbackInfo.removeCallback(e),null!=r&&r(n,i,e)},client_send:function(t,e){var n=t.code,i=t.count,r=this.callbackInfo.getCallback(e);this.callbackInfo.removeCallback(e),null!=r&&r(n,i,e)},client_onreceive:function(t,e){var n=new Object;n.senderId=t.sender_id,n.receiverId=t.receiver_id,n.message=t.message,null!=this.onreceive&&this.onreceive(n)},getBoxId:function(){return this.boxID}},CommBoxManager.prototype={setConnectionObject:function(t){this.connectionObj=t},openCommBox:function(t,e,n){var i="";null!=e&&null!=e.memberID&&(i=e.memberID);var r={box_id:t,member_id:i},s=MessageFactory.getOpenCommBoxMessage(r);return this.connectionObj.isUsableDeviceIF()?(this.connectionObj.emit(s),this.callbackInfo.addCallback(n,s.sequence),s.sequence):(n(null,this.ERROR_SYSTEM_ERROR,s.sequence),s.sequence)},closeCommBox:function(t,e){var n={box_id:r},i=MessageFactory.getCloseCommBoxMessage(n);try{var r=t.getBoxId();if(n.box_id=r,i=MessageFactory.getCloseCommBoxMessage(n),!this.isOpened(r))return null!=e&&e(this.ERROR_NOT_OPENED,i.sequence),i.sequence;this.connectionObj.emit(i)}catch(s){null!=e&&e(this.ERROR_PARAMETER_ERROR,i.sequence)}return this.callbackInfo.addCallback(e,i.sequence),i.sequence},client_opencommbox:function(t,e){var n=t.box_id,i=t.code,r=null;i==this.ERROR_OK&&null==this.getCommBox(n)&&(r=new CommBox(n,this,this.callbackInfo)),null!=r&&this.commBoxList.push(r);var s=this.callbackInfo.getCallback(e);this.callbackInfo.removeCallback(e),null!=s&&s(r,i,e)},client_closecommbox:function(t,e){var n=t.box_id,i=t.code;this.removeCommBox(n);var r=this.callbackInfo.getCallback(e);this.callbackInfo.removeCallback(e),null!=r&&r(i,e)},executeCommDataCallback:function(data,sq){var boxID=data.box_id,commBoxObj=this.getCommBox(boxID),method="client_"+data.type;try{eval("commBoxObj."+method+"(data, sq)")}catch(e){throw new Error("")}},getCommBox:function(t){for(var e=null,n=0;n<this.commBoxList.length;n++)if(this.commBoxList[n].getBoxId()==t){e=this.commBoxList[n];break}return e},removeCommBox:function(t){for(var e=!1,n=0;n<this.commBoxList.length;n++)if(this.commBoxList[n].getBoxId()==t){this.commBoxList.splice(n,1),e=!0;break}return e},isOpened:function(t){for(var e=!1,n=0;n<this.commBoxList.length;n++)if(this.commBoxList[n].getBoxId()==t){e=!0;break}return e}},DeviceObjectSelector.prototype={setConnectionObject:function(t){this.connectionObj=t},isSelectable:function(t){return!!this.connectionObj.isUsableDeviceIF()||(!("type_printer"!=t||!this.connectionObj.isUsablePrintIF())||!("type_display"!=t||!this.connectionObj.isUsableDisplayIF()))},select:function(deviceId,deviceType,specificDevice,isCrypto,ePOSDeviceContext){var deviceObjectName="";deviceObjectName="string"==typeof specificDevice?specificDevice:this.type2objectMap[deviceType];var templateObject=null;try{templateObject=eval(deviceObjectName)}catch(e){throw new Error("ERROR_PARAMETER")}if("function"!=typeof templateObject)throw new Error("ERROR_PARAMETER");return"Printer"==deviceObjectName||"Display"==deviceObjectName||"HybridPrinter"==deviceObjectName||"HybridPrinter2"==deviceObjectName?new templateObject(deviceId,isCrypto,ePOSDeviceContext):new templateObject(deviceId,isCrypto)}},CashChanger.prototype={setConnectionObject:function(t){this.connectionObj=t},client_oncashcounts:function(t){try{if(null==this.oncashcounts)return;this.oncashcounts(t)}catch(e){}},client_onstatuschange:function(t){try{if(null==this.onstatuschange)return;this.onstatuschange(t)}catch(e){}},client_ondeposit:function(t){try{if(null==this.ondeposit)return;this.ondeposit(t)}catch(e){}},client_ondispense:function(t){try{if(null==this.ondispense)return;this.ondispense(t)}catch(e){}},client_oncollect:function(t){try{if(null==this.oncollect)return;this.oncollect(t)}catch(e){}},client_onconfigchange:function(t){try{if(null==this.onconfigchange)return;this.onconfigchange(t)}catch(e){}},client_oncommandreply:function(t){try{if(null==this.oncommandreply)return;if(""!=typeof t.command);else{var e=t.data;e=e.replace(/[0-9a-fA-F]{2}/g,function(t){var e=parseInt(t,16);return String.fromCharCode(e)}),t.data=e}this.oncommandreply(t)}catch(n){}},client_ondirectio:function(t){try{if(null==this.ondirectio)return;this.ondirectio(t)}catch(e){}},client_onstatusupdate:function(t){try{if(null==this.onstatusupdate)return;this.onstatusupdate(t)}catch(e){}},readCashCounts:function(){return this.send({type:"readcashcounts"})},beginDeposit:function(){return this.send({type:"begindeposit"})},pauseDeposit:function(){return this.send({type:"pausedeposit"})},restartDeposit:function(){return this.send({type:"restartdeposit"})},endDeposit:function(t){var e={type:"enddeposit",cmd:t};return this.send(e)},dispenseCash:function(t){var e;return"object"==typeof t?(e=t).type="dispensecash":e={type:"dispensecash",cash:t},this.send(e)},dispenseChange:function(t){var e;return"object"==typeof t?(e=t).type="dispensechange":e={type:"dispensechange",cash:t},this.send(e)},openDrawer:function(){return this.send({type:"opendrawer"})},collectCash:function(t){var e={type:"collectcash",collectmode:t};return this.send(e)},setConfig:function(t,e){var n=null;switch(t){case this.CONFIG_COUNT_MODE:n={type:"setconfig",config:t,mode:e.mode};break;case this.CONFIG_LEFT_CASH:null!=e.bills&&""!=e.bills||(e.bills="0"),null!=e.coins&&""!=e.coins||(e.coins="0"),n={type:"setconfig",config:t,bills:e.bills,coins:e.coins}}var i=-1;return null!=n&&(i=this.send(n)),i},sendCommand:function(t){var e;return"object"==typeof t?(e=t).type="sendcommand":e={type:"sendcommand",command:toHexBinary(t)},this.send(e)},callEvent:function(t,e){var n=e;return n.type=t,this.send(n)},send:function(t){var e=MessageFactory.getDeviceDataMessage(this.deviceID,t,this.isCrypto),n=-1;try{this.connectionObj.emit(e),n=e.sequence}catch(i){}return n}},CAT.prototype={setConnectionObject:function(t){this.connectionObj=t},authorizeSales:function(t){var e={service:t.service,total_amount:t.totalAmount,sequence:t.sequence,type:"authorizesales"};return e.training=this.trainingMode,e.timeout=this.timeout,this.send(e)},authorizeVoid:function(t){var e={service:t.service,total_amount:t.totalAmount,sequence:t.sequence,type:"authorizevoid"};return e.training=this.trainingMode,e.timeout=this.timeout,this.send(e)},authorizeRefund:function(t){var e={service:t.service,total_amount:t.totalAmount,sequence:t.sequence,type:"authorizerefund"};return e.training=this.trainingMode,e.timeout=this.timeout,this.send(e)},authorizeCompletion:function(t){var e={service:t.service,total_amount:t.totalAmount,sequence:t.sequence,type:"authorizecompletion"};return e.training=this.trainingMode,e.timeout=this.timeout,this.send(e)},accessDailyLog:function(t){var e={service:t.service,total_amount:t.totalAmount,sequence:t.sequence,type:"accessdailylog"};return e.training=this.trainingMode,e.timeout=this.timeout,this.send(e)},sendCommand:function(t){var e={service:t.service,command:t.command,data:t.data,string:t.string,type:"sendcommand"};return e.training=this.trainingMode,this.send(e)},send:function(t){this.deviceID;var e=MessageFactory.getDeviceDataMessage(this.deviceID,t,this.isCrypto),n=-1;try{this.connectionObj.emit(e),n=e.sequence}catch(i){}return n},client_onauthorizesales:function(t){try{if(null==this.onauthorizesales)return;this.onauthorizesales(this.getResultObject(t))}catch(e){}},client_onauthorizevoid:function(t){try{if(null==this.onauthorizevoid)return;this.onauthorizevoid(this.getResultObject(t))}catch(e){}},client_onauthorizerefund:function(t){try{if(null==this.onauthorizerefund)return;this.onauthorizerefund(this.getResultObject(t))}catch(e){}},client_onauthorizecompletion:function(t){try{if(null==this.onauthorizecompletion)return;this.onauthorizecompletion(this.getResultObject(t))}catch(e){}},client_onaccessdailylog:function(t){try{if(null==this.onaccessdailylog)return;this.onaccessdailylog(this.getDailyLogObject(t))}catch(e){}},client_oncommandreply:function(t){try{if(null==this.oncommandreply)return;this.oncommandreply(this.getCommandReplyObject(t))}catch(e){}},client_onstatusupdate:function(t){try{if(null==this.onstatusupdate)return;this.onstatusupdate(t)}catch(e){}},getResultObject:function(t){return{status:t.status,sequence:t.sequence,service:t.service,accountNumber:t.account_number,settledAmount:t.settled_amount,slipNumber:t.slip_number,kid:t.kid,approvalCode:t.approval_code,transactionNumber:t.transaction_number,paymentCondition:t.payment_condition,voidSlipNumber:t.void_slip_number,balance:t.balance}},getDailyLogObject:function(t){var e={};e.status=t.status,e.service=t.service,e.sequence=t.sequence;var n=[];try{t.daily_log.forEach(function(t){var e={};if(0===t)throw n;e.kid=t.kid,e.salesCount=t.sales_count,e.salesAmount=t.sales_amount,e.voidCount=t.void_count,e.voidAmount=t.void_amount,n.push(e)})}catch(i){}return e.dailyLog=n,e},getCommandReplyObject:function(t){return{status:t.status,command:t.command,data:t.data,string:t.string,service:t.service,sequence:t.sequence,accountNumber:t.account_number,settledAmount:t.settled_amount,slipNumber:t.slip_number,transactionNumber:t.transaction_number,paymentCondition:t.payment_condition,balance:t.balance,additionalSecurityInformation:t.additional_security_information}},callEvent:function(t,e){var n=e;return n.type=t,this.send(n)}},DeviceTerminal.prototype={setConnectionObject:function(t){this.connectionObj=t},shutdown:function(t,e){this.onshutdown=e;var n={type:"shutdown",password:t};return this.send(n)},client_onshutdown:function(t){try{if("function"!=typeof this.onshutdown)return;this.onshutdown(t)}catch(e){}},restart:function(t,e){this.onrestart=e;var n={type:"restart",password:t};return this.send(n)},client_onrestart:function(t){try{if("function"!=typeof this.onrestart)return;this.onrestart(t)}catch(e){}},send:function(t){var e=MessageFactory.getDeviceDataMessage(this.deviceID,t,this.isCrypto),n=-1;try{this.connectionObj.emit(e),n=e.sequence}catch(i){}return n}},Display.prototype.setConnectionObject=function(t){this.connectionObj=t},Display.prototype.reset=function(){try{this.message+="<reset />"}catch(t){throw t}return this},Display.prototype.createWindow=function(t,e,n,i,r,s){try{var o="";o+=getIntAttr("number",t,1,4),o+=getIntAttr("x",e,1,20),o+=getIntAttr("y",n,1,2),o+=getIntAttr("width",i,1,21-e),o+=getIntAttr("height",r,1,3-n),o+=getEnumAttr("scrollmode",s,regexScrollMode),this.message+="<window"+o+"/>"}catch(a){throw a}return this},Display.prototype.destroyWindow=function(t){try{var e="";e+=getIntAttr("number",t,1,4),this.message+="<window"+e+' destroy="true"/>'}catch(n){throw n}return this},Display.prototype.setCurrentWindow=function(t){try{var e="";e+=getIntAttr("number",t,1,4),this.message+="<window"+e+"/>"}catch(n){throw n}return this},Display.prototype.setCursorPosition=function(){try{var t="";t+=getIntAttr("x",arguments[0],1,20),t+=getIntAttr("y",arguments[1],1,2),this.message+="<cursor"+t+"/>"}catch(e){throw e}return this},Display.prototype.moveCursorPosition=function(){try{var t="";t+=getEnumAttr("moveto",arguments[0],regexMoveto),this.message+="<cursor"+t+"/>"}catch(e){throw e}return this},Display.prototype.setCursorType=function(t){try{var e="";e+=getEnumAttr("type",t,regexUnderline),this.message+="<cursor"+e+"/>"}catch(n){throw n}return this},Display.prototype.addText=function(){try{var t="";switch(arguments.length){case 1:break;case 2:t+=' lang="'+arguments[1]+'"';break;case 3:t+=getIntAttr("x",arguments[1],1,20),t+=getIntAttr("y",arguments[2],1,2);break;case 4:t+=getIntAttr("x",arguments[1],1,20),t+=getIntAttr("y",arguments[2],1,2),t+=' lang="'+arguments[3]+'"';break;default:throw new Error("Parameters are invalid")}this.message+="<text"+t+">"+escapeMarkup(arguments[0])+"</text>"}catch(e){throw e}return this},Display.prototype.addReverseText=function(){try{var t="";switch(arguments.length){case 1:t+=getBoolAttr("reverse",!0);break;case 2:t+=' lang="'+arguments[1]+'"',t+=getBoolAttr("reverse",!0);break;case 3:t+=getIntAttr("x",arguments[1],1,20),t+=getIntAttr("y",arguments[2],1,2),t+=getBoolAttr("reverse",!0);break;case 4:t+=getIntAttr("x",arguments[1],1,20),t+=getIntAttr("y",arguments[2],1,2),t+=' lang="'+arguments[3]+'"',t+=getBoolAttr("reverse",!0);break;default:throw new Error("Parameters are invalid")}this.message+="<text"+t+">"+escapeMarkup(arguments[0])+"</text>"}catch(e){throw e}return this},Display.prototype.clearWindow=function(){try{this.message+="<clear/>"}catch(t){throw t}return this},Display.prototype.setBlink=function(t){try{var e="";e+=getUShortAttr("interval",t),this.message+="<blink"+e+"/>"}catch(n){throw n}return this},Display.prototype.setBrightness=function(t){try{var e="";e+=getEnumAttr("value",t,regexBrightness),this.message+="<brightness"+e+"/>"}catch(n){throw n}return this},Display.prototype.addMarquee=function(t,e,n,i,r,s){try{var o="";o+=getEnumAttr("format",e,regexMarquee),o+=getIntAttr("uwait",n,0,2e3),o+=getIntAttr("rwait",i,100,2e3),o+=getIntAttr("repeat",r,0,127),void 0!==s&&(o+=' lang="'+s+'"'),this.message+="<marquee"+o+">"+escapeMarkup(t)+"</marquee>"}catch(a){throw a}return this},Display.prototype.showClock=function(){try{this.message+="<clock/>"}catch(t){throw t}return this},Display.prototype.addCommand=function(t){try{this.message+="<command>"+toHexBinary(t)+"</command>"}catch(e){throw e}return this},Display.prototype.send=function(){var t=-1;if(!this.ePosDev.eposprint&&this.connectionObj.isUsableDeviceIF())try{var e=this.toString(),n={type:"display",timeout:this.timeout,displaydata:e},i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto);this.connectionObj.emit(i),t=i.sequence,this.message=""}catch(d){t=-1}else{var r,s,o,a,c,h,u,p=this,l=this.connectionObj.getAddressWithProtocol()+"/cgi-bin/eposDisp/service.cgi?devid="+this.deviceID+"&timeout="+this.timeout;if(a={},r='<?xml version="1.0" encoding="utf-8"?><s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">',r+="<s:Body>"+this.toString()+"</s:Body></s:Envelope>",!window.XMLHttpRequest)throw new Error("XMLHttpRequest is not supported");!("withCredentials"in(s=new XMLHttpRequest))&&window.XDomainRequest?((s=new XDomainRequest).open("POST",l,!0),s.onload=function(){a=s.responseText,/response/.test(a)?(c=/success\s*=\s*"\s*(1|true)\s*"/.test(a),h=a.match(/code\s*=\s*"\s*(\S*)\s*"/)?RegExp.$1:"",u=a.match(/status\s*=\s*"\s*(\d+)\s*"/)?parseInt(RegExp.$1):0,p.fireReceiveEvent(c,h,u,0)):p.fireErrorEvent(0,s.responseText,0)},s.onerror=function(){p.fireErrorEvent(0,s.responseText,0)},s.onprogress=function(){},s.ontimeout=s.onerror,s.timeout=p.timeout,s.send(r)):(s.open("POST",l,!0),s.setRequestHeader("Content-Type","text/xml; charset=utf-8"),s.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:00 GMT"),s.setRequestHeader("SOAPAction",'""'),s.onreadystatechange=function(){4==s.readyState&&(clearTimeout(o),200==s.status&&s.responseXML&&(a=s.responseXML.getElementsByTagName("response")).length>0?(c=/^(1|true)$/.test(a[0].getAttribute("success")),h=a[0].hasAttribute("code")?a[0].getAttribute("code"):"",u=a[0].hasAttribute("status")?parseInt(a[0].getAttribute("status")):0,p.fireReceiveEvent(c,h,u,0)):p.fireErrorEvent(s.status,s.responseText,0))},o=setTimeout(function(){s.abort()},this.timeout),s.send(r)),this.message="",t=0}return t},Display.prototype.fireReceiveEvent=function(t,e,n,i){"EX_ENPC_TIMEOUT"==e&&(e="ERROR_DEVICE_BUSY"),this.onreceive&&this.onreceive({success:t,code:e,status:n},i)},Display.prototype.fireErrorEvent=function(t,e,n){this.onerror&&this.onerror({status:0,responseText:this.ASB_NO_RESPONSE},n),this.ePosDev.cleanup()},Display.prototype.client_onxmlresult=function(t,e){if(t){var n=t.resultdata,i=/success\s*=\s*"\s*(1|true)\s*"/.test(n);n.match(/code\s*=\s*"\s*(\S*)\s*"/);var r=RegExp.$1;n.match(/status\s*=\s*"\s*(\d+)\s*"/);var s=parseInt(RegExp.$1);this.onreceive&&this.onreceive({success:i,code:r,status:s},e)}else this.onerror&&this.onerror({status:0,responseText:this.ASB_NO_RESPONSE},e),this.ePosDev.cleanup()},Display.prototype.toString=function(){return'<epos-display xmlns="http://www.epson-pos.com/schemas/2012/09/epos-display">'+this.message+"</epos-display>"},Display.prototype.setXmlString=function(t){this.message=t},Display.prototype.getXmlString=function(){return this.message},Display.prototype.callEvent=function(t,e){var n=MessageFactory.getDeviceDataMessage(this.deviceID,e,this.isCrypto),i=-1;try{this.connectionObj.emit(n),i=n.sequence}catch(r){}return i};var regexBrightness=/^(20|40|60|100)$/,regexScrollMode=/^(overwrite|v_scroll|h_scroll)$/,regexMoveto=/^(top_left|top_right|bottom_left|bottom_right)$/,regexUnderline=/^(none|underline)$/,regexMarquee=/^(walk|place)$/;function OtherPeripheral(t,e){this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function Keyboard(t,e){this.VK_CANCEL=3,this.VK_BACK=8,this.VK_TAB=9,this.VK_RETURN=13,this.VK_SHIFT=16,this.VK_CONTROL=17,this.VK_MENU=18,this.VK_PAUSE=19,this.VK_CAPITAL=20,this.VK_KANA=21,this.VK_ESCAPE=27,this.VK_CONVERT=28,this.VK_NONCONVERT=29,this.VK_SPACE=32,this.VK_PRIOR=33,this.VK_NEXT=34,this.VK_END=35,this.VK_HOME=36,this.VK_LEFT=37,this.VK_UP=38,this.VK_RIGHT=39,this.VK_DOWN=40,this.VK_INSERT=45,this.VK_DELETE=46,this.VK_0=48,this.VK_1=49,this.VK_2=50,this.VK_3=51,this.VK_4=52,this.VK_5=53,this.VK_6=54,this.VK_7=55,this.VK_8=56,this.VK_9=57,this.VK_A=65,this.VK_B=66,this.VK_C=67,this.VK_D=68,this.VK_E=69,this.VK_F=70,this.VK_G=71,this.VK_H=72,this.VK_I=73,this.VK_J=74,this.VK_K=75,this.VK_L=76,this.VK_M=77,this.VK_N=78,this.VK_O=79,this.VK_P=80,this.VK_Q=81,this.VK_R=82,this.VK_S=83,this.VK_T=84,this.VK_U=85,this.VK_V=86,this.VK_W=87,this.VK_X=88,this.VK_Y=89,this.VK_Z=90,this.VK_LWIN=91,this.VK_RWIN=92,this.VK_APPS=93,this.VK_NUMPAD0=96,this.VK_NUMPAD1=97,this.VK_NUMPAD2=98,this.VK_NUMPAD3=99,this.VK_NUMPAD4=100,this.VK_NUMPAD5=101,this.VK_NUMPAD6=102,this.VK_NUMPAD7=103,this.VK_NUMPAD8=104,this.VK_NUMPAD9=105,this.VK_MULTIPLY=106,this.VK_ADD=107,this.VK_SEPARATOR=108,this.VK_SUBTRACT=109,this.VK_DECIMAL=110,this.VK_DIVIDE=111,this.VK_F1=112,this.VK_F2=113,this.VK_F3=114,this.VK_F4=115,this.VK_F5=116,this.VK_F6=117,this.VK_F7=118,this.VK_F8=119,this.VK_F9=120,this.VK_F10=121,this.VK_F11=122,this.VK_F12=123,this.VK_NUMLOCK=144,this.VK_SCROLL=145,this.VK_LSHIFT=160,this.VK_RSHIFT=161,this.VK_LCONTROL=162,this.VK_RCONTROL=163,this.VK_LMENU=164,this.VK_RMENU=165,this.VK_OEM_1=186,this.VK_OEM_PLUS=187,this.VK_OEM_COMMA=188,this.VK_OEM_MINUS=189,this.VK_OEM_PERIOD=190,this.VK_OEM_2=191,this.VK_OEM_3=192,this.VK_OEM_4=219,this.VK_OEM_5=220,this.VK_OEM_6=221,this.VK_OEM_7=222,this.VK_OEM_102=226,this.VK_OEM_ATTN=240,this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function MSR(t,e){this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function ePOSBuilder(){this.message="",this.halftone=0,this.brightness=1,this.force=!1,this.FONT_A="font_a",this.FONT_B="font_b",this.FONT_C="font_c",this.FONT_D="font_d",this.FONT_E="font_e",this.FONT_SPECIAL_A="special_a",this.FONT_SPECIAL_B="special_b",this.ALIGN_LEFT="left",this.ALIGN_CENTER="center",this.ALIGN_RIGHT="right",this.COLOR_NONE="none",this.COLOR_1="color_1",this.COLOR_2="color_2",this.COLOR_3="color_3",this.COLOR_4="color_4",this.FEED_PEELING="peeling",this.FEED_CUTTING="cutting",this.FEED_CURRENT_TOF="current_tof",this.FEED_NEXT_TOF="next_tof",this.MODE_MONO="mono",this.MODE_GRAY16="gray16",this.BARCODE_UPC_A="upc_a",this.BARCODE_UPC_E="upc_e",this.BARCODE_EAN13="ean13",this.BARCODE_JAN13="jan13",this.BARCODE_EAN8="ean8",this.BARCODE_JAN8="jan8",this.BARCODE_CODE39="code39",this.BARCODE_ITF="itf",this.BARCODE_CODABAR="codabar",this.BARCODE_CODE93="code93",this.BARCODE_CODE128="code128",this.BARCODE_GS1_128="gs1_128",this.BARCODE_GS1_DATABAR_OMNIDIRECTIONAL="gs1_databar_omnidirectional",this.BARCODE_GS1_DATABAR_TRUNCATED="gs1_databar_truncated",this.BARCODE_GS1_DATABAR_LIMITED="gs1_databar_limited",this.BARCODE_GS1_DATABAR_EXPANDED="gs1_databar_expanded",this.HRI_NONE="none",this.HRI_ABOVE="above",this.HRI_BELOW="below",this.HRI_BOTH="both",this.SYMBOL_PDF417_STANDARD="pdf417_standard",this.SYMBOL_PDF417_TRUNCATED="pdf417_truncated",this.SYMBOL_QRCODE_MODEL_1="qrcode_model_1",this.SYMBOL_QRCODE_MODEL_2="qrcode_model_2",this.SYMBOL_QRCODE_MICRO="qrcode_micro",this.SYMBOL_MAXICODE_MODE_2="maxicode_mode_2",this.SYMBOL_MAXICODE_MODE_3="maxicode_mode_3",this.SYMBOL_MAXICODE_MODE_4="maxicode_mode_4",this.SYMBOL_MAXICODE_MODE_5="maxicode_mode_5",this.SYMBOL_MAXICODE_MODE_6="maxicode_mode_6",this.SYMBOL_GS1_DATABAR_STACKED="gs1_databar_stacked",this.SYMBOL_GS1_DATABAR_STACKED_OMNIDIRECTIONAL="gs1_databar_stacked_omnidirectional",this.SYMBOL_GS1_DATABAR_EXPANDED_STACKED="gs1_databar_expanded_stacked",this.SYMBOL_AZTECCODE_FULLRANGE="azteccode_fullrange",this.SYMBOL_AZTECCODE_COMPACT="azteccode_compact",this.SYMBOL_DATAMATRIX_SQUARE="datamatrix_square",this.SYMBOL_DATAMATRIX_RECTANGLE_8="datamatrix_rectangle_8",this.SYMBOL_DATAMATRIX_RECTANGLE_12="datamatrix_rectangle_12",this.SYMBOL_DATAMATRIX_RECTANGLE_16="datamatrix_rectangle_16",this.LEVEL_0="level_0",this.LEVEL_1="level_1",this.LEVEL_2="level_2",this.LEVEL_3="level_3",this.LEVEL_4="level_4",this.LEVEL_5="level_5",this.LEVEL_6="level_6",this.LEVEL_7="level_7",this.LEVEL_8="level_8",this.LEVEL_L="level_l",this.LEVEL_M="level_m",this.LEVEL_Q="level_q",this.LEVEL_H="level_h",this.LEVEL_DEFAULT="default",this.LINE_THIN="thin",this.LINE_MEDIUM="medium",this.LINE_THICK="thick",this.LINE_THIN_DOUBLE="thin_double",this.LINE_MEDIUM_DOUBLE="medium_double",this.LINE_THICK_DOUBLE="thick_double",this.DIRECTION_LEFT_TO_RIGHT="left_to_right",this.DIRECTION_BOTTOM_TO_TOP="bottom_to_top",this.DIRECTION_RIGHT_TO_LEFT="right_to_left",this.DIRECTION_TOP_TO_BOTTOM="top_to_bottom",this.CUT_NO_FEED="no_feed",this.CUT_FEED="feed",this.CUT_RESERVE="reserve",this.DRAWER_1="drawer_1",this.DRAWER_2="drawer_2",this.PULSE_100="pulse_100",this.PULSE_200="pulse_200",this.PULSE_300="pulse_300",this.PULSE_400="pulse_400",this.PULSE_500="pulse_500",this.PATTERN_NONE="none",this.PATTERN_0="pattern_0",this.PATTERN_1="pattern_1",this.PATTERN_2="pattern_2",this.PATTERN_3="pattern_3",this.PATTERN_4="pattern_4",this.PATTERN_5="pattern_5",this.PATTERN_6="pattern_6",this.PATTERN_7="pattern_7",this.PATTERN_8="pattern_8",this.PATTERN_9="pattern_9",this.PATTERN_10="pattern_10",this.PATTERN_A="pattern_a",this.PATTERN_B="pattern_b",this.PATTERN_C="pattern_c",this.PATTERN_D="pattern_d",this.PATTERN_E="pattern_e",this.PATTERN_ERROR="error",this.PATTERN_PAPER_END="paper_end",this.LAYOUT_RECEIPT="receipt",this.LAYOUT_RECEIPT_BM="receipt_bm",this.LAYOUT_LABEL="label",this.LAYOUT_LABEL_BM="label_bm",this.HALFTONE_DITHER=0,this.HALFTONE_ERROR_DIFFUSION=1,this.HALFTONE_THRESHOLD=2}function toHexBinary(t){var e,n=t.length,i=new Array(n);for(e=0;e<n;e++)i[e]=("0"+t.charCodeAt(e).toString(16)).slice(-2);return i.join("")}function toBase64Binary(t){var e,n=t.length,i=new Array((n+2)/3<<2),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=(3-n%3)%3,o=0,a=0;for(t+="\0\0";a<n;)e=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++),i[o++]=r.charAt(e>>18&63),i[o++]=r.charAt(e>>12&63),i[o++]=r.charAt(e>>6&63),i[o++]=r.charAt(63&e);for(;s--;)i[--o]="=";return i.join("")}function toMonoImage(t,e,n){var i,r,s,o,a,c,h,u=String.fromCharCode,p=[[2,130,34,162,10,138,42,170],[194,66,226,98,202,74,234,106],[50,178,18,146,58,186,26,154],[242,114,210,82,250,122,218,90],[14,142,46,174,6,134,38,166],[206,78,238,110,198,70,230,102],[62,190,30,158,54,182,22,150],[254,126,222,94,246,118,214,86]],l=t.data,d=t.width,f=t.height,_=new Array((d+7>>3)*f),E=0,y=0,m=0,R=128,g=new Array;if(1==e)for(c=d;c--;)g.push(0);for(h=0;h<f;h++)for(i=0,r=0,c=0;c<d;)s=7&c,0==e&&(R=p[7&h][s]),o=255*Math.pow(((.29891*l[y++]+.58661*l[y++]+.11448*l[y++])*l[y]/255+255-l[y++])/255,1/n)|0,1==e&&(a=(o+=g[c]+i>>4)-(o<R?0:255),c>0&&(g[c-1]+=a),g[c]=7*a+r,i=5*a,r=3*a),o<R&&(E|=128>>s),c++,7!=s&&c!=d||(_[m++]=u(16==E?32:E),E=0);return _.join("")}function toGrayImage(t,e){var n,i,r,s,o,a=String.fromCharCode,c=[[0,9,2,11],[13,4,15,6],[3,12,1,10],[16,7,14,5]],h=[0,7,13,19,23,27,31,35,40,44,49,52,54,55,57,59,61,62,64,66,67,69,70,70,71,72,73,74,75,76,77,78,79,80,81,82,83,83,84,85,86,86,87,88,88,89,90,90,91,91,92,93,93,94,94,95,96,96,97,98,98,99,99,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119,120,120,120,121,121,122,122,123,123,123,124,124,125,125,125,126,126,127,127,127,128,128,129,129,130,130,130,131,131,132,132,132,133,133,134,134,135,135,135,136,136,137,137,137,138,138,139,139,139,140,140,141,141,141,142,142,143,143,143,144,144,145,145,146,146,146,147,147,148,148,148,149,149,150,150,150,151,151,152,152,152,153,153,154,154,155,155,155,156,156,157,157,158,158,159,159,160,160,161,161,161,162,162,163,163,164,164,165,165,166,166,166,167,167,168,168,169,169,170,170,171,171,172,173,173,174,175,175,176,177,178,178,179,180,180,181,182,182,183,184,184,185,186,186,187,189,191,193,195,198,200,202,255],u=t.data,p=t.width,l=t.height,d=new Array((p+1>>1)*l),f=0,_=0,E=0;for(o=0;o<l;o++)for(s=0;s<p;)n=1&s,r=(i=h[255*Math.pow(((.29891*u[_++]+.58661*u[_++]+.11448*u[_++])*u[_]/255+255-u[_++])/255,1/e)|0])/17|0,c[3&o][3&s]<i%17&&r++,f|=r<<(1-n<<2),s++,1!=n&&s!=p||(d[E++]=a(f),f=0);return d.join("")}function escapeMarkup(t){var e=/[<>&'"\t\n\r]/g;return e.test(t)&&(t=t.replace(e,function(t){var e="";switch(t){case"<":e="&lt;";break;case">":e="&gt;";break;case"&":e="&amp;";break;case"'":e="&apos;";break;case'"':e="&quot;";break;case"\t":e="&#9;";break;case"\n":e="&#10;";break;case"\r":e="&#13;"}return e})),t}function escapeControl(t){var e=/[\\\x00-\x1f\x7f-\xff]/g;return e.test(t)&&(t=t.replace(e,function(t){return"\\"==t?"\\\\":"\\x"+("0"+t.charCodeAt(0).toString(16)).slice(-2)})),t}OtherPeripheral.prototype={setConnectionObject:function(t){this.connectionObj=t},send:function(t,e){var n={};for(var i in e)n[i]=e[i];n.type=t;var r=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto),s=-1;try{this.connectionObj.emit(r),s=r.sequence}catch(o){}return s},client_onreceive:function(t){try{var e=t;delete e.type,this.onreceive(t.type,e)}catch(n){}},callEvent:function(t,e){var n=MessageFactory.getDeviceDataMessage(this.deviceID,e,this.isCrypto),i=-1;try{this.connectionObj.emit(n),i=n.sequence}catch(r){}return i}},Keyboard.prototype={setConnectionObject:function(t){this.connectionObj=t},client_onkeypress:function(t){try{if(null==this.onkeypress)return;this.onkeypress(t)}catch(e){}},client_onstring:function(t){try{if(null==this.onstring)return;this.onstring(t)}catch(e){}},setPrefix:function(t){var e={type:"setprefix"};if("object"==typeof t){if(0==t.length)return-1;e.keycodes=t}else{if(null==t||""==t)return-1;e.keycodes=[t]}var n=MessageFactory.getDeviceDataMessage(this.deviceID,e,this.isCrypto),i=-1;try{this.connectionObj.emit(n),i=n.sequence}catch(r){}return i},callEvent:function(t,e){var n=e;n.type=t;var i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto),r=-1;try{this.connectionObj.emit(i),r=i.sequence}catch(s){}return r}},MSR.prototype={setConnectionObject:function(t){this.connectionObj=t},client_ondata:function(t){try{if(null==this.ondata)return;this.ondata(t)}catch(e){}},callEvent:function(t,e){var n=e;n.type=t;var i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto),r=-1;try{this.connectionObj.emit(i),r=i.sequence}catch(s){}return r}},ePOSBuilder.prototype.addText=function(t){return this.message+="<text>"+escapeMarkup(t)+"</text>",this},ePOSBuilder.prototype.addTextLang=function(t){return this.message+='<text lang="'+t+'"/>',this},ePOSBuilder.prototype.addTextAlign=function(t){var e="";return e+=getEnumAttr("align",t,regexAlign),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addTextRotate=function(t){var e="";return e+=getBoolAttr("rotate",t),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addTextLineSpace=function(t){var e="";return e+=getUByteAttr("linespc",t),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addTextFont=function(t){var e="";return e+=getEnumAttr("font",t,regexFont),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addTextSmooth=function(t){var e="";return e+=getBoolAttr("smooth",t),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addTextDouble=function(t,e){var n="";return t!==undefined&&(n+=getBoolAttr("dw",t)),e!==undefined&&(n+=getBoolAttr("dh",e)),this.message+="<text"+n+"/>",this},ePOSBuilder.prototype.addTextSize=function(t,e){var n="";return t!==undefined&&(n+=getIntAttr("width",t,1,8)),e!==undefined&&(n+=getIntAttr("height",e,1,8)),this.message+="<text"+n+"/>",this},ePOSBuilder.prototype.addTextStyle=function(t,e,n,i){var r="";return t!==undefined&&(r+=getBoolAttr("reverse",t)),e!==undefined&&(r+=getBoolAttr("ul",e)),n!==undefined&&(r+=getBoolAttr("em",n)),i!==undefined&&(r+=getEnumAttr("color",i,regexColor)),this.message+="<text"+r+"/>",this},ePOSBuilder.prototype.addTextPosition=function(t){var e="";return e+=getUShortAttr("x",t),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addTextVPosition=function(t){var e="";return e+=getUShortAttr("y",t),this.message+="<text"+e+"/>",this},ePOSBuilder.prototype.addFeedUnit=function(t){var e="";return e+=getUByteAttr("unit",t),this.message+="<feed"+e+"/>",this},ePOSBuilder.prototype.addFeedLine=function(t){var e="";return e+=getUByteAttr("line",t),this.message+="<feed"+e+"/>",this},ePOSBuilder.prototype.addFeed=function(){return this.message+="<feed/>",this},ePOSBuilder.prototype.addFeedPosition=function(t){var e="";return e+=getEnumAttr("pos",t,regexFeed),this.message+="<feed"+e+"/>",this},ePOSBuilder.prototype.addImage=function(t,e,n,i,r,s,o){var a,c,h="",u=this.halftone,p=this.brightness;if(getUShortAttr("x",e),getUShortAttr("y",n),h+=getUShortAttr("width",i),h+=getUShortAttr("height",r),s!==undefined&&(h+=getEnumAttr("color",s,regexColor)),o!==undefined&&(h+=getEnumAttr("mode",o,regexMode)),isNaN(u)||u<0||u>2)throw new Error('Property "halftone" is invalid');if(isNaN(p)||p<.1||p>10)throw new Error('Property "brightness" is invalid');return a=t.getImageData(e,n,i,r),c=o==this.MODE_GRAY16?toGrayImage(a,p):toMonoImage(a,u,p),this.message+="<image"+h+">"+toBase64Binary(c)+"</image>",this},ePOSBuilder.prototype.addLogo=function(t,e){var n="";return n+=getUByteAttr("key1",t),n+=getUByteAttr("key2",e),this.message+="<logo"+n+"/>",this},ePOSBuilder.prototype.addBarcode=function(t,e,n,i,r,s){var o="";return o+=getEnumAttr("type",e,regexBarcode),n!==undefined&&(o+=getEnumAttr("hri",n,regexHri)),i!==undefined&&(o+=getEnumAttr("font",i,regexFont)),r!==undefined&&(o+=getUByteAttr("width",r)),s!==undefined&&(o+=getUByteAttr("height",s)),this.message+="<barcode"+o+">"+escapeControl(escapeMarkup(t))+"</barcode>",this},ePOSBuilder.prototype.addSymbol=function(t,e,n,i,r,s){var o="";return o+=getEnumAttr("type",e,regexSymbol),n!==undefined&&(o+=getEnumIntAttr("level",n,regexLevel,0,255)),i!==undefined&&(o+=getUByteAttr("width",i)),r!==undefined&&(o+=getUByteAttr("height",r)),s!==undefined&&(o+=getUShortAttr("size",s)),this.message+="<symbol"+o+">"+escapeControl(escapeMarkup(t))+"</symbol>",this},ePOSBuilder.prototype.addHLine=function(t,e,n){var i="";return i+=getUShortAttr("x1",t),i+=getUShortAttr("x2",e),n!==undefined&&(i+=getEnumAttr("style",n,regexLine)),this.message+="<hline"+i+"/>",this},ePOSBuilder.prototype.addVLineBegin=function(t,e){var n="";return n+=getUShortAttr("x",t),e!==undefined&&(n+=getEnumAttr("style",e,regexLine)),this.message+="<vline-begin"+n+"/>",this},ePOSBuilder.prototype.addVLineEnd=function(t,e){var n="";return n+=getUShortAttr("x",t),e!==undefined&&(n+=getEnumAttr("style",e,regexLine)),this.message+="<vline-end"+n+"/>",this},ePOSBuilder.prototype.addPageBegin=function(){return this.message+="<page>",this},ePOSBuilder.prototype.addPageEnd=function(){return this.message+="</page>",this},ePOSBuilder.prototype.addPageArea=function(t,e,n,i){var r="";return r+=getUShortAttr("x",t),r+=getUShortAttr("y",e),r+=getUShortAttr("width",n),r+=getUShortAttr("height",i),this.message+="<area"+r+"/>",this},ePOSBuilder.prototype.addPageDirection=function(t){var e="";return e+=getEnumAttr("dir",t,regexDirection),this.message+="<direction"+e+"/>",this},ePOSBuilder.prototype.addPagePosition=function(t,e){var n="";return n+=getUShortAttr("x",t),n+=getUShortAttr("y",e),this.message+="<position"+n+"/>",this},ePOSBuilder.prototype.addPageLine=function(t,e,n,i,r){var s="";return s+=getUShortAttr("x1",t),s+=getUShortAttr("y1",e),s+=getUShortAttr("x2",n),s+=getUShortAttr("y2",i),r!==undefined&&(s+=getEnumAttr("style",r,regexLine)),this.message+="<line"+s+"/>",this},ePOSBuilder.prototype.addPageRectangle=function(t,e,n,i,r){var s="";return s+=getUShortAttr("x1",t),s+=getUShortAttr("y1",e),s+=getUShortAttr("x2",n),s+=getUShortAttr("y2",i),r!==undefined&&(s+=getEnumAttr("style",r,regexLine)),this.message+="<rectangle"+s+"/>",this},ePOSBuilder.prototype.addRotateBegin=function(){return this.message+="<rotate-begin/>",this},ePOSBuilder.prototype.addRotateEnd=function(){return this.message+="<rotate-end/>",this},ePOSBuilder.prototype.addCut=function(t){var e="";return t!==undefined&&(e+=getEnumAttr("type",t,regexCut)),this.message+="<cut"+e+"/>",this},ePOSBuilder.prototype.addPulse=function(t,e){var n="";return t!==undefined&&(n+=getEnumAttr("drawer",t,regexDrawer)),e!==undefined&&(n+=getEnumAttr("time",e,regexPulse)),this.message+="<pulse"+n+"/>",this},ePOSBuilder.prototype.addSound=function(t,e,n){var i="";return t!==undefined&&(i+=getEnumAttr("pattern",t,regexPattern)),e!==undefined&&(i+=getUByteAttr("repeat",e)),n!==undefined&&(i+=getUShortAttr("cycle",n)),this.message+="<sound"+i+"/>",this},ePOSBuilder.prototype.addLayout=function(t,e,n,i,r,s,o){var a="";return a+=getEnumAttr("type",t,regexLayout),e!==undefined&&(a+=getUShortAttr("width",e)),n!==undefined&&(a+=getUShortAttr("height",n)),i!==undefined&&(a+=getShortAttr("margin-top",i)),r!==undefined&&(a+=getShortAttr("margin-bottom",r)),s!==undefined&&(a+=getShortAttr("offset-cut",s)),o!==undefined&&(a+=getShortAttr("offset-label",o)),this.message+="<layout"+a+"/>",this},ePOSBuilder.prototype.addRecovery=function(){return this.message+="<recovery/>",this},ePOSBuilder.prototype.addReset=function(){return this.message+="<reset/>",this},ePOSBuilder.prototype.addCommand=function(t){return this.message+="<command>"+toHexBinary(t)+"</command>",this},ePOSBuilder.prototype.toString=function(){var t="";return this.force&&(t+=getBoolAttr("force",!0)),'<epos-print xmlns="http://www.epson-pos.com/schemas/2011/03/epos-print"'+t+">"+this.message+"</epos-print>"};var regexFont=/^(font_[a-e]|special_[ab])$/,regexAlign=/^(left|center|right)$/,regexColor=/^(none|color_[1-4])$/,regexFeed=/^(peeling|cutting|current_tof|next_tof)$/,regexMode=/^(mono|gray16)$/,regexBarcode=/^(upc_[ae]|[ej]an13|[ej]an8|code(39|93|128)|itf|codabar|gs1_128|gs1_databar_(omnidirectional|truncated|limited|expanded))$/,regexHri=/^(none|above|below|both)$/,regexSymbol=/^(pdf417_(standard|truncated)|qrcode_(model_[12]|micro)|maxicode_mode_[2-6]|gs1_databar_(stacked(_omnidirectional)?|expanded_stacked)|azteccode_(fullrange|compact)|datamatrix_(square|rectangle_(8|12|16)))$/,regexLevel=/^(level_[0-8lmqh]|default)$/,regexLine=/^(thin|medium|thick)(_double)?$/,regexDirection=/^(left_to_right|bottom_to_top|right_to_left|top_to_bottom)$/,regexCut=/^(no_feed|feed|reserve)$/,regexDrawer=/^drawer_[12]$/,regexPulse=/^pulse_[1-5]00$/,regexPattern=/^(none|pattern_(10|[0-9a-e])|error|paper_end)$/,regexLayout=/^(receipt|label)(_bm)?$/;function getEnumAttr(t,e,n){if(!n.test(e))throw new Error('Parameter "'+t+'" is invalid');return" "+t+'="'+e+'"'}function getBoolAttr(t,e){return" "+t+'="'+!!e+'"'}function getIntAttr(t,e,n,i){if(isNaN(e)||e<n||e>i)throw new Error('Parameter "'+t+'" is invalid');return" "+t+'="'+e+'"'}function getUByteAttr(t,e){return getIntAttr(t,e,0,255)}function getUShortAttr(t,e){return getIntAttr(t,e,0,65535)}function getShortAttr(t,e){return getIntAttr(t,e,-32768,32767)}function getEnumIntAttr(t,e,n,i,r){if(!n.test(e)&&(isNaN(e)||e<i||e>r))throw new Error('Parameter "'+t+'" is invalid');return" "+t+'="'+e+'"'}function ePOSPrint(t){this.address=t,this.enabled=!1,this.interval=3e3,this.timeout=3e5,this.status=0,this.battery=0,this.drawerOpenLevel=0,this.onreceive=null,this.onerror=null,this.onstatuschange=null,this.ononline=null,this.onoffline=null,this.onpoweroff=null,this.oncoverok=null,this.oncoveropen=null,this.onpaperok=null,this.onpaperend=null,this.onpapernearend=null,this.ondrawerclosed=null,this.ondraweropen=null,this.onbatterylow=null,this.onbatteryok=null,this.onbatterystatuschange=null,this.ASB_NO_RESPONSE=1,this.ASB_PRINT_SUCCESS=2,this.ASB_DRAWER_KICK=4,this.ASB_BATTERY_OFFLINE=4,this.ASB_OFF_LINE=8,this.ASB_COVER_OPEN=32,this.ASB_PAPER_FEED=64,this.ASB_WAIT_ON_LINE=256,this.ASB_PANEL_SWITCH=512,this.ASB_MECHANICAL_ERR=1024,this.ASB_AUTOCUTTER_ERR=2048,this.ASB_UNRECOVER_ERR=8192,this.ASB_AUTORECOVER_ERR=16384,this.ASB_RECEIPT_NEAR_END=131072,this.ASB_RECEIPT_END=524288,this.ASB_BUZZER=16777216,this.ASB_WAIT_REMOVE_LABEL=16777216,this.ASB_NO_LABEL=67108864,this.ASB_SPOOLER_IS_STOPPED=2147483648,this.DRAWER_OPEN_LEVEL_LOW=0,this.DRAWER_OPEN_LEVEL_HIGH=1}function fireReceiveEvent(t,e,n,i,r,s){"EX_ENPC_TIMEOUT"==n&&(n="ERROR_DEVICE_BUSY"),t.onreceive&&t.onreceive({success:e,code:n,status:i,battery:r,printjobid:s})}function fireStatusEvent(t,e,n){var i,r;0!=e&&e!=t.ASB_NO_RESPONSE||(e=t.status|t.ASB_NO_RESPONSE),i=0==t.status?-1:t.status^e,r=0==t.status?-1:t.battery^n,t.status=e,t.battery=n,i&&t.onstatuschange&&t.onstatuschange(e),r&&t.onbatterystatuschange&&t.onbatterystatuschange(n),i&(t.ASB_NO_RESPONSE|t.ASB_OFF_LINE)&&(e&t.ASB_NO_RESPONSE?t.onpoweroff&&t.onpoweroff():e&t.ASB_OFF_LINE?t.onoffline&&t.onoffline():t.ononline&&t.ononline()),i&t.ASB_COVER_OPEN&&(e&t.ASB_NO_RESPONSE||(e&t.ASB_COVER_OPEN?t.oncoveropen&&t.oncoveropen():t.oncoverok&&t.oncoverok())),i&(t.ASB_RECEIPT_END|t.ASB_RECEIPT_NEAR_END)&&(e&t.ASB_NO_RESPONSE||(e&t.ASB_RECEIPT_END?t.onpaperend&&t.onpaperend():e&t.ASB_RECEIPT_NEAR_END?t.onpapernearend&&t.onpapernearend():t.onpaperok&&t.onpaperok())),i&t.ASB_DRAWER_KICK&&(e&t.ASB_NO_RESPONSE||(e&t.ASB_DRAWER_KICK?(t.drawerOpenLevel==t.DRAWER_OPEN_LEVEL_HIGH?t.ondraweropen&&t.ondraweropen():t.ondrawerclosed&&t.ondrawerclosed(),t.onbatterylow&&t.onbatterylow()):(t.drawerOpenLevel==t.DRAWER_OPEN_LEVEL_HIGH?t.ondrawerclosed&&t.ondrawerclosed():t.ondraweropen&&t.ondraweropen(),t.onbatteryok&&t.onbatteryok())))}function fireErrorEvent(t,e,n){t.onerror&&t.onerror({status:e,responseText:n})}function updateStatus(t){var e=t.interval;t.enabled&&((isNaN(e)||e<1e3)&&(e=3e3),t.intervalid=setTimeout(function(){delete t.intervalid,t.enabled&&t.send()},e)),delete t.intervalxhr}function CanvasPrint(t){this.address=t,this.mode="mono",this.halftone=0,this.brightness=1,this.align="left",this.color="color_1",this.paper="receipt",this.feed="current_tof",this.cut=!1,this.layout=null,this.ALIGN_LEFT="left",this.ALIGN_CENTER="center",this.ALIGN_RIGHT="right",this.COLOR_NONE="none",this.COLOR_1="color_1",this.COLOR_2="color_2",this.COLOR_3="color_3",this.COLOR_4="color_4",this.FEED_PEELING="peeling",this.FEED_CUTTING="cutting",this.FEED_CURRENT_TOF="current_tof",this.FEED_NEXT_TOF="next_tof",this.HALFTONE_DITHER=0,this.HALFTONE_ERROR_DIFFUSION=1,this.HALFTONE_THRESHOLD=2,this.MODE_MONO="mono",this.MODE_GRAY16="gray16",this.PAPER_RECEIPT="receipt",this.PAPER_RECEIPT_BM="receipt_bm",this.PAPER_LABEL="label",this.PAPER_LABEL_BM="label_bm",this.connectionObj=null}function POSKeyboard(t,e){this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function Printer(t,e,n){this.deviceID=t,this.isCrypto=e,this.ePosDev=n,this.timeout=1e4}function HybridPrinter(t,e,n){this.deviceID=t,this.isCrypto=e,this.ePosDev=n,this.connectionObj=null,this.ReceiptPrinter,this.SlipPrinter,this.EndorsePrinter,this.MICRReader,this.force=!1,this.onstatuschange,this.ononline,this.onoffline,this.onpoweroff,this.oncoveropen,this.onpaperok,this.onpapernearend,this.onpaperend,this.ondrawerclosed,this.ondraweropen,this.ASB_NO_RESPONSE=1,this.ASB_PRINT_SUCCESS=2,this.ASB_DRAWER_KICK=4,this.ASB_OFF_LINE=8,this.ASB_COVER_OPEN=32,this.ASB_PAPER_FEED=64,this.ASB_WAIT_ON_LINE=256,this.ASB_PANEL_SWITCH=512,this.ASB_MECHANICAL_ERR=1024,this.ASB_AUTOCUTTER_ERR=2048,this.ASB_UNRECOVER_ERR=8192,this.ASB_AUTORECOVER_ERR=16384,this.ASB_RECEIPT_NEAR_END=131072,this.ASB_RECEIPT_END=524288,this.ASB_TOF_NOPAPER=2097152,this.ASB_BOF_NOPAPER=4194304,this.ASB_SLIP_NO_SELECT=16777216,this.ASB_SLIP_IMPOSSIBLE_PRINT=33554432,this.ASB_SPOOLER_IS_STOPPED=2147483648,this.SUCCESS="SUCCESS",this.CANCEL="CANCEL",this.ERROR_PARAMMETER="ERROR_PARAMMETER",this.ERROR_COMMAND="ERROR_COMMAND",this.ERROR_DEVICE_NOT_FOUND="ERROR_DEVICE_NOT_FOUND",this.ERROR_DEVICE_BUSY="ERROR_DEVICE_BUSY",this.ERROR_NOT_SUPPORTED="ERROR_NOT_SUPPORTED",this.ERROR_COVER_OPEN="ERROR_COVER_OPEN",this.ERROR_TIMEOUT="ERROR_TIMEOUT",this.ERROR_AUTOMATICAL="ERROR_AUTOMATICAL",this.ERROR_UNRECOVERABLE="ERROR_UNRECOVERABLE",this.ERROR_BADPORT="ERROR_BADPORT",this.SYSTEM_ERROR="SYSTEM_ERROR",this.init(t)}function ReceiptPrinter(t){this.parent=t,this.methodName="",this.deviceID=this.parent.deviceID,this.ePosDev=this.parent.ePosDev,this.connectionObj=null,this.SUCCESS="SUCCESS",this.CANCEL="CANCEL",this.ERROR_PARAMMETER="ERROR_PARAMMETER",this.ERROR_COMMAND="ERROR_COMMAND",this.ERROR_DEVICE_NOT_FOUND="DeviceNotFound",this.ERROR_DEVICE_BUSY="ERROR_DEVICE_BUSY",this.ERROR_NOT_SUPPORTED="ERROR_NOT_SUPPORTED",this.ERROR_COVER_OPEN="EPTR_COVER_OPEN",this.ERROR_TIMEOUT="EX_TIMEOUT",this.ERROR_AUTOMATICAL="EPTR_AUTOMATICAL",this.ERROR_UNRECOVERABLE="EPTR_UNRECOVERABLE",this.ERROR_BADPORT="EX_BADPORT",this.SYSTEM_ERROR="SYSTEM_ERROR",this.EPTR_CUTTER="EPTR_CUTTER",this.EPTR_MECHANICAL="EPTR_MECHANICAL",this.EPTR_REC_EMPTY="EPTR_REC_EMPTY",this.EPTR_SCHEMAERROR="SchemaError",this.EPTR_PRINT_SYSTEM_ERROR="PrintSystemError"}function SlipPrinter(t){this.parent=t,this.SUCCESS="SUCCESS",this.CANCEL="CANCEL",this.ERROR_PARAMMETER="ERROR_PARAMMETER",this.ERROR_COMMAND="ERROR_COMMAND",this.ERROR_DEVICE_NOT_FOUND="ERROR_DEVICE_NOT_FOUND",this.ERROR_DEVICE_BUSY="ERROR_DEVICE_BUSY",this.ERROR_NOT_SUPPORTED="ERROR_NOT_SUPPORTED",this.ERROR_COVER_OPEN="ERROR_COVER_OPEN",this.ERROR_TIMEOUT="ERROR_TIMEOUT",this.ERROR_AUTOMATICAL="ERROR_AUTOMATICAL",this.ERROR_UNRECOVERABLE="ERROR_UNRECOVERABLE",this.ERROR_BADPORT="ERROR_BADPORT",this.SYSTEM_ERROR="SYSTEM_ERROR",this.EPTR_CUTTER="EPTR_CUTTER",this.EPTR_MECHANICAL="EPTR_MECHANICAL",this.EPTR_REC_EMPTY="EPTR_REC_EMPTY",this.EPTR_SCHEMAERROR="EPTR_SCHEMAERROR",this.EPTR_PRINT_SYSTEM_ERROR="EPTR_PRINT_SYSTEM_ERROR"}function EndorsePrinter(t){this.parent=t,this.mode40cpl=!1,this.SUCCESS="SUCCESS",this.CANCEL="CANCEL",this.ERROR_PARAMMETER="ERROR_PARAMMETER",this.ERROR_COMMAND="ERROR_COMMAND",this.ERROR_DEVICE_NOT_FOUND="ERROR_DEVICE_NOT_FOUND",this.ERROR_DEVICE_BUSY="ERROR_DEVICE_BUSY",this.ERROR_NOT_SUPPORTED="ERROR_NOT_SUPPORTED",this.ERROR_COVER_OPEN="ERROR_COVER_OPEN",this.ERROR_TIMEOUT="ERROR_TIMEOUT",this.ERROR_AUTOMATICAL="ERROR_AUTOMATICAL",this.ERROR_UNRECOVERABLE="ERROR_UNRECOVERABLE",this.ERROR_BADPORT="ERROR_BADPORT",this.SYSTEM_ERROR="SYSTEM_ERROR",this.EPTR_CUTTER="EPTR_CUTTER",this.EPTR_MECHANICAL="EPTR_MECHANICAL",this.EPTR_REC_EMPTY="EPTR_REC_EMPTY",this.EPTR_SCHEMAERROR="EPTR_SCHEMAERROR",this.EPTR_PRINT_SYSTEM_ERROR="EPTR_PRINT_SYSTEM_ERROR"}function MICRReader(t){this.parent=t,this.timeout=6e4,this.FONT_E13B="MICR_E13B",this.FONT_CMC7="MICR_CMC7",this.SUCCESS="SUCCESS",this.CANCEL="CANCEL",this.ERROR_PARAMMETER="ERROR_PARAMMETER",this.ERROR_COMMAND="ERROR_COMMAND",this.ERROR_DEVICE_NOT_FOUND="ERROR_DEVICE_NOT_FOUND",this.ERROR_DEVICE_BUSY="ERROR_DEVICE_BUSY",this.ERROR_NOT_SUPPORTED="ERROR_NOT_SUPPORTED",this.ERROR_COVER_OPEN="ERROR_COVER_OPEN",this.ERROR_TIMEOUT="ERROR_TIMEOUT",this.ERROR_AUTOMATICAL="ERROR_AUTOMATICAL",this.ERROR_UNRECOVERABLE="ERROR_UNRECOVERABLE",this.ERROR_BADPORT="ERROR_BADPORT",this.SYSTEM_ERROR="SYSTEM_ERROR",this.EMICR_ILLEGAL_LENGTH="EMICR_ILLEGAL_LENGTH",this.EMICR_NO_MICR="EMICR_NO_MICR",this.EMICR_RECOGNITION="EMICR_RECOGNITION",this.EMICR_READ="EMICR_READ",this.EMICR_NOISE_DETECTED="EMICR_NOISE_DETECTED",this.EMICR_COVER_OPENED="EMICR_COVER_OPENED",this.EMICR_PAPER_JAM="EMICR_PAPER_JAM"}function HybridPrinter2(t,e,n){this.deviceID=t,this.isCrypto=e,this.ePosDev=n,this.connectionObj=null,this.ReceiptPrinter=null,this.SlipPrinter2=null,this.ValidationPrinter=null,this.EndorsePrinter2=null,this.MICRReader2=null,this.currentPrinter=null,this.isMicrMode=!1,this.FONT_A="font_a",this.FONT_B="font_b",this.FONT_C="font_c",this.FONT_D="font_d",this.FONT_E="font_e",this.FONT_SPECIAL_A="special_a",this.FONT_SPECIAL_B="special_b",this.ALIGN_LEFT="left",this.ALIGN_CENTER="center",this.ALIGN_RIGHT="right",this.COLOR_NONE="none",this.COLOR_1="color_1",this.COLOR_2="color_2",this.COLOR_3="color_3",this.COLOR_4="color_4",this.FEED_PEELING="peeling",this.FEED_CUTTING="cutting",this.FEED_CURRENT_TOF="current_tof",this.FEED_NEXT_TOF="next_tof",this.MODE_MONO="mono",this.MODE_GRAY16="gray16",this.BARCODE_UPC_A="upc_a",this.BARCODE_UPC_E="upc_e",this.BARCODE_EAN13="ean13",this.BARCODE_JAN13="jan13",this.BARCODE_EAN8="ean8",this.BARCODE_JAN8="jan8",this.BARCODE_CODE39="code39",this.BARCODE_ITF="itf",this.BARCODE_CODABAR="codabar",this.BARCODE_CODE93="code93",this.BARCODE_CODE128="code128",this.BARCODE_GS1_128="gs1_128",this.BARCODE_GS1_DATABAR_OMNIDIRECTIONAL="gs1_databar_omnidirectional",this.BARCODE_GS1_DATABAR_TRUNCATED="gs1_databar_truncated",this.BARCODE_GS1_DATABAR_LIMITED="gs1_databar_limited",this.BARCODE_GS1_DATABAR_EXPANDED="gs1_databar_expanded",this.HRI_NONE="none",this.HRI_ABOVE="above",this.HRI_BELOW="below",this.HRI_BOTH="both",this.SYMBOL_PDF417_STANDARD="pdf417_standard",this.SYMBOL_PDF417_TRUNCATED="pdf417_truncated",this.SYMBOL_QRCODE_MODEL_1="qrcode_model_1",this.SYMBOL_QRCODE_MODEL_2="qrcode_model_2",this.SYMBOL_QRCODE_MICRO="qrcode_micro",this.SYMBOL_MAXICODE_MODE_2="maxicode_mode_2",this.SYMBOL_MAXICODE_MODE_3="maxicode_mode_3",this.SYMBOL_MAXICODE_MODE_4="maxicode_mode_4",this.SYMBOL_MAXICODE_MODE_5="maxicode_mode_5",this.SYMBOL_MAXICODE_MODE_6="maxicode_mode_6",this.SYMBOL_GS1_DATABAR_STACKED="gs1_databar_stacked",this.SYMBOL_GS1_DATABAR_STACKED_OMNIDIRECTIONAL="gs1_databar_stacked_omnidirectional",this.SYMBOL_GS1_DATABAR_EXPANDED_STACKED="gs1_databar_expanded_stacked",this.SYMBOL_AZTECCODE_FULLRANGE="azteccode_fullrange",this.SYMBOL_AZTECCODE_COMPACT="azteccode_compact",this.SYMBOL_DATAMATRIX_SQUARE="datamatrix_square",this.SYMBOL_DATAMATRIX_RECTANGLE_8="datamatrix_rectangle_8",this.SYMBOL_DATAMATRIX_RECTANGLE_12="datamatrix_rectangle_12",this.SYMBOL_DATAMATRIX_RECTANGLE_16="datamatrix_rectangle_16",this.LEVEL_0="level_0",this.LEVEL_1="level_1",this.LEVEL_2="level_2",this.LEVEL_3="level_3",this.LEVEL_4="level_4",this.LEVEL_5="level_5",this.LEVEL_6="level_6",this.LEVEL_7="level_7",this.LEVEL_8="level_8",this.LEVEL_L="level_l",this.LEVEL_M="level_m",this.LEVEL_Q="level_q",this.LEVEL_H="level_h",this.LEVEL_DEFAULT="default",this.LINE_THIN="thin",this.LINE_MEDIUM="medium",this.LINE_THICK="thick",this.LINE_THIN_DOUBLE="thin_double",this.LINE_MEDIUM_DOUBLE="medium_double",this.LINE_THICK_DOUBLE="thick_double",this.DIRECTION_LEFT_TO_RIGHT="left_to_right",this.DIRECTION_BOTTOM_TO_TOP="bottom_to_top",this.DIRECTION_RIGHT_TO_LEFT="right_to_left",this.DIRECTION_TOP_TO_BOTTOM="top_to_bottom",this.CUT_NO_FEED="no_feed",this.CUT_FEED="feed",this.CUT_RESERVE="reserve",this.DRAWER_1="drawer_1",this.DRAWER_2="drawer_2",this.PULSE_100="pulse_100",this.PULSE_200="pulse_200",this.PULSE_300="pulse_300",this.PULSE_400="pulse_400",this.PULSE_500="pulse_500",this.PATTERN_NONE="none",this.PATTERN_0="pattern_0",this.PATTERN_1="pattern_1",this.PATTERN_2="pattern_2",this.PATTERN_3="pattern_3",this.PATTERN_4="pattern_4",this.PATTERN_5="pattern_5",this.PATTERN_6="pattern_6",this.PATTERN_7="pattern_7",this.PATTERN_8="pattern_8",this.PATTERN_9="pattern_9",this.PATTERN_10="pattern_10",this.PATTERN_A="pattern_a",this.PATTERN_B="pattern_b",this.PATTERN_C="pattern_c",this.PATTERN_D="pattern_d",this.PATTERN_E="pattern_e",this.PATTERN_ERROR="error",this.PATTERN_PAPER_END="paper_end",this.LAYOUT_RECEIPT="receipt",this.LAYOUT_RECEIPT_BM="receipt_bm",this.LAYOUT_LABEL="label",this.LAYOUT_LABEL_BM="label_bm",this.HALFTONE_DITHER=0,this.HALFTONE_ERROR_DIFFUSION=1,this.HALFTONE_THRESHOLD=2,this.ASB_NO_RESPONSE=1,this.ASB_PRINT_SUCCESS=2,this.ASB_DRAWER_KICK=4,this.ASB_OFF_LINE=8,this.ASB_COVER_OPEN=32,this.ASB_PAPER_FEED=64,this.ASB_WAIT_ON_LINE=256,this.ASB_PANEL_SWITCH=512,this.ASB_MECHANICAL_ERR=1024,this.ASB_AUTOCUTTER_ERR=2048,this.ASB_UNRECOVER_ERR=8192,this.ASB_AUTORECOVER_ERR=16384,this.ASB_INSERTION_WAIT_PAPER=65536,this.ASB_RECEIPT_NEAR_END=131072,this.ASB_REMOVAL_WAIT_PAPER=262144,this.ASB_RECEIPT_END=524288,this.ASB_TOF_NOPAPER=2097152,this.ASB_BOF_NOPAPER=4194304,this.ASB_SLIP_NO_SELECT=16777216,this.ASB_SLIP_IMPOSSIBLE_PRINT=33554432,this.ASB_EJD_NOPAPER=1073741824,this.ASB_VALIDATION_NO_SELECT=67108864,this.ASB_VALIDATION_IMPOSSIBLE_PRINT=134217728,this.ASB_SPOOLER_IS_STOPPED=2147483648,this.DRAWER_OPEN_LEVEL_LOW=0,this.DRAWER_OPEN_LEVEL_HIGH=1,this.SUCCESS="SUCCESS",this.CANCEL="CANCEL",this.ERROR_CANCEL_FAILED="ERROR_CANCEL_FAILED",this.ERROR_PARAMMETER="ERROR_PARAMMETER",this.ERROR_COMMAND="ERROR_COMMAND",this.ERROR_DEVICE_NOT_FOUND="ERROR_DEVICE_NOT_FOUND",this.ERROR_DEVICE_BUSY="ERROR_DEVICE_BUSY",this.ERROR_NOT_SUPPORTED="ERROR_NOT_SUPPORTED",this.ERROR_COVER_OPEN="ERROR_COVER_OPEN",this.ERROR_TIMEOUT="ERROR_TIMEOUT",this.ERROR_AUTOMATICAL="ERROR_AUTOMATICAL",this.ERROR_UNRECOVERABLE="ERROR_UNRECOVERABLE",this.ERROR_BADPORT="ERROR_BADPORT",this.SYSTEM_ERROR="SYSTEM_ERROR",this.EPTR_AUTOMATICAL="EPTR_AUTOMATICAL",this.EPTR_COVER_OPEN="EPTR_COVER_OPEN",this.EPTR_CUTTER="EPTR_CUTTER",this.EPTR_MECHANICAL="EPTR_MECHANICAL",this.EPTR_REC_EMPTY="EPTR_REC_EMPTY",this.EPTR_UNRECOVERABLE="EPTR_UNRECOVERABLE",this.EPTR_SCHEMAERROR="EPTR_SCHEMAERROR",this.EPTR_PRINT_SYSTEM_ERROR="EPTR_PRINT_SYSTEM_ERROR",this.EPTR_PAPER_PULLED_OUT="EPTR_PAPER_PULLED_OUT",this.EMICR_ILLEGAL_LENGTH="EMICR_ILLEGAL_LENGTH",this.EMICR_NO_MICR="EMICR_NO_MICR",this.EMICR_RECOGNITION="EMICR_RECOGNITION",this.EMICR_READ="EMICR_READ",this.EMICR_NOISE_DETECTED="EMICR_NOISE_DETECTED",this.EMICR_COVER_OPENED="EMICR_COVER_OPENED",this.EMICR_PAPER_JAM="EMICR_PAPER_JAM",this.EMICR_PAPER_PULLED_OUT="EMICR_PAPER_PULLED_OUT",this.DeviceNotFound="DeviceNotFound",this.EX_TIMEOUT="EX_TIMEOUT",this.EX_BADPORT="EX_BADPORT",this.SchemaError="SchemaError",this.PrintSystemError="PrintSystemError",this.PAPERTYPE_RECEIPT=0,this.PAPERTYPE_SLIP=1,this.PAPERTYPE_ENDORSE=2,this.PAPERTYPE_VALIDATION=3,this.FONT_E13B="MICR_E13B",this.FONT_CMC7="MICR_CMC7",this.halftone=this.HALFTONE_DITHER,this.brightness=1,this.force=!1,this.drawerOpenLevel=this.DRAWER_OPEN_LEVEL_LOW,this.paperType=this.PAPERTYPE_RECEIPT,this.interval=3e3,this.waitTime=500,this.enable40cplMode=!0,this.onstatuschange=null,this.ononline=null,this.onoffline=null,this.onpoweroff=null,this.oncoveropen=null,this.onpaperok=null,this.onpapernearend=null,this.onpaperend=null,this.ondrawerclosed=null,this.ondraweropen=null,this.init(t)}function SlipPrinter2(t){this.parent=t}function EndorsePrinter2(t){this.parent=t,this.mode40cpl=!1}function MICRReader2(t){this.parent=t}function ValidationPrinter(t){this.parent=t}function Scanner(t,e){this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function SimpleSerial(t,e){this.deviceID=t,this.isCrypto=e,this.connectionObj=null}function GermanyFiscalElement(t,e){this.deviceID=t,this.isCrypto=e,this.connectionObj=null,this.ongfereceive=null,this.onerror=null}function Ofsc(){this.SERVICE_ID="OFSC",this.callback=null,this.connectionObj=null}function CookieIO(){this.KEY="EPSON_EPOSDEVICE_CLIENTID",this.EXPIRES_MINUTES=5}function DeviceObjElement(t,e,n,i){this.deviceId=t,this.isCrypto=e,this.deviceObject=n,this.callback=i}function DeviceObjElementMap(){this.elementList=new Array}function ePOSDevice(){this.DEVICE_TYPE_SCANNER="type_scanner",this.DEVICE_TYPE_KEYBOARD="type_keyboard",this.DEVICE_TYPE_POSKEYBOARD="type_poskeyboard",this.DEVICE_TYPE_MSR="type_msr",this.DEVICE_TYPE_CAT="type_cat",this.DEVICE_TYPE_CASH_CHANGER="type_cash_changer",this.DEVICE_TYPE_PRINTER="type_printer",this.DEVICE_TYPE_DISPLAY="type_display",this.DEVICE_TYPE_SIMPLE_SERIAL="type_simple_serial",this.DEVICE_TYPE_HYBRID_PRINTER="type_hybrid_printer",this.DEVICE_TYPE_HYBRID_PRINTER2="type_hybrid_printer2",this.DEVICE_TYPE_DT="type_dt",this.DEVICE_TYPE_OTHER_PERIPHERAL="type_other_peripheral",this.DEVICE_TYPE_GFE="type_storage",this.RESULT_OK="OK",this.ERROR_SYSTEM="SYSTEM_ERROR",this.ERROR_DEVICE_IN_USE="DEVICE_IN_USE",this.ERROR_DEVICE_OPEN="DEVICE_OPEN_ERROR",this.ERROR_DEVICE_CLOSE="DEVICE_CLOSE_ERROR",this.ERROR_DEVICE_NOT_OPEN="DEVICE_NOT_OPEN",this.ERROR_DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",this.ERROR_PARAMETER="ERROR_PARAMETER",this.IFPORT_EPOSDEVICE=8008,this.IFPORT_EPOSDEVICE_S=8043,this.CONNECT_TIMEOUT=15e3,this.RECONNECT_TIMEOUT=3e3,this.MAX_RECONNECT_RETRY=5,this.socket=null,this.connectionId=null,this.reconnectTimerId=null,this.reconnectTryCount=0,this.admin="",this.location="",this.recievedDataId=0,this.connectStartTime=0,this.waitRetryConnectId=0,this.conectionObj=new Connection,this.commBoxManager=new CommBoxManager,this.commBoxManager.setConnectionObject(this.conectionObj),this.devObjSelector=new DeviceObjectSelector,this.devObjSelector.setConnectionObject(this.conectionObj),this.devObjElmMap=new DeviceObjElementMap,this.ofsc=new Ofsc,this.ofsc.setConnectionObject(this.conectionObj),this.cookieIo=new CookieIO,this.gbox=new SocketGarbageBox,this.eposprint=!1;var t=this;window.onbeforeunload=function(){t.disconnect()},window.onpagehide=function(){t.disconnect()}}function SocketGarbageBox(){this.box=new Array}function Connection(){this.OK="OK",this.SSL_CONNECT_OK="SSL_CONNECT_OK",this.ERROR_TIMEOUT="ERROR_TIMEOUT",this.ERROR_PARAMETER="ERROR_PARAMETER",this.ERROR_SYSTEM="SYSTEM_ERROR",this.socket_p=null,this.address_p="",this.protocol_p="",this.port_p="",this.callback_p=null,this.usableIF_p=0,this.ws_status_p=2,this.dev_status_p=2,this.IF_EPOSDEVICE=1,this.IF_EPOSPRINT=2,this.IF_EPOSDISPLAY=4,this.IF_ALL=7,this.ACCESS_OK="OK",this.ACCESS_ERROR="ERROR",this.ACCESS_TIMEOUT="TIMEOUT",this.ACCESS_NONE="NONE",this.CONNECT=1,this.DISCONNECT=2,this.RECONNECTING=4}function ePosCrypto(){this.pubkey_c="",this.secretKey=""}function ePosDeviceMessage(){this.REQUEST={CONNECT:"connect",PUBKEY:"pubkey",ADMININFO:"admin_info",RECONNECT:"reconnect",DISCONNECT:"disconnect",OPENDEVICE:"open_device",CLOSEDEVICE:"close_device",DEVICEDATA:"device_data",SERVICEDATA:"service_data",ERROR:"error",OPENCOMMBOX:"open_commbox",CLOSECOMMBOX:"close_commbox",COMMDATA:"commbox_data"},this.request=null,this.sequence=0,this.deviceId="",this.serviceId="",this.data={},this.isCrypto="0",this.code="",this.data_id=0}ePOSPrint.prototype=new ePOSBuilder,ePOSPrint.prototype.constructor=ePOSPrint,ePOSPrint.prototype.open=function(){this.enabled||(this.enabled=!0,this.status=0,this.battery=0,this.send())},ePOSPrint.prototype.close=function(){this.enabled=!1,this.intervalid&&(clearTimeout(this.intervalid),delete this.intervalid),this.intervalxhr&&(this.intervalxhr.abort(),delete this.intervalxhr)},ePOSPrint.prototype.getPrintJobStatus=function(t){this.send(t)},ePOSPrint.prototype.send=function(t,e){var n,i,r,s,o,a,c,h,u=arguments.length,p=this,l=p.address;if(/^<epos/.test(t)||(u<2?(e=t,t=(new ePOSBuilder).toString()):(l=t,t=e,e=arguments[2])),n='<?xml version="1.0" encoding="utf-8"?><s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">',e&&(n+='<s:Header><parameter xmlns="http://www.epson-pos.com/schemas/2011/03/epos-print"><printjobid>'+e+"</printjobid></parameter></s:Header>"),n+="<s:Body>"+t+"</s:Body></s:Envelope>",!window.XMLHttpRequest)throw new Error("XMLHttpRequest is not supported");!("withCredentials"in(i=new XMLHttpRequest))&&window.XDomainRequest?((i=new XDomainRequest).open("POST",l,!0),i.onload=function(){s=i.responseText,/response/.test(s)?(o=/success\s*=\s*"\s*(1|true)\s*"/.test(s),a=s.match(/code\s*=\s*"\s*(\S*)\s*"/)?RegExp.$1:"",c=s.match(/status\s*=\s*"\s*(\d+)\s*"/)?parseInt(RegExp.$1):0,h=s.match(/battery\s*=\s*"\s*(\d+)\s*"/)?parseInt(RegExp.$1):0,e=s.match(/<printjobid>\s*(\S*)\s*<\/printjobid>/)?RegExp.$1:"",u>0?fireReceiveEvent(p,o,a,c,h,e):fireStatusEvent(p,c,h)):u>0?fireErrorEvent(p,0,i.responseText):fireStatusEvent(p,p.ASB_NO_RESPONSE,0),u<1&&updateStatus(p)},i.onerror=function(){u>0?fireErrorEvent(p,0,i.responseText):(fireStatusEvent(p,p.ASB_NO_RESPONSE,0),updateStatus(p))},i.onprogress=function(){},i.ontimeout=i.onerror,i.timeout=p.timeout,i.send(n)):(i.open("POST",l,!0),i.setRequestHeader("Content-Type","text/xml; charset=utf-8"),i.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:00 GMT"),i.setRequestHeader("SOAPAction",'""'),i.onreadystatechange=function(){4==i.readyState&&(clearTimeout(r),200==i.status&&i.responseXML&&(s=i.responseXML.getElementsByTagName("response")).length>0?(o=/^(1|true)$/.test(s[0].getAttribute("success")),a=s[0].hasAttribute("code")?s[0].getAttribute("code"):"",c=s[0].hasAttribute("status")?parseInt(s[0].getAttribute("status")):0,h=s[0].hasAttribute("battery")?parseInt(s[0].getAttribute("battery")):0,s=i.responseXML.getElementsByTagName("printjobid"),e=s.length>0?s[0].textContent:"",u>0?fireReceiveEvent(p,o,a,c,h,e):fireStatusEvent(p,c,h)):u>0?fireErrorEvent(p,i.status,i.responseText):fireStatusEvent(p,p.ASB_NO_RESPONSE,0),u<1&&updateStatus(p))},r=setTimeout(function(){i.abort()},p.timeout),i.send(n)),u<1&&(p.intervalxhr=i)},CanvasPrint.prototype=new ePOSPrint,CanvasPrint.prototype.constructor=CanvasPrint,CanvasPrint.prototype.setConnectionObject=function(t){this.connectionObj=t},CanvasPrint.prototype.print=function(){var t=arguments.length,e=this.address,n=this.layout,i=this.paper,r=arguments[0],s=this.cut,o=this.mode,a=undefined;switch(t){case 2:a=arguments[1];break;case 4:a=arguments[3];case 3:s=arguments[1],o=arguments[2]}if(void 0===r||null==r)throw new Error("Canvas is not supported");if(!r.getContext)throw new Error("Canvas is not supported");n&&this.addLayout(i,n.width,n.height,n.margin_top,n.margin_bottom,n.offset_cut,n.offset_label),i!=this.PAPER_RECEIPT&&(this.addFeedPosition(this.FEED_CURRENT_TOF),n&&this.addFeedPosition(this.FEED_NEXT_TOF)),this.addTextAlign(this.align),this.addImage(r.getContext("2d"),0,0,r.width,r.height,this.color,o),i!=this.PAPER_RECEIPT?(this.addFeedPosition(this.feed),s&&this.addCut(this.CUT_NO_FEED)):s&&this.addCut(this.CUT_FEED),this.send(e,this.toString(),a)},CanvasPrint.prototype.recover=function(){this.force=!0,this.addRecovery(),this.send(this.address,this.toString())},CanvasPrint.prototype.reset=function(){this.addReset(),this.send(this.address,this.toString())},window.epson||(window.epson={}),window.epson.ePOSBuilder=ePOSBuilder,window.epson.ePOSPrint=ePOSPrint,window.epson.CanvasPrint=CanvasPrint,POSKeyboard.prototype={setConnectionObject:function(t){this.connectionObj=t},client_onkeypress:function(t){try{if(null==this.onkeypress)return;this.onkeypress(t)}catch(e){}},callEvent:function(t,e){var n=e;n.type=t;var i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto),r=-1;try{this.connectionObj.emit(i),r=i.sequence}catch(s){}return r}},Printer.prototype=new CanvasPrint,Printer.prototype.finalize=function(){this.stopMonitor()},Printer.prototype.toString=function(){return ePOSBuilder.prototype.toString.apply(this)},Printer.prototype.addFeedUnit=function(t){try{ePOSBuilder.prototype.addFeedUnit.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addFeedLine=function(t){try{ePOSBuilder.prototype.addFeedLine.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addFeed=function(t){try{ePOSBuilder.prototype.addFeed.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addFeedPosition=function(t){try{ePOSBuilder.prototype.addFeedPosition.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addText=function(t){try{ePOSBuilder.prototype.addText.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextLang=function(t){try{ePOSBuilder.prototype.addTextLang.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextAlign=function(t){try{ePOSBuilder.prototype.addTextAlign.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextRotate=function(t){try{ePOSBuilder.prototype.addTextRotate.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextLineSpace=function(t){try{ePOSBuilder.prototype.addTextLineSpace.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextFont=function(t){try{ePOSBuilder.prototype.addTextFont.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextSmooth=function(t){try{ePOSBuilder.prototype.addTextSmooth.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextDouble=function(t,e){try{ePOSBuilder.prototype.addTextDouble.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addTextSize=function(t,e){try{ePOSBuilder.prototype.addTextSize.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addTextStyle=function(t,e,n,i){try{ePOSBuilder.prototype.addTextStyle.apply(this,arguments)}catch(r){throw r}return this},Printer.prototype.addTextPosition=function(t){try{ePOSBuilder.prototype.addTextPosition.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addTextVPosition=function(t){try{ePOSBuilder.prototype.addTextVPosition.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addImage=function(t,e,n,i,r,s,o){try{ePOSBuilder.prototype.addImage.apply(this,arguments)}catch(a){throw a}return this},Printer.prototype.addLogo=function(t,e){try{ePOSBuilder.prototype.addLogo.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addBarcode=function(t,e,n,i,r,s){try{ePOSBuilder.prototype.addBarcode.apply(this,arguments)}catch(o){throw o}return this},Printer.prototype.addSymbol=function(t,e,n,i,r,s){try{ePOSBuilder.prototype.addSymbol.apply(this,arguments)}catch(o){throw o}return this},Printer.prototype.addCommand=function(t){try{ePOSBuilder.prototype.addCommand.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addHLine=function(t,e,n){try{ePOSBuilder.prototype.addHLine.apply(this,arguments)}catch(i){throw i}return this},Printer.prototype.addVLineBegin=function(t,e){try{ePOSBuilder.prototype.addVLineBegin.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addVLineEnd=function(t,e){try{ePOSBuilder.prototype.addVLineEnd.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addPageBegin=function(){try{ePOSBuilder.prototype.addPageBegin.apply(this)}catch(t){throw t}return this},Printer.prototype.addPageEnd=function(){try{ePOSBuilder.prototype.addPageEnd.apply(this)}catch(t){throw t}return this},Printer.prototype.addPageArea=function(t,e,n,i){try{ePOSBuilder.prototype.addPageArea.apply(this,arguments)}catch(r){throw r}return this},Printer.prototype.addPageDirection=function(t){try{ePOSBuilder.prototype.addPageDirection.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addPagePosition=function(t,e){try{ePOSBuilder.prototype.addPagePosition.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addPageLine=function(t,e,n,i,r){try{ePOSBuilder.prototype.addPageLine.apply(this,arguments)}catch(s){throw s}return this},Printer.prototype.addPageRectangle=function(t,e,n,i,r){try{ePOSBuilder.prototype.addPageRectangle.apply(this,arguments)}catch(s){throw s}return this},Printer.prototype.addRotateBegin=function(){try{ePOSBuilder.prototype.addRotateBegin.apply(this)}catch(t){throw t}return this},Printer.prototype.addRotateEnd=function(){try{ePOSBuilder.prototype.addRotateEnd.apply(this)}catch(t){throw t}return this},Printer.prototype.addCut=function(t){try{ePOSBuilder.prototype.addCut.apply(this,arguments)}catch(e){throw e}return this},Printer.prototype.addPulse=function(t,e){try{ePOSBuilder.prototype.addPulse.apply(this,arguments)}catch(n){throw n}return this},Printer.prototype.addSound=function(t,e,n){try{ePOSBuilder.prototype.addSound.apply(this,arguments)}catch(i){throw i}return this},Printer.prototype.addLayout=function(t,e,n,i,r,s,o){try{ePOSBuilder.prototype.addLayout.apply(this,arguments)}catch(a){throw a}return this},Printer.prototype.setXmlString=function(t){this.message=t},Printer.prototype.getXmlString=function(){return this.message},Printer.prototype.getPrintJobStatus=function(t){this.setXmlString(""),this.send(t)},Printer.prototype.send=function(t){var e=-1;if(!this.ePosDev.eposprint&&this.connectionObj.isUsableDeviceIF())try{var n={type:"print",timeout:this.timeout,printdata:this.toString()};switch(arguments.length){case 0:n.printdata=this.toString();break;case 1:n.printdata=this.toString(),n.printjobid=t;break;case 2:case 3:n.printdata=arguments[1],n.printjobid=arguments[2]}var i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto);try{this.connectionObj.emit(i),i.sequence}catch(f){}this.force=!1,this.setXmlString("")}catch(f){e=-1}else{var r,s,o,a,c,h,u,p,l=this,d=this.connectionObj.getAddressWithProtocol()+"/cgi-bin/epos/service.cgi?devid="+this.deviceID+"&timeout="+this.timeout;if(r='<?xml version="1.0" encoding="utf-8"?><s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">',t&&(r+='<s:Header><parameter xmlns="http://www.epson-pos.com/schemas/2011/03/epos-print"><printjobid>'+t+"</printjobid></parameter></s:Header>"),r+="<s:Body>"+this.toString()+"</s:Body></s:Envelope>",!window.XMLHttpRequest)throw new Error("XMLHttpRequest is not supported");!("withCredentials"in(s=new XMLHttpRequest))&&window.XDomainRequest?((s=new XDomainRequest).open("POST",d,!0),s.onload=function(){a=s.responseText,/response/.test(a)?(c=/success\s*=\s*"\s*(1|true)\s*"/.test(a),h=a.match(/code\s*=\s*"\s*(\S*)\s*"/)?RegExp.$1:"",u=a.match(/status\s*=\s*"\s*(\d+)\s*"/)?parseInt(RegExp.$1):0,p=a.match(/battery\s*=\s*"\s*(\d+)\s*"/)?parseInt(RegExp.$1):0,t=a.match(/<printjobid>\s*(\S*)\s*<\/printjobid>/)?RegExp.$1:"",l.fireReceiveEvent(c,h,u,p,t,0)):l.fireErrorEvent(0,s.responseText,0)},s.onerror=function(){l.fireErrorEvent(0,s.responseText,0)},s.onprogress=function(){},s.ontimeout=s.onerror,s.timeout=l.timeout,s.send(r)):(s.open("POST",d,!0),s.setRequestHeader("Content-Type","text/xml; charset=utf-8"),s.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:00 GMT"),s.setRequestHeader("SOAPAction",'""'),s.onreadystatechange=function(){4==s.readyState&&(clearTimeout(o),200==s.status&&s.responseXML&&(a=s.responseXML.getElementsByTagName("response")).length>0?(c=/^(1|true)$/.test(a[0].getAttribute("success")),h=a[0].hasAttribute("code")?a[0].getAttribute("code"):"",u=a[0].hasAttribute("status")?parseInt(a[0].getAttribute("status")):0,p=a[0].hasAttribute("battery")?parseInt(a[0].getAttribute("battery")):0,a=s.responseXML.getElementsByTagName("printjobid"),t=a.length>0?a[0].textContent:"",l.fireReceiveEvent(c,h,u,p,t,0)):l.fireErrorEvent(s.status,s.responseText,0))},o=setTimeout(function(){s.abort()},this.timeout),s.send(r)),this.setXmlString(""),e=0}return e},Printer.prototype.client_onxmlresult=function(t,e){if(t){var n=t.resultdata,i=/success\s*=\s*"\s*(1|true)\s*"/.test(n);n.match(/code\s*=\s*"\s*(\S*)\s*"/);var r=RegExp.$1;n.match(/status\s*=\s*"\s*(\d+)\s*"/);var s=parseInt(RegExp.$1);n.match(/battery\s*=\s*"\s*(\d+)\s*"/);var o=parseInt(RegExp.$1);this.fireReceiveEvent(i,r,s,o,t.printjobid,e)}else this.fireErrorEvent(0,this.ASB_NO_RESPONSE,e)},Printer.prototype.startMonitor=function(){var t=!1,e=this.connectionObj.getAddressWithProtocol()+"/cgi-bin/epos/service.cgi?devid="+this.deviceID+"&timeout=10000";try{this.enabled||(this.address=e,this.enabled=!0,this.status=this.ASB_DRAWER_KICK,this.sendStartMonitorCommand()),t=!0}catch(n){throw n}return t},Printer.prototype.sendStartMonitorCommand=function(){var t=this,e=this.address,n='<?xml version="1.0" encoding="utf-8"?><s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body>'+(new ePOSBuilder).toString()+"</s:Body></s:Envelope>",i=this;if(window.XDomainRequest){var r=new XDomainRequest;r.open("POST",e,!0),r.onload=function(){var e=r.responseText;if(/response/.test(e)){/success\s*=\s*"\s*(1|true)\s*"/.test(e);e.match(/code\s*=\s*"\s*(\S*)\s*"/);RegExp.$1;e.match(/status\s*=\s*"\s*(\d+)\s*"/);var n=parseInt(RegExp.$1);e.match(/battery\s*=\s*"\s*(\d+)\s*"/);var s=parseInt(RegExp.$1);t.fireStatusEvent(i,n,s)}else t.fireStatusEvent(i,i.ASB_NO_RESPONSE,0);t.updateStatus(i)},r.onerror=function(){t.fireStatusEvent(i,i.ASB_NO_RESPONSE),t.updateStatus(i)},r.onprogress=function(){},r.ontimeout=r.onerror,r.send(n)}else{if(!window.XMLHttpRequest)throw new Error("XMLHttpRequest is not supported");var s=new XMLHttpRequest;s.open("POST",e,!0),s.setRequestHeader("Content-Type","text/xml; charset=utf-8"),s.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:00 GMT"),s.setRequestHeader("SOAPAction",'""'),s.onreadystatechange=function(){if(4==s.readyState){if(200==s.status&&s.responseXML){var e=s.responseXML.getElementsByTagName("response");if(e.length>0){/^(1|true)$/.test(e[0].getAttribute("success")),e[0].getAttribute("code");var n=parseInt(e[0].getAttribute("status")),r=e[0].hasAttribute("battery")?parseInt(e[0].getAttribute("battery")):0;t.fireStatusEvent(i,n,r)}else t.fireStatusEvent(i,i.ASB_NO_RESPONSE,0)}else t.fireStatusEvent(i,i.ASB_NO_RESPONSE,0);t.updateStatus(i)}},s.send(n)}},Printer.prototype.stopMonitor=function(){var t=!1;try{this.enabled=!1,this.timeoutid&&(clearTimeout(this.timeoutid),delete this.timeoutid),t=!0}catch(e){throw e}return t},Printer.prototype.fireReceiveEvent=function(t,e,n,i,r,s){delete this.isPrint,"EX_ENPC_TIMEOUT"==e&&(e="ERROR_DEVICE_BUSY"),this.onreceive&&this.onreceive({success:t,code:e,status:n,battery:i,printjobid:r},s)},Printer.prototype.fireErrorEvent=function(t,e,n){this.onerror&&this.onerror({status:t,responseText:e},n),this.ePosDev.cleanup()},Printer.prototype.fireStatusEvent=function(t,e,n){0!=e&&e!=this.ASB_NO_RESPONSE||(e=this.status|this.ASB_NO_RESPONSE);var i=this.status==this.ASB_DRAWER_KICK?-1:this.status^e,r=0==this.status?-1:this.battery^n;this.status=e,this.battery=n,i&&this.onstatuschange&&this.onstatuschange(e),r&&this.onbatterystatuschange&&this.onbatterystatuschange(n),i&(this.ASB_NO_RESPONSE|this.ASB_OFF_LINE)&&(e&this.ASB_NO_RESPONSE?this.onpoweroff&&this.onpoweroff():e&this.ASB_OFF_LINE?this.onoffline&&this.onoffline():this.ononline&&this.ononline()),i&this.ASB_COVER_OPEN&&(e&this.ASB_NO_RESPONSE||(e&this.ASB_COVER_OPEN?this.oncoveropen&&this.oncoveropen():this.oncoverok&&this.oncoverok())),i&(this.ASB_RECEIPT_END|this.ASB_RECEIPT_NEAR_END)&&(e&this.ASB_NO_RESPONSE||(e&this.ASB_RECEIPT_END?this.onpaperend&&this.onpaperend():e&this.ASB_RECEIPT_NEAR_END?this.onpapernearend&&this.onpapernearend():this.onpaperok&&this.onpaperok())),i&this.ASB_DRAWER_KICK&&(e&this.ASB_NO_RESPONSE||(e&this.ASB_DRAWER_KICK?(this.drawerOpenLevel==this.DRAWER_OPEN_LEVEL_HIGH?this.ondraweropen&&this.ondraweropen():this.ondrawerclosed&&this.ondrawerclosed(),this.onbatterylow&&this.onbatterylow()):(this.drawerOpenLevel==this.DRAWER_OPEN_LEVEL_HIGH?this.ondrawerclosed&&this.ondrawerclosed():this.ondraweropen&&this.ondraweropen(),this.onbatteryok&&this.onbatteryok())))},Printer.prototype.updateStatus=function(){var t=this;if(this.enabled){var e=this.interval;(isNaN(e)||e<1e3)&&(e=3e3),this.timeoutid=setTimeout(function(){delete t.timeoutid,t.enabled&&t.sendStartMonitorCommand()},e)}},Printer.prototype.print=function(t,e,n,i){try{CanvasPrint.prototype.print.apply(this,arguments)}catch(r){throw r}},Printer.prototype.reset=function(){try{CanvasPrint.prototype.reset.apply(this,arguments)}catch(t){throw t}},Printer.prototype.recover=function(){try{CanvasPrint.prototype.recover.apply(this,arguments)}catch(t){throw t}},HybridPrinter.prototype={init:function(t){var e=this;e.deviceID=t,e.ReceiptPrinter=new ReceiptPrinter(this),e.SlipPrinter=new SlipPrinter(this),e.EndorsePrinter=new EndorsePrinter(this),e.MICRReader=new MICRReader(this),e.ReceiptPrinter.onstatuschange=function(t){null!=e.onstatuschange&&e.onstatuschange(t)},e.ReceiptPrinter.ononline=function(){null!=e.ononline&&e.ononline()},e.ReceiptPrinter.onoffline=function(){null!=e.onoffline&&e.onoffline()},e.ReceiptPrinter.onpoweroff=function(){null!=e.onpoweroff&&e.onpoweroff()},e.ReceiptPrinter.oncoveropen=function(){null!=e.oncoveropen&&e.oncoveropen()},e.ReceiptPrinter.onpaperok=function(){null!=e.onpaperok&&e.onpaperok()},e.ReceiptPrinter.onpapernearend=function(){null!=e.onpapernearend&&e.onpapernearend()},e.ReceiptPrinter.onpaperend=function(){null!=e.onpaperend&&e.onpaperend()},e.ReceiptPrinter.ondrawerclosed=function(){null!=e.ondrawerclosed&&e.ondrawerclosed()},e.ReceiptPrinter.ondraweropen=function(){null!=e.ondraweropen&&e.ondraweropen()}},setConnectionObject:function(t){this.connectionObj=t,this.ReceiptPrinter.setConnectionObject(this.connectionObj)},lock:function(){return this.send({type:"lock"})},unlock:function(){return this.send({type:"unlock"})},eject:function(){return this.send({type:"eject"})},recover:function(){return this.ReceiptPrinter.recover()},reset:function(){this.ReceiptPrinter.force=this.force;var t=this.ReceiptPrinter.reset();return this.force=!1,t},startMonitor:function(){return this.ReceiptPrinter.startMonitor()},stopMonitor:function(){return this.ReceiptPrinter.stopMonitor()},client_onreceive:function(t,e){switch(t.eventtype){case"slipprint":case"slipcancel":this.SlipPrinter.fireOnReceive(t,e);break;case"endorseprint":case"endorsecancel":this.EndorsePrinter.fireOnReceive(t,e);break;case"micrread":case"micrcleaning":case"micrcancel":this.MICRReader.fireOnReceive(t,e);break;case"print":var n=t;n.eventtype=this.ReceiptPrinter.methodName,this.fireOnReceive(n,e);break;default:this.fireOnReceive(t,e)}},client_onxmlresult:function(t,e){this.ReceiptPrinter.fireOnReceive(t,e)},fireOnReceive:function(t,e){null!=this.onreceive&&null!=t&&this.onreceive({eventtype:t.eventtype,success:t.success,code:t.code,status:t.status},e)},callEvent:function(t,e){var n=e;return n.type=t,this.send(n)},send:function(t){var e=MessageFactory.getDeviceDataMessage(this.deviceID,t,this.isCrypto),n=-1;try{this.connectionObj.emit(e),n=e.sequence}catch(i){}return n}},ReceiptPrinter.prototype.setConnectionObject=function(t){this.connectionObj=t},ReceiptPrinter.prototype=new Printer,ReceiptPrinter.prototype.send=function(){return""==this.methodName&&(this.methodName="send"),Printer.prototype.send.apply(this,arguments)},ReceiptPrinter.prototype.print=function(t,e,n){return this.methodName="print",Printer.prototype.print.apply(this,arguments)},ReceiptPrinter.prototype.recover=function(){return this.methodName="recover",Printer.prototype.recover.apply(this,arguments)},ReceiptPrinter.prototype.reset=function(){return this.methodName="reset",Printer.prototype.reset.apply(this,arguments)},ReceiptPrinter.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive){var n=this.methodName,i="false",r="",s=this.ASB_NO_RESPONSE;if(t){var o=t.resultdata;i=/success\s*=\s*"\s*(1|true)\s*"/.test(o),o.match(/code\s*=\s*"\s*(\S*)\s*"/),""==(r=RegExp.$1)&&(r=i?"SUCCESS":"ERROR_DEVICE_NOT_FOUND"),o.match(/status\s*=\s*"\s*(\d+)\s*"/),s=parseInt(RegExp.$1)}"EX_ENPC_TIMEOUT"==r&&(r="ERROR_DEVICE_BUSY"),this.onreceive({eventtype:n,success:i,code:r,status:s},e),this.methodName=""}},SlipPrinter.prototype=new ePOSBuilder,SlipPrinter.prototype.timeout=6e4,SlipPrinter.prototype.send=function(){var t=arguments.length<1?this.toString():arguments[1],e={type:"slipprint",timeout:this.timeout,printdata:t},n=this.parent.send(e);return this.setXmlString(""),n},SlipPrinter.prototype.setXmlString=function(t){this.message=t},SlipPrinter.prototype.getXmlString=function(){return this.message},SlipPrinter.prototype.cancel=function(){return this.parent.send({type:"slipcancel"})},SlipPrinter.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive&&null!=t){var n="";switch(t.eventtype){case"slipprint":n="send";break;case"slipcancel":n="cancel"}var i=t.code;"EX_ENPC_TIMEOUT"==i&&(i="ERROR_DEVICE_BUSY"),this.onreceive({eventtype:n,success:t.success,code:i,status:t.status},e)}},EndorsePrinter.prototype=new ePOSBuilder,EndorsePrinter.prototype.timeout=6e4,EndorsePrinter.prototype.send=function(){var t=arguments.length<1?this.toString():arguments[1],e={type:"endorseprint",is40cplmode:this.mode40cpl,timeout:this.timeout,printdata:t},n=this.parent.send(e);return this.setXmlString(""),n},EndorsePrinter.prototype.setXmlString=function(t){this.message=t},EndorsePrinter.prototype.getXmlString=function(){return this.message},EndorsePrinter.prototype.cancel=function(){return this.parent.send({type:"endorsecancel"})},EndorsePrinter.prototype.enable40cplmode=function(t){this.mode40cpl=t},EndorsePrinter.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive&&null!=t){var n="";switch(t.eventtype){case"endorseprint":n="send";break;case"endorsecancel":n="cancel"}var i=t.code;"EX_ENPC_TIMEOUT"==i&&(i="ERROR_DEVICE_BUSY"),this.onreceive({eventtype:n,success:t.success,code:i,status:t.status},e)}},MICRReader.prototype.read=function(t,e){var n={type:"micrread",ignoreerror:t,font:e,timeout:this.timeout};return this.parent.send(n)},MICRReader.prototype.cleaning=function(){var t={type:"micrcleaning",timeout:this.timeout};return this.parent.send(t)},MICRReader.prototype.cancel=function(){return this.parent.send({type:"micrcancel"})},MICRReader.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive&&null!=t){var n="";switch(t.eventtype){case"micrread":n="read";break;case"micrcleaning":n="cleaning";break;case"micrcancel":n="cancel"}var i=t.code;"EX_ENPC_TIMEOUT"==i&&(i="ERROR_DEVICE_BUSY"),this.onreceive({eventtype:n,success:t.success,code:i,status:t.status,data:t.data},e)}},HybridPrinter2.prototype.init=function(t){this.deviceID=t,this.ReceiptPrinter=new ReceiptPrinter(this),this.SlipPrinter2=new SlipPrinter2(this),this.ValidationPrinter=new ValidationPrinter(this),this.EndorsePrinter2=new EndorsePrinter2(this),this.MICRReader2=new MICRReader2(this),this.currentPrinter=this.ReceiptPrinter,this.ReceiptPrinter.onstatuschange=function(t){null!=this.parent.onstatuschange&&this.parent.onstatuschange(t)},this.ReceiptPrinter.ononline=function(){null!=this.parent.ononline&&this.parent.ononline()},this.ReceiptPrinter.onoffline=function(){null!=this.parent.onoffline&&this.parent.onoffline()},this.ReceiptPrinter.onpoweroff=function(){null!=this.parent.onpoweroff&&this.parent.onpoweroff()},this.ReceiptPrinter.oncoveropen=function(){null!=this.parent.oncoveropen&&this.parent.oncoveropen()},this.ReceiptPrinter.oncoverok=function(){null!=this.parent.oncoverok&&this.parent.oncoverok()},this.ReceiptPrinter.onpaperok=function(){null!=this.parent.onpaperok&&this.parent.onpaperok()},this.ReceiptPrinter.onpapernearend=function(){null!=this.parent.onpapernearend&&this.parent.onpapernearend()},this.ReceiptPrinter.onpaperend=function(){null!=this.parent.onpaperend&&this.parent.onpaperend()},this.ReceiptPrinter.ondrawerclosed=function(){null!=this.parent.ondrawerclosed&&this.parent.ondrawerclosed()},this.ReceiptPrinter.ondraweropen=function(){this.parent.ondraweropen!=undefined&&this.parent.ondraweropen()},this.ReceiptPrinter.onreceive=function(t,e){this.parent.fireOnReceive(t,e)},this.SlipPrinter2.onreceive=function(t,e){this.parent.fireOnReceive(t,e)},this.EndorsePrinter2.onreceive=function(t,e){this.parent.fireOnReceive(t,e)},this.ValidationPrinter.onreceive=function(t,e){this.parent.fireOnReceive(t,e)},this.MICRReader2.onreceive=function(t,e){this.parent.fireOnReceive(t,e)}},HybridPrinter2.prototype.setConnectionObject=function(t){this.connectionObj=t,this.ReceiptPrinter.setConnectionObject(this.connectionObj)},HybridPrinter2.prototype.isValidFunction=function(t,e){var n=!1,i=0;if(0!=e.length)for(i=0;i<e.length;i++)if(t==e[i]){n=!0;break}return n},HybridPrinter2.prototype.addText=function(t){return this.currentPrinter.addText.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextLang=function(t){return this.currentPrinter.addTextLang.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextAlign=function(t){return this.currentPrinter.addTextAlign.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextRotate=function(t){return this.currentPrinter.addTextRotate.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextLineSpace=function(t){return this.currentPrinter.addTextLineSpace.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextFont=function(t){return this.currentPrinter.addTextFont.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextSmooth=function(t){return this.currentPrinter.addTextSmooth.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextDouble=function(t,e){return this.currentPrinter.addTextDouble.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextSize=function(t,e){return this.currentPrinter.addTextSize.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextStyle=function(t,e,n,i){return this.currentPrinter.addTextStyle.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextPosition=function(t){return this.currentPrinter.addTextPosition.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addTextVPosition=function(t){return this.currentPrinter.addTextVPosition.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addFeedUnit=function(t){return this.currentPrinter.addFeedUnit.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addFeedLine=function(t){return this.currentPrinter.addFeedLine.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addFeed=function(){return this.currentPrinter.addFeed.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addFeedPosition=function(t){return this.currentPrinter.addFeedPosition.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addImage=function(t,e,n,i,r,s,o){return this.currentPrinter.halftone=this.halftone,this.currentPrinter.brightness=this.brightness,this.currentPrinter.addImage.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addLogo=function(t,e){return this.currentPrinter.addLogo.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addBarcode=function(t,e,n,i,r,s){return this.currentPrinter.addBarcode.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addSymbol=function(t,e,n,i,r,s){return this.currentPrinter.addSymbol.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addHLine=function(t,e,n){return this.currentPrinter.addHLine.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addVLineBegin=function(t,e){return this.currentPrinter.addVLineBegin.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addVLineEnd=function(t,e){return this.currentPrinter.addVLineEnd.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPageBegin=function(){return this.currentPrinter.addPageBegin.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPageEnd=function(){return this.currentPrinter.addPageEnd.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPageArea=function(t,e,n,i){return this.currentPrinter.addPageArea.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPageDirection=function(t){return this.currentPrinter.addPageDirection.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPagePosition=function(t,e){return this.currentPrinter.addPagePosition.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPageLine=function(t,e,n,i,r){return this.currentPrinter.addPageLine.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addPageRectangle=function(t,e,n,i,r){return this.currentPrinter.addPageRectangle.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addCut=function(t){return this.ReceiptPrinter.addCut.apply(this.ReceiptPrinter,arguments),this},HybridPrinter2.prototype.addPulse=function(t,e){return this.currentPrinter.addPulse.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addSound=function(t,e,n){return this.currentPrinter.addSound.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.addLayout=function(t,e,n,i,r,s,o){return this.ReceiptPrinter.addLayout.apply(this.ReceiptPrinter,arguments),this},HybridPrinter2.prototype.addRecovery=function(){return this.ReceiptPrinter.addRecovery.apply(this.ReceiptPrinter,arguments),this},HybridPrinter2.prototype.addReset=function(){return this.ReceiptPrinter.addReset.apply(this.ReceiptPrinter,arguments),this},HybridPrinter2.prototype.addCommand=function(t){return this.currentPrinter.addCommand.apply(this.currentPrinter,arguments),this},HybridPrinter2.prototype.recover=function(){return this.ReceiptPrinter.recover.apply(this.ReceiptPrinter,arguments),this},HybridPrinter2.prototype.reset=function(){this.ReceiptPrinter.force=this.force;var t=this.ReceiptPrinter.reset.apply(this.ReceiptPrinter,arguments);return this.force=!1,t},HybridPrinter2.prototype.setMessage=function(t){this.currentPrinter.message=t},HybridPrinter2.prototype.getMessage=function(){return this.currentPrinter.message},HybridPrinter2.prototype.startMonitor=function(){var t=this.interval;return("number"!=typeof this.interval||t<1e3||6e3<t)&&(t=3e3),this.ReceiptPrinter.interval=t,this.ReceiptPrinter.startMonitor()},HybridPrinter2.prototype.stopMonitor=function(){return this.ReceiptPrinter.stopMonitor()},HybridPrinter2.prototype.lock=function(){return this.send({type:"lock"})},HybridPrinter2.prototype.unlock=function(){return this.send({type:"unlock"})},HybridPrinter2.prototype.selectPaperType=function(t){if(1!=this.isValidFunction(t,[this.PAPERTYPE_RECEIPT,this.PAPERTYPE_SLIP,this.PAPERTYPE_ENDORSE,this.PAPERTYPE_VALIDATION]))throw new Error('Property "paperType" is invalid');switch(t){case this.PAPERTYPE_RECEIPT:this.currentPrinter=this.ReceiptPrinter;break;case this.PAPERTYPE_SLIP:this.currentPrinter=this.SlipPrinter2;break;case this.PAPERTYPE_ENDORSE:this.currentPrinter=this.EndorsePrinter2;break;case this.PAPERTYPE_VALIDATION:this.currentPrinter=this.ValidationPrinter;break;default:this.currentPrinter=this.ReceiptPrinter}return this.paperType=t,this},HybridPrinter2.prototype.waitInsertion=function(t){if(1!=this.isValidFunction(this.paperType,[this.PAPERTYPE_SLIP,this.PAPERTYPE_ENDORSE,this.PAPERTYPE_VALIDATION]))throw new Error('Property "paperType" is invalid');this.currentPrinter.waitTime=this.waitTime;var e=this.currentPrinter.waitInsertion.apply(this.currentPrinter,arguments);return e},HybridPrinter2.prototype.cancelInsertion=function(){var t=null;if(this.isMicrMode)t=this.MICRReader2.cancel.apply(this.MICRReader2,arguments);else{if(1!=this.isValidFunction(this.paperType,[this.PAPERTYPE_SLIP,this.PAPERTYPE_ENDORSE,this.PAPERTYPE_VALIDATION]))throw new Error('Property "paperType" is invalid');t=this.currentPrinter.cancel.apply(this.currentPrinter,arguments)}return t},HybridPrinter2.prototype.ejectPaper=function(){return this.send({type:"eject"})},HybridPrinter2.prototype.sendData=function(t){this.currentPrinter.isCrypto=this.isCrypto,this.currentPrinter.timeout="number"!=typeof t||t<1||t>1e6?0:t,this.EndorsePrinter2.enable40cplmode(this.enable40cplMode),this.currentPrinter.force=this.force;var e=this.currentPrinter.send();return this.force=!1,e},HybridPrinter2.prototype.print=function(t,e,n,i){return this.ReceiptPrinter.timeout="number"!=typeof i||i<1||i>1e6?0:i,this.ReceiptPrinter.print.apply(this.ReceiptPrinter,[t,e,n]),this},HybridPrinter2.prototype.readMicrData=function(t,e,n){var i=t,r=e;return void 0===t&&(i=!0),void 0===e&&(r=this.FONT_E13B),this.MICRReader2.timeout=n,this.MICRReader2.waitTime=this.waitTime,this.MICRReader2.read.apply(this.MICRReader2,[i,r]),this.isMicrMode=!0,this},HybridPrinter2.prototype.cleanMicrReader=function(t){return this.MICRReader2.timeout=t,this.MICRReader2.cleaning.apply(this.MICRReader2,[]),this.isMicrMode=!0,this},HybridPrinter2.prototype.client_onreceive=function(t,e){switch(t.eventtype){case"slipprint2":case"slipcancel":case"slipwaitinsertion":this.SlipPrinter2.fireOnReceive(t,e);break;case"endorseprint2":case"endorsecancel":case"endorsewaitinsertion":this.EndorsePrinter2.fireOnReceive(t,e);break;case"validationprint2":case"validationcancel":case"validationwaitinsertion":this.ValidationPrinter.fireOnReceive(t,e);break;case"micrread":case"micrcleaning":case"micrcancel":this.MICRReader2.fireOnReceive(t,e);break;case"print":var n=t;n.eventtype=this.ReceiptPrinter.methodName,this.fireOnReceive(n,e);break;default:this.fireOnReceive(t,e)}},HybridPrinter2.prototype.client_onxmlresult=function(t,e){this.ReceiptPrinter.fireOnReceive(t,e)},HybridPrinter2.prototype.fireOnReceive=function(t,e){if(typeof this.onreceive!=undefined&&null!=t){var n=t.eventtype,i=t.success,r=t.code,s=t.status,o=t.data;switch(t.eventtype){case"send":n="sendData",r==this.SUCCESS&&(this.isMicrMode=!1);break;case"waitinsertion":n="waitInsertion",r==this.SUCCESS&&(this.isMicrMode=!1);break;case"read":n="readMicrData",r==this.SUCCESS&&(this.isMicrMode=!0);break;case"cleaning":n="cleanMicrReader",r==this.SUCCESS&&(this.isMicrMode=!0);break;case"cancel":n="cancelInsertion";break;case"eject":n="ejectPaper",r==this.SUCCESS&&(this.isMicrMode=!1)}switch(r){case"EX_ENPC_TIMEOUT":r="ERROR_DEVICE_BUSY";break;case"CANCEL":this.isMicrMode=!1}this.onreceive({method:n,success:i,code:r,status:s,data:o},e)}},HybridPrinter2.prototype.callEvent=function(t,e){var n=e;return n.type=t,this.send(n)},HybridPrinter2.prototype.send=function(t){var e=MessageFactory.getDeviceDataMessage(this.deviceID,t,this.isCrypto),n=-1;try{this.connectionObj.emit(e),n=e.sequence}catch(i){}return n},SlipPrinter2.prototype=new SlipPrinter,SlipPrinter2.prototype.timeout=6e4,SlipPrinter2.prototype.waitTime=500,SlipPrinter2.prototype.send=function(){var t=null;t=arguments.length<1?this.toString():arguments[1],("number"!=typeof this.timeout||this.timeout<5e3||this.timeout>1e6)&&(this.timeout=1e4);var e={type:"slipprint2",timeout:this.timeout,printdata:t},n=this.parent.send(e);return this.setXmlString(""),n},SlipPrinter2.prototype.setXmlString=function(t){this.message=t},SlipPrinter2.prototype.getXmlString=function(){return this.message},SlipPrinter2.prototype.waitInsertion=function(t){this.timeout="number"!=typeof t||t<5e3||t>9e5?6e4:t;var e=this.waitTime;("number"!=typeof this.waitTime||this.waitTime<0||this.waitTime>6400)&&(e=500);var n={type:"slipwaitinsertion",timeout:this.timeout,waittime:e};return this.parent.send(n)},SlipPrinter2.prototype.cancel=function(){return this.parent.send({type:"slipcancel"})},SlipPrinter2.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive&&null!=t){var n="";switch(t.eventtype){case"slipprint2":n="send";break;case"slipcancel":n="cancel";break;case"slipwaitinsertion":n="waitinsertion"}this.onreceive({eventtype:n,success:t.success,code:t.code,status:t.status},e)}},EndorsePrinter2.prototype=new EndorsePrinter,EndorsePrinter2.prototype.timeout=6e4,EndorsePrinter2.prototype.waitTime=500,EndorsePrinter2.prototype.send=function(){var t=null;t=arguments.length<1?this.toString():arguments[1],("number"!=typeof this.timeout||this.timeout<6e4||this.timeout>9e5)&&(this.timeout=6e4);var e={type:"endorseprint2",is40cplmode:this.mode40cpl,timeout:this.timeout,printdata:t},n=this.parent.send(e);return this.setXmlString(""),n},EndorsePrinter2.prototype.setXmlString=function(t){this.message=t},EndorsePrinter2.prototype.getXmlString=function(){return this.message},EndorsePrinter2.prototype.waitInsertion=function(t){this.timeout="number"!=typeof t||t<5e3||t>9e5?6e4:t;var e=this.waitTime;("number"!=typeof this.waitTime||this.waitTime<0||this.waitTime>6400)&&(e=500);var n={type:"endorsewaitinsertion",timeout:this.timeout,waittime:e};return this.parent.send(n)},EndorsePrinter2.prototype.cancel=function(){return this.parent.send({type:"endorsecancel"})},EndorsePrinter2.prototype.enable40cplmode=function(t){this.mode40cpl=t},EndorsePrinter2.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive&&null!=t){var n="";switch(t.eventtype){case"endorseprint2":n="send";break;case"endorsecancel":n="cancel";break;case"endorsewaitinsertion":n="waitinsertion"}this.onreceive({eventtype:n,success:t.success,code:t.code,status:t.status},e)}},MICRReader2.prototype=new MICRReader,MICRReader2.prototype.waitTime=500,MICRReader2.prototype.read=function(t,e){("number"!=typeof this.timeout||this.timeout<5e3||this.timeout>9e5)&&(this.timeout=6e4);var n=this.waitTime;("number"!=typeof this.waitTime||this.waitTime<0||this.waitTime>6400)&&(n=500);var i={type:"micrread",ignoreerror:t,font:e,timeout:this.timeout,waittime:n};return this.parent.send(i)},MICRReader2.prototype.cleaning=function(){var t=this.waitTime;this.timeout=6e4,("number"!=typeof this.waitTime||this.waitTime<0||this.waitTime>6400)&&(t=500);var e={type:"micrcleaning",timeout:this.timeout,waittime:t};return this.parent.send(e)},ValidationPrinter.prototype=new ePOSBuilder,ValidationPrinter.prototype.timeout=1e4,ValidationPrinter.prototype.waitTime=500,ValidationPrinter.prototype.send=function(){var t=null;t=arguments.length<1?this.toString():arguments[1],("number"!=typeof this.timeout||this.timeout<5e3||this.timeout>1e6)&&(this.timeout=1e4);var e={type:"validationprint2",timeout:this.timeout,printdata:t},n=this.parent.send(e);return this.setXmlString(""),n},ValidationPrinter.prototype.setXmlString=function(t){this.message=t},ValidationPrinter.prototype.getXmlString=function(){return this.message},ValidationPrinter.prototype.waitInsertion=function(t){this.timeout="number"!=typeof t||t<5e3||t>9e5?6e4:t;var e=this.waitTime;("number"!=typeof this.waitTime||this.waitTime<0||this.waitTime>6400)&&(e=500);var n={type:"validationwaitinsertion",timeout:this.timeout,waittime:e};return this.parent.send(n)},ValidationPrinter.prototype.cancel=function(){return this.parent.send({type:"validationcancel"})},ValidationPrinter.prototype.fireOnReceive=function(t,e){if(null!=this.onreceive&&null!=t){var n="";switch(t.eventtype){case"validationprint2":n="send";break;case"validationcancel":n="cancel";break;case"validationwaitinsertion":n="waitinsertion"}this.onreceive({eventtype:n,success:t.success,code:t.code,status:t.status},e)}},Scanner.prototype={setConnectionObject:function(t){this.connectionObj=t},client_ondata:function(t){try{if(null==this.ondata)return;this.ondata(t)}catch(e){}},client_onbinarydata:function(t){try{if(null==this.onbinarydata)return;this.onbinarydata(t)}catch(e){}},client_setbinarymode:function(t){try{if(null==this.onbinarymode)return;this.onbinarymode(t)}catch(e){}},setBinaryMode:function(t){var e={type:"setbinarymode",binarymode:1==t?"true":"false"},n=MessageFactory.getDeviceDataMessage(this.deviceID,e,this.isCrypto),i=-1;try{this.connectionObj.emit(n),i=n.sequence}catch(r){}return i},callEvent:function(t,e){var n=e;n.type=t;var i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto),r=-1;try{this.connectionObj.emit(i),r=i.sequence}catch(s){}return r}},SimpleSerial.prototype={setConnectionObject:function(t){this.connectionObj=t},sendCommand:function(t){var e={type:"sendcommand",command:toHexBinary(t)},n=MessageFactory.getDeviceDataMessage(this.deviceID,e,this.isCrypto),i=-1;try{this.connectionObj.emit(n),i=n.sequence}catch(r){}return i},client_oncommandreply:function(t){try{if(null==this.oncommandreply)return;var e=t.data;e=e.replace(/[0-9a-fA-F]{2}/g,function(t){var e=parseInt(t,16);return String.fromCharCode(e)}),t.data=e,this.oncommandreply(t)}catch(n){}}},GermanyFiscalElement.prototype={setConnectionObject:function(t){this.connectionObj=t},operate:function(t,e){var n={type:"operate",timeout:e,requestdata:t},i=MessageFactory.getDeviceDataMessage(this.deviceID,n,this.isCrypto),r=-1;try{this.connectionObj.emit(i),r=i.sequence}catch(s){throw s}return r},client_operateresult:function(t){if(null!=this.ongfereceive){if("Base64-encoded"==t.resultformat)try{t.resultdata=window.atob(t.resultdata);for(var e=new Uint8Array(t.resultdata.length),n=0;n<t.resultdata.length;n++)e[n]=t.resultdata.charCodeAt(n);var i=new Zlib.Inflate(e).decompress();t.resultdata=[];for(var r=0;r<i.length;r++)t.resultdata=t.resultdata+String.fromCharCode(i[r])}catch(s){return void(this.onerror&&this.onerror(s))}try{this.ongfereceive(this.getResultObject(t))}catch(s){this.onerror&&this.onerror(s)}}},getResultObject:function(t){return{success:t.success,code:t.code,resultdata:t.resultdata}},callEvent:function(t,e){var n=MessageFactory.getDeviceDataMessage(this.deviceID,e,this.isCrypto),i=-1;try{this.connectionObj.emit(n),i=n.sequence}catch(r){}return i}},Ofsc.prototype={setConnectionObject:function(t){this.connectionObj=t},send:function(t,e,n,i){this.callback=i;try{if(this.connectionObj.isUsableDeviceIF()){var r={type:"print",timeout:e,printdata:t},s=MessageFactory.getServiceMessage(this.SERVICE_ID,n,r);this.connectionObj.emit(s)}}catch(o){return}},notify:function(t){var e=null;e="1"==t.isCrypto?MessageFactory.decrypt(t.data):t.data,null!=this.callback&&this.callback(e.resultdata)},onxmlresult:function(t){null!=this.callback&&this.callback(t)}},CookieIO.prototype={writeId:function(t){var e=location.pathname;"/"==e.slice(-1)&&(e+="index.html");var n=location.hostname,i=this.getExpiredDate();document.cookie=this.KEY+"_"+n+e+"="+escape(t)+"; expires="+i},readId:function(){var t="",e=document.cookie+";",n=location.pathname;"/"==n.slice(-1)&&(n+="index.html");var i=location.hostname,r=this.KEY+"_"+i+n+"=",s=e.indexOf(r);if(-1!=s){s+=r.length;var o=e.indexOf(";",s);t=unescape(e.substring(s,o))}return t},getExpiredDate:function(){var t=new Date,e=t.getTime();return t.setTime(e+6e4*this.EXPIRE_MINUTES),t.toUTCString()}},DeviceObjElementMap.prototype={add:function(t){this.elementList.push(t)},get:function(t){for(var e=null,n=0;n<this.elementList.length;n++)if(this.elementList[n].deviceId==t){e=this.elementList[n];break}return e},getByObj:function(t){for(var e=null,n=0;n<this.elementList.length;n++)if(this.elementList[n].deviceObject==t){e=this.elementList[n];break}return e},remove:function(t){for(var e=0;e<this.elementList.length;e++)if(this.elementList[e].deviceId==t){this.elementList.splice(e,1);break}},removeAll:function(){this.elementList=[]},getElementList:function(){return this.elementList}},ePOSDevice.prototype={connect:function(t,e,n,i){this.conectionObj.status(this.conectionObj.IF_EPOSDEVICE)==this.conectionObj.DISCONNECT&&this.conectionObj.status(this.conectionObj.IF_EPOSPRINT)==this.conectionObj.DISCONNECT||this.disconnect(),this.connectStartTime=(new Date).getTime();var r=e==this.IFPORT_EPOSDEVICE?"http":"https";this.conectionObj.setAddress(r,t,e),this.conectionObj.registCallback(n),arguments.length>=4?this.eposprint=i.eposprint:this.eposprint=!1;var s=this;if(this.eposprint){var o=this.conectionObj;this.conectionObj.probeWebServiceIF(function(t){var e=s.ERROR_PARAMETER;o.isUsablePrintIF()&&(e=s.RESULT_OK),n(e)})}else this.connectBySocketIo(this.CONNECT_TIMEOUT,r)},isConnected:function(){var t=!1,e=!1;switch(this.conectionObj.status(this.conectionObj.IF_EPOSDEVICE)){case this.conectionObj.CONNECT:case this.conectionObj.RECONNECTING:t=!0;break;case this.conectionObj.DISCONNECT:}return this.conectionObj.status(this.conectionObj.IF_EPOSPRINT)==this.conectionObj.CONNECT&&(e=!0),t|e},disconnect:function(){var t=MessageFactory.getDisconnectMessage(this.connectionId);this.conectionObj.emit(t),this.cleanup()},createDevice:function(t,e,n,i){try{if(!this.isConnected())throw new Error(this.ERROR_SYSTEM);if(null!=this.devObjElmMap.get(t))throw new Error(this.ERROR_DEVICE_IN_USE);if(!this.devObjSelector.isSelectable(e))throw new Error(this.ERROR_DEVICE_NOT_FOUND);var r=!1,s=!1;"boolean"==typeof n?r=n:("boolean"==typeof n.crypto&&(r=n.crypto),"boolean"==typeof n.buffer&&(s=n.buffer)),e==this.DEVICE_TYPE_DT&&(r=!0,t="local_dt");var o=this.devObjSelector.select(t,e,n.driver,r,this);o.setConnectionObject(this.conectionObj);var a=new DeviceObjElement(t,r,o,i);if(this.devObjElmMap.add(a),this.conectionObj.isUsableDeviceIF()){var c=MessageFactory.getOpenDeviceMessage(t,e,r,s);this.conectionObj.emit(c)}else{var h=this;this.checkEposPrintService(t,e,function(t){t==h.RESULT_OK?i(o,h.RESULT_OK):i(null,h.ERROR_DEVICE_NOT_FOUND)})}}catch(p){var u=p.message;null!=u&&""!=u||(u=this.ERROR_DEVICE_OPEN),null!=i&&i(null,u)}},deleteDevice:function(t,e){try{var n=this.devObjElmMap.getByObj(t);if(null==n)throw new Error(this.ERROR_DEVICE_NOT_OPEN);if(this.conectionObj.isUsableDeviceIF()){n.callback=e;var i=MessageFactory.getCloseDeviceMessage(n.deviceId);this.conectionObj.emit(i)}else{try{t.finalize()}catch(s){}this.devObjElmMap.remove(n.deviceId),e(this.RESULT_OK)}}catch(s){var r=s.message;null!=r&&""!=r||(r=this.ERROR_DEVICE_CLOSE),null!=e&&e(r)}},getAdmin:function(){return this.admin},getLocation:function(){return this.location},sendOfscXml:function(t,e,n,i){this.ofsc.send(t,e,n,i)},getCommBoxManager:function(){return this.conectionObj.status(this.conectionObj.IF_EPOSDEVICE)!=this.conectionObj.CONNECT?null:this.commBoxManager},cleanup:function(){0!=this.waitRetryConnectId&&(clearTimeout(this.waitRetryConnectId),this.waitRetryConnectId=0),this.connectStartTime=0,this.gbox.stock(this.socket),this.gbox.dispose();var t=this.devObjElmMap.getElementList();t.forEach(function(t){try{t.deviceObject.finalize()}catch(e){}}),t=null,this.devObjElmMap.removeAll(),null==this.ondisconnect||this.conectionObj.status(this.conectionObj.IF_EPOSDEVICE)==this.conectionObj.DISCONNECT&&this.conectionObj.status(this.conectionObj.IF_EPOSPRINT)==this.conectionObj.DISCONNECT||this.ondisconnect(),this.cookieIo.writeId(""),this.conectionObj.changeStatus(this.conectionObj.IF_ALL,this.conectionObj.DISCONNECT),this.socket=null,this.conectionObj.setSocket(null),this.connectionId=null,this.conectionObj.setAddress("","",""),null!=this.reconnectTimerId&&clearInterval(this.reconnectTimerId),this.reconnectTimerId=null,this.reconnectTryCount=0,this.admin="",this.location="",this.recievedDataId=0,this.eposprint=!1},connectBySocketIo:function(t){var e=this.conectionObj,n=e.getSocketIoURL();this.socket=io.connect(n,{reconnect:!1,"connect timeout":t,"force new connection":!0}),this.conectionObj.setSocket(this.socket);var i=this;this.socket.on("connect",function(t){try{i.gbox.dispose()}catch(e){}}),this.socket.on("close",function(){e.changeStatus(e.IF_EPOSDEVICE,tselfofProb.DISCONNECT)}),this.socket.on("disconnect",function(t){try{if(e.status(e.IF_EPOSDEVICE)==e.RECONNECTING)return;""==i.cookieIo.readId()&&null==i.connectionId?i.cleanup():i.startReconnectAction()}catch(n){}}),this.socket.on("error",function(){try{e.probeWebServiceIF(function(t){e.isUsablePrintIF()?(i.eposprint=!0,e.registIFAccessResult(e.IF_EPOSDEVICE,e.ACCESS_NONE)):(e.changeStatus(e.IF_EPOSDEVICE,e.DISCONNECT),e.registIFAccessResult(e.IF_EPOSDEVICE,e.ACCESS_TIMEOUT))})}catch(t){}}),this.socket.on("connect_failed",function(){try{e.probeWebServiceIF(function(t){e.isUsablePrintIF()?(i.eposprint=!0,e.registIFAccessResult(e.IF_EPOSDEVICE,e.ACCESS_NONE)):(e.changeStatus(e.IF_EPOSDEVICE,e.DISCONNECT),e.registIFAccessResult(e.IF_EPOSDEVICE,e.ACCESS_TIMEOUT))})}catch(t){}}),this.socket.on("message",function(t){try{var e=MessageFactory.parseRequestMessage(t);switch(""!=e.data_id&&(i.recievedDataId=e.data_id),e.request){case e.REQUEST.CONNECT:i.procConnect(e);break;case e.REQUEST.PUBKEY:i.procPubkey(e);break;case e.REQUEST.ADMININFO:i.procAdminInfo(e);break;case e.REQUEST.RECONNECT:i.procReconnect(e);break;case e.REQUEST.DISCONNECT:i.procDisconnect(e);break;case e.REQUEST.OPENDEVICE:i.procOpenDevice(e);break;case e.REQUEST.CLOSEDEVICE:i.procCloseDevice(e);break;case e.REQUEST.DEVICEDATA:i.procDeviceData(e);break;case e.REQUEST.SERVICEDATA:i.procServiceData(e);break;case e.REQUEST.OPENCOMMBOX:i.procOpenCommBox(e);break;case e.REQUEST.CLOSECOMMBOX:i.procCloseCommBox(e);break;case e.REQUEST.COMMDATA:i.procCommBoxData(e);break;case e.REQUEST.ERROR:i.procError(e);break;default:return}}catch(n){}})},procConnect:function(t){try{null!=this.reconnectTimerId&&(clearInterval(this.reconnectTimerId),this.reconnectTimerId=null);var e=null,n=this.cookieIo.readId();t.data.protocol_version<2?(e=MessageFactory.getPubkeyMessage(t.data.prime,t.data.key),this.conectionObj.emit(e)):null!=this.connectionId?(e=MessageFactory.getReconnectMessage(this.connectionId,t.data.client_id,this.recievedDataId),this.conectionObj.emit(e)):""!=n?(e=MessageFactory.getDisconnectMessage(n),this.conectionObj.emit(e),e=MessageFactory.getPubkeyMessage(t.data.prime,t.data.key),this.conectionObj.emit(e)):(e=MessageFactory.getPubkeyMessage(t.data.prime,t.data.key),this.conectionObj.emit(e)),this.cookieIo.writeId(t.data.client_id),this.connectionId=t.data.client_id}catch(i){this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_ERROR),this.cleanup()}},procPubkey:function(t){try{if("SHARED_KEY_MISMATCH_ERROR"==t.code){var e=(new Date).getTime(),n=0;if(0!=this.connectStartTime)if((n=e-this.connectStartTime)<this.CONNECT_TIMEOUT){var i=this;this.gbox.stock(this.socket),this.connectionId=null,this.waitRetryConnectId=setTimeout(function(){i.connectBySocketIo(i.CONNECT_TIMEOUT-n)},100)}else this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_TIMEOUT),this.cleanup();else this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_TIMEOUT),this.cleanup()}else if("PARAM_ERROR"==t.code)this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_ERROR),this.cleanup();else{var r=MessageFactory.getAdminInfoMessage();this.conectionObj.emit(r)}}catch(s){this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_ERROR),this.cleanup()}},procAdminInfo:function(t){this.eposprint||(t.code==this.RESULT_OK?(this.admin=t.data.admin_name,this.location=t.data.location,this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_OK)):this.conectionObj.registIFAccessResult(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.ACCESS_ERROR))},procReconnect:function(t){this.conectionObj.status(this.conectionObj.IF_EPOSDEVICE)==this.conectionObj.RECONNECTING&&(t.code==this.RESULT_OK?(this.conectionObj.changeStatus(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.CONNECT),null!=this.onreconnect&&this.onreconnect()):this.cleanup())},procDisconnect:function(t){},procOpenDevice:function(t){var e=t.deviceId;try{var n=this.devObjElmMap.get(e);t.code==this.RESULT_OK?null!=n.callback&&n.callback(n.deviceObject,t.code):(null!=n.callback&&n.callback(null,t.code),this.devObjElmMap.remove(e))}catch(i){null!=this.onerror&&this.onerror("0",e,this.ERROR_SYSTEM,null)}},procCloseDevice:function(t){var e=t.deviceId;try{if(t.code==this.RESULT_OK){var n=this.devObjElmMap.get(e);null!=n.callback&&n.callback(t.code);try{n.deviceObject.finalize()}catch(i){}this.devObjElmMap.remove(e)}}catch(i){null!=this.onerror&&this.onerror("0",e,this.ERROR_SYSTEM,null)}},procDeviceData:function(eposmsg){var deviceId=eposmsg.deviceId,sequence=eposmsg.sequence,data=eposmsg.data;try{var devObjElm=this.devObjElmMap.get(deviceId);devObjElm.isCrypto&&(data=MessageFactory.decrypt(data));var deviceObject=devObjElm.deviceObject,method="client_"+data.type;try{deviceObject instanceof OtherPeripheral?deviceObject.client_onreceive(data,sequence):eval("deviceObject."+method+"(data, sequence)")}catch(e){eval("deviceObject."+data.type+"(data, sequence)")}}catch(e){null!=this.onerror&&this.onerror(sequence,deviceId,this.ERROR_SYSTEM,null)}},procServiceData:function(t){try{switch(t.serviceId){case"OFSC":this.ofsc.notify(t)}}catch(e){null!=this.onerror&&this.onerror(t.sequence,t.serviceId,this.ERROR_SYSTEM,null)}},procOpenCommBox:function(t){var e=t.sequence;try{this.commBoxManager.client_opencommbox(t.data,e)}catch(n){null!=this.onerror&&this.onerror(e,"",this.ERROR_SYSTEM,null)}},procCloseCommBox:function(t){var e=t.sequence;try{this.commBoxManager.client_closecommbox(t.data,e)}catch(n){null!=this.onerror&&this.onerror(e,"",this.ERROR_SYSTEM,null)}},procCommBoxData:function(t){var e=t.sequence;try{this.commBoxManager.executeCommDataCallback(t.data,e)}catch(n){null!=this.onerror&&this.onerror(e,"",this.ERROR_SYSTEM,null)}},procError:function(t){try{null!=this.onerror&&this.onerror(t.sequence,t.deviceId,t.code,t.data)}catch(e){}},startReconnectAction:function(){if(this.conectionObj.status(this.conectionObj.IF_EPOSDEVICE)!=this.conectionObj.RECONNECTING){this.conectionObj.changeStatus(this.conectionObj.IF_EPOSDEVICE,this.conectionObj.RECONNECTING),this.reconnectTryCount=0;var t=this;this.reconnectTimerId=setInterval(function(){if(null!=t.socket&&t.gbox.stock(t.socket),t.reconnectTryCount==t.MAX_RECONNECT_RETRY)return clearInterval(t.reconnectTimerId),void t.cleanup();t.conectionObj.status(t.conectionObj.IF_EPOSDEVICE)==t.conectionObj.RECONNECTING&&t.connectBySocketIo(t.RECONNECT_TIMEOUT),t.reconnectTryCount++},t.RECONNECT_TIMEOUT),0==this.reconnectTryCount&&null!=this.onreconnecting&&this.onreconnecting()}},checkEposPrintService:function(t,e,n){var i,r,s="ERROR_TIMEOUT",o="ERROR_PARAMETER",a=null,c=this.conectionObj.getAddressWithProtocol()+"/cgi-bin/epos/service.cgi?devid="+t+"&timeout=10000",h=this.conectionObj.getAddressWithProtocol()+"/cgi-bin/eposDisp/service.cgi?devid="+t+"&timeout=10000",u=null,p=null;if(e==this.DEVICE_TYPE_DISPLAY?(a=h,u='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><epos-display xmlns="http://www.epson-pos.com/schemas/2012/09/epos-display"></epos-display></s:Body></s:Envelope>'):(a=c,u='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><epos-print xmlns="http://www.epson-pos.com/schemas/2011/03/epos-print"></epos-print></s:Body></s:Envelope>'),window.XDomainRequest)try{(p=new XDomainRequest).open("POST",a),p.onload=function(){/response/.test(p.responseText)?(r=/success\s*=\s*"\s*(1|true)\s*"/.test(p.responseText),n(r?"OK":o)):n(o)},p.onerror=function(){n(o)},p.ontimeout=function(){n(s)},p.onprogress=function(){},p.send(u)}catch(l){n(o)}else try{(p=new XMLHttpRequest).open("POST",a,!0),p.setRequestHeader("Content-Type","text/xml; charset=utf-8"),p.setRequestHeader("If-Modified-Since","Thu, 01 Jun 1970 00:00:00 GMT"),p.setRequestHeader("SOAPAction",'""'),p.onreadystatechange=function(){if(4==p.readyState)if(clearTimeout(i),200==p.status&&p.responseXML){var t=p.responseXML.getElementsByTagName("response");r=!(t.length<=0)&&/^(1|true)$/.test(t[0].getAttribute("success")),n(r?"OK":o)}else n(o)},i=setTimeout(function(){p.abort(),n(s)},5e3),p.timeout=1e4,p.send(u)}catch(l){n(o)}}},SocketGarbageBox.prototype={stock:function(t){if(null!=t){t.removeAllListeners("connect"),t.removeAllListeners("close"),t.removeAllListeners("disconnect"),t.removeAllListeners("error"),t.removeAllListeners("connect_failed"),t.removeAllListeners("message");var e=function(){};e.prototype=t,this.box.push(e)}},dispose:function(){for(;0<this.box.length;){var t=this.box.pop();try{t.disconnect(),delete t}catch(e){}}}},Connection.prototype.probe=function(t,e,n){var i,r=this,s=null;if(window.XDomainRequest)try{(s=new XDomainRequest).open("POST",t),s.onload=function(){n(r.OK)},s.onerror=function(){n(r.ERROR_PARAMETER)},s.ontimeout=function(){n(r.ERROR_TIMEOUT)},s.onprogress=function(){},s.send(e)}catch(o){n(this.ERROR_PARAMETER)}else try{(s=new XMLHttpRequest).open("POST",t,!0),s.setRequestHeader("Content-Type","text/xml; charset=utf-8"),s.setRequestHeader("If-Modified-Since","Thu, 01 Jun 1970 00:00:00 GMT"),s.setRequestHeader("SOAPAction",'""'),s.onreadystatechange=function(){4==s.readyState&&(clearTimeout(i),200==s.status?n(r.OK):n(r.ERROR_PARAMETER))},i=setTimeout(function(){s.abort(),n(r.ERROR_TIMEOUT)},5e3),s.timeout=1e4,s.send(e)}catch(o){n(this.ERROR_PARAMETER)}},Connection.prototype.probeWebServiceIF=function(t){var e=(new Date).getTime(),n=!1,i=this,r=this.getAddressWithProtocol()+"/cgi-bin/epos/service.cgi?devid=local_printer&timeout=10000";this.probe(r,'<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><epos-print xmlns="http://www.epson-pos.com/schemas/2011/03/epos-print"></epos-print></s:Body></s:Envelope>',function(r){var s=i.ACCESS_ERROR;r==i.OK&&(s=i.ACCESS_OK),i.registIFAccessResult(i.IF_EPOSPRINT,s),n&&t((new Date).getTime()-e),n=!n});var s=this.getAddressWithProtocol()+"/cgi-bin/eposDisp/service.cgi?devid=local_display&timeout=10000";this.probe(s,'<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><epos-display xmlns="http://www.epson-pos.com/schemas/2012/09/epos-display"></epos-display></s:Body></s:Envelope>',function(r){var s=i.ACCESS_ERROR;r==i.OK&&(s=i.ACCESS_OK),i.registIFAccessResult(i.IF_EPOSDISPLAY,s),n&&t((new Date).getTime()-e),n=!n})},Connection.prototype.setSocket=function(t){this.socket_p=t},Connection.prototype.emit=function(t){try{if(null==this.socket_p)return;this.socket_p.emit("message",t.toTransmissionForm())}catch(e){throw new Error(this.ERROR_SYSTEM)}},Connection.prototype.setAddress=function(t,e,n){this.protocol_p=t,this.address_p=e,this.port_p=n,this.usableIF_p=0},Connection.prototype.getAddressWithProtocol=function(){return this.protocol_p+"://"+this.address_p},Connection.prototype.getSocketIoURL=function(){return this.getAddressWithProtocol()+":"+this.port_p},Connection.prototype.registCallback=function(t){"function"==typeof t&&(this.callback_p=t)},Connection.prototype.changeStatus=function(t,e){switch(t){case this.IF_ALL:this.dev_status_p=e,this.ws_status_p=e;break;case this.IF_EPOSDEVICE:this.dev_status_p=e;break;default:this.ws_status_p=e}},Connection.prototype.status=function(t){return t==this.IF_EPOSDEVICE?this.dev_status_p:this.ws_status_p},Connection.prototype.isUsableDeviceIF=function(){return(this.usableIF_p&this.IF_EPOSDEVICE)==this.IF_EPOSDEVICE},Connection.prototype.isUsablePrintIF=function(){return!!this.isUsableDeviceIF()||(this.usableIF_p&this.IF_EPOSPRINT)==this.IF_EPOSPRINT},Connection.prototype.isUsableDisplayIF=function(){return!!this.isUsableDeviceIF()||(this.usableIF_p&this.IF_EPOSDISPLAY)==this.IF_EPOSDISPLAY},Connection.prototype.registIFAccessResult=function(t,e){if(e==this.ACCESS_OK&&(this.changeStatus(t,this.CONNECT),this.usableIF_p|=t),t==this.IF_EPOSDEVICE){var n=this.ERROR_PARAMETER;if(this.usableIF_p&this.IF_ALL&&(n="http"==this.protocol_p?this.OK:this.SSL_CONNECT_OK),e==this.ACCESS_TIMEOUT&&(n=this.ERROR_TIMEOUT),null!=this.callback_p){try{this.callback_p(n)}catch(i){}this.callback_p=null}}},ePosCrypto.prototype={genClientKeys:function(t,e){var n=str2bigInt("2",10),i=str2bigInt(t,16),r=randBigInt(64,0);this.pubkey_c=powMod(n,r,i);for(var s=bigInt2str(powMod(str2bigInt(e,16),r,i),16).toLowerCase();s.length<192;)s="0"+s;this.secretKey=md5.bin(s)},bfEncrypt:function(t){try{var e={data:t,key:this.secretKey,mode:"cbc",round:16,iv:blowfish.mkIV()},n=blowfish.encrypt(e),i=base64.encode(n)}catch(r){return""}return i},bfDecrypt:function(t){try{var e={data:base64.decode(t),key:this.secretKey,mode:"cbc"},n=blowfish.decrypt(e)}catch(i){return""}return n}},ePosDeviceMessage.prototype={toTransmissionForm:function(){var t=null;switch(this.request){case this.REQUEST.PUBKEY:case this.REQUEST.ADMININFO:case this.REQUEST.RECONNECT:case this.REQUEST.DISCONNECT:t=[this.request,this.data];break;case this.REQUEST.OPENDEVICE:case this.REQUEST.CLOSEDEVICE:t=[this.request,this.deviceId,this.data,this.data_id];break;case this.REQUEST.DEVICEDATA:t=[this.request,this.sequence,this.deviceId,this.data,this.data_id];break;case this.REQUEST.SERVICEDATA:t=[this.request,this.sequence,this.serviceId,this.isCrypto,this.data,this.data_id];break;case this.REQUEST.OPENCOMMBOX:case this.REQUEST.CLOSECOMMBOX:case this.REQUEST.COMMDATA:t=[this.request,this.sequence,this.data,this.data_id];break;default:t=null}return t}};var MessageFactory=(sequence=0,cipher=new ePosCrypto,getNextSequence=function(){return sequence++,Number.MAX_VALUE==sequence&&(sequence=1),String(sequence)},{parseRequestMessage:function(t){var e=new ePosDeviceMessage;switch(e.request=t[0],e.request){case e.REQUEST.CONNECT:e.data=t[1];break;case e.REQUEST.PUBKEY:case e.REQUEST.ADMININFO:case e.REQUEST.RECONNECT:case e.REQUEST.DISCONNECT:e.code=t[1],e.data=t[2];break;case e.REQUEST.OPENDEVICE:case e.REQUEST.CLOSEDEVICE:e.deviceId=t[1],e.code=t[2],e.data=t[3],e.data_id=t[4];break;case e.REQUEST.DEVICEDATA:e.sequence=t[1],e.deviceId=t[2],e.data=t[3],e.data_id=t[4];break;case e.REQUEST.SERVICEDATA:e.sequence=t[1],e.serviceId=t[2],e.isCrypto=t[3],e.data=t[4],e.data_id=t[5];break;case e.REQUEST.OPENCOMMBOX:case e.REQUEST.CLOSECOMMBOX:case e.REQUEST.COMMDATA:e.sequence=t[1],e.data=t[2],e.data_id=t[3];break;case e.REQUEST.ERROR:e.sequence=t[1],e.deviceId=t[2],e.code=t[3],e.data=t[4],e.data_id=t[5];break;default:e=null}return e},getPubkeyMessage:function(t,e){var n=new ePosDeviceMessage;n.request=n.REQUEST.PUBKEY,cipher.genClientKeys(t,e);for(var i=cipher.bfEncrypt("hello"),r=bigInt2str(cipher.pubkey_c,16);r.length<192;)r="0"+r;return n.data={key:r,testData:i},n},getAdminInfoMessage:function(){var t=new ePosDeviceMessage;return t.request=t.REQUEST.ADMININFO,t.data={},t},getReconnectMessage:function(t,e,n){var i=new ePosDeviceMessage;return i.request=i.REQUEST.RECONNECT,i.data={old_client_id:t,new_client_id:e,received_id:n},i},getDisconnectMessage:function(t){var e=new ePosDeviceMessage;return e.request=e.REQUEST.DISCONNECT,e.data={client_id:t},e},getOpenDeviceMessage:function(t,e,n,i){var r=new ePosDeviceMessage,s=e;return"type_hybrid_printer2"==s&&(s="type_hybrid_printer"),r.request=r.REQUEST.OPENDEVICE,r.deviceId=t,r.data={type:s,crypto:n,buffer:i},r},getCloseDeviceMessage:function(t){var e=new ePosDeviceMessage;return e.request=e.REQUEST.CLOSEDEVICE,e.deviceId=t,e.data={},e},getDeviceDataMessage:function(t,e,n){var i=new ePosDeviceMessage;return i.request=i.REQUEST.DEVICEDATA,i.sequence=getNextSequence(),i.deviceId=t,i.data=n?cipher.bfEncrypt(JSON.stringify(e)):e,i},getServiceMessage:function(t,e,n){var i=new ePosDeviceMessage;return i.request=i.REQUEST.SERVICEDATA,i.sequence=getNextSequence(),i.serviceId=t,i.isCrypto=e,i.data=e?cipher.bfEncrypt(JSON.stringify(n)):n,i},getOpenCommBoxMessage:function(t){var e=new ePosDeviceMessage;return e.request=e.REQUEST.OPENCOMMBOX,e.sequence=getNextSequence(),e.data=t,e},getCloseCommBoxMessage:function(t){var e=new ePosDeviceMessage;return e.request=e.REQUEST.CLOSECOMMBOX,e.sequence=getNextSequence(),e.data=t,e},getCommBoxDataMessage:function(t){var e=new ePosDeviceMessage;return e.request=e.REQUEST.COMMDATA,e.sequence=getNextSequence(),e.data=t,e},decrypt:function(t){var e=cipher.bfDecrypt(t);return JSON.parse(e)}}),sequence,cipher,JSON;function ePOSDeviceConfiguration(t){this.DEVICE_GROUP_ALL="group_all",this.DEVICE_GROUP_PRINTER="group_printer",this.DEVICE_GROUP_DISPLAY="group_display",this.DEVICE_GROUP_HID="group_hid",this.DEVICE_GROUP_SERIAL="group_serial",this.DEVICE_GROUP_OTHER="group_other",this.DEVICE_TYPE_PRINTER="type_printer",this.DEVICE_TYPE_HYBRID_PRINTER="type_hybrid_printer",this.DEVICE_TYPE_DISPLAY="type_display",this.DEVICE_TYPE_KEYBOARD="type_keyboard",this.DEVICE_TYPE_SCANNER="type_scanner",this.DEVICE_TYPE_MSR="type_msr",this.DEVICE_TYPE_CASH_CHANGER="type_cash_changer",this.DEVICE_TYPE_SIMPLE_SERIAL="type_simple_serial",this.DEVICE_TYPE_CASH_DRAWER="type_cash_drawer",this.DEVICE_TYPE_PIN_PAD="type_pin_pad",this.DEVICE_TYPE_CAT="type_cat",this.DEVICE_TYPE_SMARTCARD_RW="type_smartcard_rw",this.CGI_PATH="/epson_eposdevice/getDeviceList.cgi",this.RESULT_OK="OK",this.UNKNOWN="unknown",this.ONLINE="online",this.OFFLINE="offline",this.INTERVAL=500,this.TIMEOUT=6e4,this.address=t,this.cb=null,this.message=null,this.WEBSOCKET_PORT=8008,this.SSLWEBSOCKET_PORT=8043}if(ePOSDeviceConfiguration.prototype.getRegisterdDevices=function(t,e){this.cb=e;var n=this,i=null,r="?group="+t,s=window.location.protocol+"//"+this.address+this.CGI_PATH+r;window.XDomainRequest?((i=new XDomainRequest).open("GET",s),i.onload=function(){n.message=n.RESULT_OK;var t=JSON.parse(i.responseText);n.checkDevice(t,function(e){for(var i in e)for(var r=0;r<t.length;r++)t[r].deviceId==i&&(t[r].status=e[i]);null!=n.cb&&(n.cb(n,t),n.cb=null)})},i.onerror=function(){n.message="Failed to get device list.",null!=n.cb&&(n.cb(n,null),n.cb=null)}):((i=new XMLHttpRequest).open("GET",s,!0),i.setRequestHeader("Pragma","no-cache"),i.setRequestHeader("Cache-Control","no-cache"),i.setRequestHeader("If-Modified-Since","Thu, 01 Jun 1970 00:00:00 GMT"),i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status){n.message=n.RESULT_OK;var t=JSON.parse(i.responseText);n.checkDevice(t,function(e){for(var i in e)for(var r=0;r<t.length;r++)t[r].deviceId==i&&(t[r].status=e[i]);null!=n.cb&&(n.cb(n,t),n.cb=null)})}else n.message="Failed to get device list.",null!=n.cb&&(n.cb(n,null),n.cb=null)}),i.send(null)},ePOSDeviceConfiguration.prototype.checkDevice=function(t,e){for(var n,i=this,r=window.location.protocol.match(/^(https:)/)?this.SSLWEBSOCKET_PORT:this.WEBSOCKET_PORT,s=new epson.ePOSDevice,o=new Array,a=0;a<t.length;a++)o[t[a].deviceId]=i.UNKNOWN;s.onerror=function(t,e,n){""!=e&&(o[e]=i.OFFLINE)},s.connect(this.address,r,function(e){if("OK"==e||"SSL_CONNECT_OK"==e)for(var n=0;n<t.length;n++)s.createDevice(t[n].deviceId,t[n].deviceType,{},function(t,e){o[t.deviceID]="OK"==e?i.ONLINE:i.OFFLINE,s.deleteDevice(t,null)})}),n=window.setInterval(function(){for(var t in o)if(o[t]==i.UNKNOWN)return;clearInterval(n),null!=e&&e(o)},i.INTERVAL),window.setTimeout(function(){clearInterval(n),null!=e&&e(o)},i.TIMEOUT)},"object"!=typeof JSON&&(JSON={}),function(){function f(t){return t<10?"0"+t:t}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,i,r,s,o,a=gap,c=e[t];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(t)),"function"==typeof rep&&(c=rep.call(e,t,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(s=c.length,n=0;n<s;n+=1)o[n]=str(n,c)||"null";return r=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;n<s;n+=1)"string"==typeof rep[n]&&(r=str(i=rep[n],c))&&o.push(quote(i)+(gap?": ":":")+r);else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(r=str(i,c))&&o.push(quote(i)+(gap?": ":":")+r);return r=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,r}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var n,i,r=t[e];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&((i=walk(r,n))!==undefined?r[n]=i:delete r[n]);return reviver.call(t,e,r)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(t,e){var n=t;n.version="0.8.7",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(t,i){var r,s,o=n.util.parseUri(t);e&&e.location&&(o.protocol=o.protocol||e.location.protocol.slice(0,-1),o.host=o.host||(e.document?e.document.domain:e.location.hostname),o.port=o.port||e.location.port),r=n.util.uniqueUri(o);var a={host:o.host,secure:"https"==o.protocol,port:o.port||("https"==o.protocol?443:80),query:o.query||""};return n.util.merge(a,i),!a["force new connection"]&&n.sockets[r]||(s=new n.Socket(a)),!a["force new connection"]&&s&&(n.sockets[r]=s),(s=s||n.sockets[r]).of(o.path.length>1?o.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(t,e){var n=t.util={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(t){for(var e=i.exec(t||""),n={},s=14;s--;)n[r[s]]=e[s]||"";return n},n.uniqueUri=function(t){var n=t.protocol,i=t.host,r=t.port;return"document"in e?(i=i||document.domain,r=r||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(i=i||"localhost",r||"https"!=n||(r=443)),(n||"http")+"://"+i+":"+(r||80)},n.query=function(t,e){var i=n.chunkQuery(t||""),r=[];for(var s in n.merge(i,n.chunkQuery(e||"")),i)i.hasOwnProperty(s)&&r.push(s+"="+i[s]);return r.length?"?"+r.join("&"):""},n.chunkQuery=function(t){for(var e,n={},i=t.split("&"),r=0,s=i.length;r<s;++r)(e=i[r].split("="))[0]&&(n[e[0]]=decodeURIComponent(e[1]));return n};var s=!1;n.load=function(t){if("document"in e&&"complete"===document.readyState||s)return t();n.on(e,"load",t,!1)},n.on=function(t,e,n,i){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener&&t.addEventListener(e,n,i)},n.request=function(t){if(t&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!t||n.ua.hasCORS))return new XMLHttpRequest;if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}return null},void 0!==window&&n.load(function(){s=!0}),n.defer=function(t){if(!n.ua.webkit||"undefined"!=typeof importScripts)return t();n.load(function(){setTimeout(t,100)})},n.merge=function(t,e,i,r){var s,o=r||[],a=void 0===i?2:i;for(s in e)e.hasOwnProperty(s)&&n.indexOf(o,s)<0&&("object"==typeof t[s]&&a?n.merge(t[s],e[s],a-1,o):(t[s]=e[s],o.push(e[s])));return t},n.mixin=function(t,e){n.merge(t.prototype,e.prototype)},n.inherit=function(t,e){function n(){}n.prototype=e.prototype,t.prototype=new n},n.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},n.intersect=function(t,e){for(var i=[],r=t.length>e.length?t:e,s=t.length>e.length?e:t,o=0,a=s.length;o<a;o++)~n.indexOf(r,s[o])&&i.push(s[o]);return i},n.indexOf=function(t,e,n){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e,n);var i=t.length;for(n=n<0?n+i<0?0:n+i:n||0;n<i&&t[n]!==e;n++);return i<=n?-1:n},n.toArray=function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(t[n]);return e},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var t=new XMLHttpRequest}catch(e){return!1}return t.withCredentials!=undefined}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(t,e){function n(){}t.EventEmitter=n,n.prototype.on=function(t,n){return this.$events||(this.$events={}),this.$events[t]?e.util.isArray(this.$events[t])?this.$events[t].push(n):this.$events[t]=[this.$events[t],n]:this.$events[t]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(t,e){var n=this;function i(){n.removeListener(t,i),e.apply(this,arguments)}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,n){if(this.$events&&this.$events[t]){var i=this.$events[t];if(e.util.isArray(i)){for(var r=-1,s=0,o=i.length;s<o;s++)if(i[s]===n||i[s].listener&&i[s].listener===n){r=s;break}if(r<0)return this;i.splice(r,1),i.length||delete this.$events[t]}else(i===n||i.listener&&i.listener===n)&&delete this.$events[t]}return this},n.prototype.removeAllListeners=function(t){return this.$events&&this.$events[t]&&(this.$events[t]=null),this},n.prototype.listeners=function(t){return this.$events||(this.$events={}),this.$events[t]||(this.$events[t]=[]),e.util.isArray(this.$events[t])||(this.$events[t]=[this.$events[t]]),this.$events[t]},n.prototype.emit=function(t){if(!this.$events)return!1;var n=this.$events[t];if(!n)return!1;var i=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,i);else{if(!e.util.isArray(n))return!1;for(var r=n.slice(),s=0,o=r.length;s<o;s++)r[s].apply(this,i)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={};function f(t){return t<10?"0"+t:t}function date(t,e){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,i,r,s,o,a=gap,c=e[t];switch(c instanceof Date&&(c=date(t)),"function"==typeof rep&&(c=rep.call(e,t,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(s=c.length,n=0;n<s;n+=1)o[n]=str(n,c)||"null";return r=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;n<s;n+=1)"string"==typeof rep[n]&&(r=str(i=rep[n],c))&&o.push(quote(i)+(gap?": ":":")+r);else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(r=str(i,c))&&o.push(quote(i)+(gap?": ":":")+r);return r=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,r}}JSON.stringify=function(t,e,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})},JSON.parse=function(text,reviver){var j;function walk(t,e){var n,i,r=t[e];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&((i=walk(r,n))!==undefined?r[n]=i:delete r[n]);return reviver.call(t,e,r)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,void 0!==JSON?JSON:undefined),function(t,e){var n=t.parser={},i=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],r=n.reasons=["transport not supported","client not handshaken","unauthorized"],s=n.advice=["reconnect"],o=e.JSON,a=e.util.indexOf;n.encodePacket=function(t){var e=a(i,t.type),n=t.id||"",c=t.endpoint||"",h=t.ack,u=null;switch(t.type){case"error":var p=t.reason?a(r,t.reason):"",l=t.advice?a(s,t.advice):"";""===p&&""===l||(u=p+(""!==l?"+"+l:""));break;case"message":""!==t.data&&(u=t.data);break;case"event":var d={name:t.name};t.args&&t.args.length&&(d.args=t.args),u=o.stringify(d);break;case"json":u=o.stringify(t.data);break;case"connect":t.qs&&(u=t.qs);break;case"ack":u=t.ackId+(t.args&&t.args.length?"+"+o.stringify(t.args):"")}var f=[e,n+("data"==h?"+":""),c];return null!==u&&u!==undefined&&f.push(u),f.join(":")},n.encodePayload=function(t){var e="";if(1==t.length)return t[0];for(var n=0,i=t.length;n<i;n++){e+=""+t[n].length+""+t[n]}return e};var c=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(t){if(!(a=t.match(c)))return{};var e=a[2]||"",n=(t=a[5]||"",{type:i[a[1]],endpoint:a[4]||""});switch(e&&(n.id=e,a[3]?n.ack="data":n.ack=!0),n.type){case"error":var a=t.split("+");n.reason=r[a[0]]||"",n.advice=s[a[1]]||"";break;case"message":n.data=t||"";break;case"event":try{var h=o.parse(t);n.name=h.name,n.args=h.args}catch(u){}n.args=n.args||[];break;case"json":try{n.data=o.parse(t)}catch(u){}break;case"connect":n.qs=t||"";break;case"ack":if((a=t.match(/^([0-9]+)(\+)?(.*)/))&&(n.ackId=a[1],n.args=[],a[3]))try{n.args=a[3]?o.parse(a[3]):[]}catch(u){}}return n},n.decodePayload=function(t){if(""==t.charAt(0)){for(var e=[],i=1,r="";i<t.length;i++)""==t.charAt(i)?(e.push(n.decodePacket(t.substr(i+1).substr(0,r))),i+=Number(r)+1,r=""):r+=t.charAt(i);return e}return[n.decodePacket(t)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(t,e){function n(t,e){this.socket=t,this.sessid=e}t.Transport=n,e.util.mixin(n,e.EventEmitter),n.prototype.onData=function(t){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==t){var n=e.parser.decodePayload(t);if(n&&n.length)for(var i=0,r=n.length;i<r;i++)this.onPacket(n[i])}return this},n.prototype.onPacket=function(t){return"heartbeat"==t.type?this.onHeartbeat():("connect"==t.type&&""==t.endpoint&&this.onConnect(),this.socket.onPacket(t),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var t=this;this.closeTimeout=setTimeout(function(){t.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.close&&this.open&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(t){this.send(e.parser.encodePacket(t))},n.prototype.onHeartbeat=function(t){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.open=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.open=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var t=this.socket.options;return this.scheme()+"://"+t.host+":"+t.port+"/"+t.resource+"/"+e.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(t,e){e.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(t,e,n){function i(t){if(this.options={port:80,secure:!1,document:"document"in n&&document,resource:"socket.io",transports:e.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},e.util.merge(this.options,t),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||e.util.ua.hasCORS)){var i=this;e.util.on(n,"beforeunload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function r(){}t.Socket=i,e.util.mixin(i,e.EventEmitter),i.prototype.of=function(t){return this.namespaces[t]||(this.namespaces[t]=new e.SocketNamespace(this,t),""!==t&&this.namespaces[t].packet({type:"connect"})),this.namespaces[t]},i.prototype.publish=function(){var t;for(var e in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(e)&&(t=this.of(e)).$emit.apply(t,arguments)},i.prototype.handshake=function(t){var n=this,i=this.options;function s(e){e instanceof Error?n.onError(e.message):t.apply(null,e.split(":"))}var o=["http"+(i.secure?"s":"")+":/",i.host+":"+i.port,i.resource,e.protocol,e.util.query(this.options.query,"t="+ +new Date)].join("/"),a=setTimeout(function(){if(void 0!==h)try{var t=h.src.lastIndexOf("=")+1,i=h.src.substring(t);e.j[i]=function(t){h.parentNode.removeChild(h)}}catch(r){}n.publish("connect_failed")},this.options["connect timeout"]);if(this.isXDomain()&&!e.util.ua.hasCORS){var c=document.getElementsByTagName("script")[0],h=document.createElement("script");h.src=o+"&jsonp="+e.j.length,c.parentNode.insertBefore(h,c),e.j.push(function(t){clearTimeout(a),s(t),h.parentNode.removeChild(h)})}else{var u=e.util.request();u.open("GET",o,!0),u.onreadystatechange=function(){4==u.readyState&&(u.onreadystatechange=r,clearTimeout(a),200==u.status?s(u.responseText):!n.reconnecting&&n.onError(u.responseText))},u.timeout=this.options["connect timeout"],u.send(null)}},i.prototype.getTransport=function(t){for(var n,i=t||this.transports,r=0;n=i[r];r++)if(e.Transport[n]&&e.Transport[n].check(this)&&(!this.isXDomain()||e.Transport[n].xdomainCheck()))return new e.Transport[n](this,this.sessionid);return null},i.prototype.connect=function(t){if(this.connecting)return this;var n=this;return this.handshake(function(i,r,s,o){n.sessionid=i,n.closeTimeout=1e3*s,n.heartbeatTimeout=1e3*r,n.transports=e.util.intersect(o.split(","),n.options.transports),function t(e){if(n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),!n.transport)return n.publish("connect_failed");n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){n.remainingTransports||(n.remainingTransports=n.transports.slice(0));for(var e=n.remainingTransports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?t(e):n.publish("connect_failed")}},n.options["connect timeout"]))})}(),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),t&&"function"==typeof t&&t()})}),this},i.prototype.packet=function(t){return this.connected&&!this.doBuffer?this.transport.packet(t):this.buffer.push(t),this},i.prototype.setBuffer=function(t){this.doBuffer=t,!t&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},i.prototype.disconnect=function(){return this.connected&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},i.prototype.disconnectSync=function(){var t=e.util.request(),n=this.resource+"/"+e.protocol+"/"+this.sessionid;t.open("GET",n,!0),this.onDisconnect("booted")},i.prototype.isXDomain=function(){var t=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=t},i.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},i.prototype.onOpen=function(){this.open=!0},i.prototype.onClose=function(){this.open=!1},i.prototype.onPacket=function(t){this.of(t.endpoint).onPacket(t)},i.prototype.onError=function(t){t&&t.advice&&"reconnect"===t.advice&&this.connected&&(this.disconnect(),this.reconnect()),this.publish("error",t&&t.reason?t.reason:t)},i.prototype.onDisconnect=function(t){var e=this.connected;this.connected=!1,this.connecting=!1,this.open=!1,e&&(this.transport.close(),this.transport.clearTimeouts(),this.publish("disconnect",t),"booted"!=t&&this.options.reconnect&&!this.reconnecting&&this.reconnect())},i.prototype.reconnect=function(){this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var t=this,e=this.options["max reconnection attempts"],n=this.options["try multiple transports"],i=this.options["reconnection limit"];function r(){if(t.connected){for(var e in t.namespaces)t.namespaces.hasOwnProperty(e)&&""!==e&&t.namespaces[e].packet({type:"connect"});t.publish("reconnect",t.transport.name,t.reconnectionAttempts)}t.removeListener("connect_failed",s),t.removeListener("connect",s),t.reconnecting=!1,delete t.reconnectionAttempts,delete t.reconnectionDelay,delete t.reconnectionTimer,delete t.redoTransports,t.options["try multiple transports"]=n}function s(){if(t.reconnecting)return t.connected?r():t.connecting&&t.reconnecting?t.reconnectionTimer=setTimeout(s,1e3):void(t.reconnectionAttempts++>=e?t.redoTransports?(t.publish("reconnect_failed"),r()):(t.on("connect_failed",s),t.options["try multiple transports"]=!0,t.transport=t.getTransport(),t.redoTransports=!0,t.connect()):(t.reconnectionDelay<i&&(t.reconnectionDelay*=2),t.connect(),t.publish("reconnecting",t.reconnectionDelay,t.reconnectionAttempts),t.reconnectionTimer=setTimeout(s,t.reconnectionDelay)))}this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(s,this.reconnectionDelay),this.on("connect",s)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(t,e){function n(t,e){this.socket=t,this.name=e||"",this.flags={},this.json=new i(this,"json"),this.ackPackets=0,this.acks={}}function i(t,e){this.namespace=t,this.name=e}t.SocketNamespace=n,e.util.mixin(n,e.EventEmitter),n.prototype.$emit=e.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(t){return t.endpoint=this.name,this.socket.packet(t),this.flags={},this},n.prototype.send=function(t,e){var n={type:this.flags.json?"json":"message",data:t};return"function"==typeof e&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=e),this.packet(n)},n.prototype.emit=function(t){var e=Array.prototype.slice.call(arguments,1),n=e[e.length-1],i={type:"event",name:t};return"function"==typeof n&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=n,e=e.slice(0,e.length-1)),i.args=e,this.packet(i)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(t){var n=this;function i(){n.packet({type:"ack",args:e.util.toArray(arguments),ackId:t.id})}switch(t.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(t.reason||"booted"):this.$emit("disconnect",t.reason);break;case"message":case"json":var r=["message",t.data];"data"==t.ack?r.push(i):t.ack&&this.packet({type:"ack",ackId:t.id}),this.$emit.apply(this,r);break;case"event":r=[t.name].concat(t.args);"data"==t.ack&&r.push(i),this.$emit.apply(this,r);break;case"ack":this.acks[t.ackId]&&(this.acks[t.ackId].apply(this,t.args),delete this.acks[t.ackId]);break;case"error":t.advice?this.socket.onError(t):"unauthorized"==t.reason?this.$emit("connect_failed",t.reason):this.$emit("error",t.reason)}},i.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},i.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(t,e,n){function i(t){e.Transport.apply(this,arguments)}t.websocket=i,e.util.inherit(i,e.Transport),i.prototype.name="websocket",i.prototype.open=function(){var t,i=e.util.query(this.socket.options.query),r=this;return t||(t=n.MozWebSocket||n.WebSocket),this.websocket=new t(this.prepareUrl()+i),this.websocket.onopen=function(){r.onOpen(),r.socket.setBuffer(!1)},this.websocket.onmessage=function(t){r.onData(t.data)},this.websocket.onclose=function(){r.onClose(),r.socket.setBuffer(!0)},this.websocket.onerror=function(t){r.onError(t)},this},i.prototype.send=function(t){return this.websocket.send(t),this},i.prototype.payload=function(t){for(var e=0,n=t.length;e<n;e++)this.packet(t[e]);return this},i.prototype.close=function(){return this.websocket.close(),this},i.prototype.onError=function(t){this.socket.onError(t)},i.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},i.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},i.xdomainCheck=function(){return!0},e.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(t,e){function n(){e.Transport.websocket.apply(this,arguments)}t.flashsocket=n,e.util.inherit(n,e.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var t=this,n=arguments;return WebSocket.__addTask(function(){e.Transport.websocket.prototype.open.apply(t,n)}),this},n.prototype.send=function(){var t=this,n=arguments;return WebSocket.__addTask(function(){e.Transport.websocket.prototype.send.apply(t,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,e.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(t,i){function r(){var e=t.options,r=e["flash policy port"],o=["http"+(e.secure?"s":"")+":/",e.host+":"+e.port,e.resource,"static/flashsocket","WebSocketMain"+(t.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=o.join("/")),843!==r&&WebSocket.loadFlashPolicyFile("xmlsocket://"+e.host+":"+r),WebSocket.__initialize(),n.loaded=!0),i.call(s)}var s=this;if(document.body)return r();e.util.load(r)},n.check=function(){return!("undefined"==typeof WebSocket||!("__initialize"in WebSocket)||!swfobject)&&swfobject.getFlashPlayerVersion().major>=10},n.xdomainCheck=function(){return!0},void 0!==window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),e.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),void 0!==window)var swfobject=function(){var t,e,n,i,r,s,o="undefined",a="object",c="Shockwave Flash",h="application/x-shockwave-flash",u="SWFObjectExprInst",p="onreadystatechange",l=window,d=document,f=navigator,_=!1,E=[function(){_?function(){var t=d.getElementsByTagName("body")[0],e=U(a);e.setAttribute("type",h);var n=t.appendChild(e);if(n){var i=0;!function(){if(typeof n.GetVariable!=o){var r=n.GetVariable("$version");r&&(r=r.split(" ")[1].split(","),b.pv=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)])}else if(i<10)return i++,void setTimeout(arguments.callee,10);t.removeChild(e),n=null,A()}()}else A()}():A()}],y=[],m=[],R=[],g=!1,O=!1,v=!0,b=function(){var t=typeof d.getElementById!=o&&typeof d.getElementsByTagName!=o&&typeof d.createElement!=o,e=f.userAgent.toLowerCase(),n=f.platform.toLowerCase(),i=n?/win/.test(n):/win/.test(e),r=n?/mac/.test(n):/mac/.test(e),s=!!/webkit/.test(e)&&parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),u=!1,p=[0,0,0],E=null;if(typeof f.plugins!=o&&typeof f.plugins[c]==a)!(E=f.plugins[c].description)||typeof f.mimeTypes!=o&&f.mimeTypes[h]&&!f.mimeTypes[h].enabledPlugin||(_=!0,u=!1,E=E.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),p[0]=parseInt(E.replace(/^(.*)\..*$/,"$1"),10),p[1]=parseInt(E.replace(/^.*\.(.*)\s.*$/,"$1"),10),p[2]=/[a-zA-Z]/.test(E)?parseInt(E.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof l.ActiveXObject!=o)try{var y=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");y&&(E=y.GetVariable("$version"))&&(u=!0,E=E.split(" ")[1].split(","),p=[parseInt(E[0],10),parseInt(E[1],10),parseInt(E[2],10)])}catch(m){}return{w3:t,pv:p,wk:s,ie:u,win:i,mac:r}}();b.w3&&((typeof d.readyState!=o&&"complete"==d.readyState||typeof d.readyState==o&&(d.getElementsByTagName("body")[0]||d.body))&&S(),g||(typeof d.addEventListener!=o&&d.addEventListener("DOMContentLoaded",S,!1),b.ie&&b.win&&(d.attachEvent(p,function(){"complete"==d.readyState&&(d.detachEvent(p,arguments.callee),S())}),l==top&&function(){if(!g){try{d.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}S()}}()),b.wk&&function(){g||(/loaded|complete/.test(d.readyState)?S():setTimeout(arguments.callee,0))}(),P(S)));function S(){if(!g){try{var t=d.getElementsByTagName("body")[0].appendChild(U("span"));t.parentNode.removeChild(t)}catch(i){return}g=!0;for(var e=E.length,n=0;n<e;n++)E[n]()}}function T(t){g?t():E[E.length]=t}function P(t){if(typeof l.addEventListener!=o)l.addEventListener("load",t,!1);else if(typeof d.addEventListener!=o)d.addEventListener("load",t,!1);else if(typeof l.attachEvent!=o)!function(t,e,n){t.attachEvent(e,n),R[R.length]=[t,e,n]}(l,"onload",t);else if("function"==typeof l.onload){var e=l.onload;l.onload=function(){e(),t()}}else l.onload=t}function A(){var t=y.length;if(t>0)for(var e=0;e<t;e++){var n=y[e].id,i=y[e].callbackFn,r={success:!1,id:n};if(b.pv[0]>0){var s=B(n);if(s)if(!j(y[e].swfVersion)||b.wk&&b.wk<312)if(y[e].expressInstall&&I()){var a={};a.data=y[e].expressInstall,a.width=s.getAttribute("width")||"0",a.height=s.getAttribute("height")||"0",s.getAttribute("class")&&(a.styleclass=s.getAttribute("class")),s.getAttribute("align")&&(a.align=s.getAttribute("align"));for(var c={},h=s.getElementsByTagName("param"),u=h.length,p=0;p<u;p++)"movie"!=h[p].getAttribute("name").toLowerCase()&&(c[h[p].getAttribute("name")]=h[p].getAttribute("value"));N(a,c,n,i)}else D(s),i&&i(r);else V(n,!0),i&&(r.success=!0,r.ref=C(n),i(r))}else if(V(n,!0),i){var l=C(n);l&&typeof l.SetVariable!=o&&(r.success=!0,r.ref=l),i(r)}}}function C(t){var e=null,n=B(t);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=o)e=n;else{var i=n.getElementsByTagName(a)[0];i&&(e=i)}return e}function I(){return!O&&j("6.0.65")&&(b.win||b.mac)&&!(b.wk&&b.wk<312)}function N(r,s,a,c){O=!0,n=c||null,i={success:!1,id:a};var h=B(a);if(h){"OBJECT"==h.nodeName?(t=w(h),e=null):(t=h,e=a),r.id=u,(typeof r.width==o||!/%$/.test(r.width)&&parseInt(r.width,10)<310)&&(r.width="310"),(typeof r.height==o||!/%$/.test(r.height)&&parseInt(r.height,10)<137)&&(r.height="137"),d.title=d.title.slice(0,47)+" - Flash Player Installation";var p=b.ie&&b.win?"ActiveX":"PlugIn",f="MMredirectURL="+l.location.toString().replace(/&/g,"%26")+"&MMplayerType="+p+"&MMdoctitle="+d.title;if(typeof s.flashvars!=o?s.flashvars+="&"+f:s.flashvars=f,b.ie&&b.win&&4!=h.readyState){var _=U("div");a+="SWFObjectNew",_.setAttribute("id",a),h.parentNode.insertBefore(_,h),h.style.display="none",function(){4==h.readyState?h.parentNode.removeChild(h):setTimeout(arguments.callee,10)}()}M(r,s,a)}}function D(t){if(b.ie&&b.win&&4!=t.readyState){var e=U("div");t.parentNode.insertBefore(e,t),e.parentNode.replaceChild(w(t),e),t.style.display="none",function(){4==t.readyState?t.parentNode.removeChild(t):setTimeout(arguments.callee,10)}()}else t.parentNode.replaceChild(w(t),t)}function w(t){var e=U("div");if(b.win&&b.ie)e.innerHTML=t.innerHTML;else{var n=t.getElementsByTagName(a)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,s=0;s<r;s++)1==i[s].nodeType&&"PARAM"==i[s].nodeName||8==i[s].nodeType||e.appendChild(i[s].cloneNode(!0))}}return e}function M(t,e,n){var i,r=B(n);if(b.wk&&b.wk<312)return i;if(r)if(typeof t.id==o&&(t.id=n),b.ie&&b.win){var s="";for(var c in t)t[c]!=Object.prototype[c]&&("data"==c.toLowerCase()?e.movie=t[c]:"styleclass"==c.toLowerCase()?s+=' class="'+t[c]+'"':"classid"!=c.toLowerCase()&&(s+=" "+c+'="'+t[c]+'"'));var u="";for(var p in e)e[p]!=Object.prototype[p]&&(u+='<param name="'+p+'" value="'+e[p]+'" />');r.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+s+">"+u+"</object>",m[m.length]=t.id,i=B(t.id)}else{var l=U(a);for(var d in l.setAttribute("type",h),t)t[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?l.setAttribute("class",t[d]):"classid"!=d.toLowerCase()&&l.setAttribute(d,t[d]));for(var f in e)e[f]!=Object.prototype[f]&&"movie"!=f.toLowerCase()&&L(l,f,e[f]);r.parentNode.replaceChild(l,r),i=l}return i}function L(t,e,n){var i=U("param");i.setAttribute("name",e),i.setAttribute("value",n),t.appendChild(i)}function k(t){var e=B(t);e&&"OBJECT"==e.nodeName&&(b.ie&&b.win?(e.style.display="none",function(){4==e.readyState?x(t):setTimeout(arguments.callee,10)}()):e.parentNode.removeChild(e))}function x(t){var e=B(t);if(e){for(var n in e)"function"==typeof e[n]&&(e[n]=null);e.parentNode.removeChild(e)}}function B(t){var e=null;try{e=d.getElementById(t)}catch(n){}return e}function U(t){return d.createElement(t)}function j(t){var e=b.pv,n=t.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,e[0]>n[0]||e[0]==n[0]&&e[1]>n[1]||e[0]==n[0]&&e[1]==n[1]&&e[2]>=n[2]}function F(t,e,n,i){if(!b.ie||!b.mac){var c=d.getElementsByTagName("head")[0];if(c){var h=n&&"string"==typeof n?n:"screen";if(i&&(r=null,s=null),!r||s!=h){var u=U("style");u.setAttribute("type","text/css"),u.setAttribute("media",h),r=c.appendChild(u),b.ie&&b.win&&typeof d.styleSheets!=o&&d.styleSheets.length>0&&(r=d.styleSheets[d.styleSheets.length-1]),s=h}b.ie&&b.win?r&&typeof r.addRule==a&&r.addRule(t,e):r&&typeof d.createTextNode!=o&&r.appendChild(d.createTextNode(t+" {"+e+"}"))}}}function V(t,e){if(v){var n=e?"visible":"hidden";g&&B(t)?B(t).style.visibility=n:F("#"+t,"visibility:"+n)}}function H(t){return null!=/[\\\"<>\.;]/.exec(t)&&typeof encodeURIComponent!=o?encodeURIComponent(t):t}b.ie&&b.win&&window.attachEvent("onunload",function(){for(var t=R.length,e=0;e<t;e++)R[e][0].detachEvent(R[e][1],R[e][2]);for(var n=m.length,i=0;i<n;i++)k(m[i]);for(var r in b)b[r]=null;for(var s in b=null,swfobject)swfobject[s]=null;swfobject=null});return{registerObject:function(t,e,n,i){if(b.w3&&t&&e){var r={};r.id=t,r.swfVersion=e,r.expressInstall=n,r.callbackFn=i,y[y.length]=r,V(t,!1)}else i&&i({success:!1,id:t})},getObjectById:function(t){if(b.w3)return C(t)},embedSWF:function(t,e,n,i,r,s,c,h,u,p){var l={success:!1,id:e};b.w3&&!(b.wk&&b.wk<312)&&t&&e&&n&&i&&r?(V(e,!1),T(function(){n+="",i+="";var d={};if(u&&typeof u===a)for(var f in u)d[f]=u[f];d.data=t,d.width=n,d.height=i;var _={};if(h&&typeof h===a)for(var E in h)_[E]=h[E];if(c&&typeof c===a)for(var y in c)typeof _.flashvars!=o?_.flashvars+="&"+y+"="+c[y]:_.flashvars=y+"="+c[y];if(j(r)){var m=M(d,_,e);d.id==e&&V(e,!0),l.success=!0,l.ref=m}else{if(s&&I())return d.data=s,void N(d,_,e,p);V(e,!0)}p&&p(l)})):p&&p(l)},switchOffAutoHideShow:function(){v=!1},ua:b,getFlashPlayerVersion:function(){return{major:b.pv[0],minor:b.pv[1],release:b.pv[2]}},hasFlashPlayerVersion:j,createSWF:function(t,e,n){return b.w3?M(t,e,n):undefined},showExpressInstall:function(t,e,n,i){b.w3&&I()&&N(t,e,n,i)},removeSWF:function(t){b.w3&&k(t)},createCSS:function(t,e,n,i){b.w3&&F(t,e,n,i)},addDomLoadEvent:T,addLoadEvent:P,getQueryParamValue:function(t){var e=d.location.search||d.location.hash;if(e){if(/\?/.test(e)&&(e=e.split("?")[1]),null==t)return H(e);for(var n=e.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==t)return H(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(O){var r=B(u);r&&t&&(r.parentNode.replaceChild(t,r),e&&(V(e,!0),b.ie&&b.win&&(t.style.display="block")),n&&n(i)),O=!1}}}}();!function(){if(void 0!==window&&!window.WebSocket){var t=window.console;t&&t.log&&t.error||(t={log:function(){},error:function(){}}),swfobject.hasFlashPlayerVersion("10.0.0")?("file:"==location.protocol&&t.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(t,e,n,i,r){var s=this;s.__id=WebSocket.__nextId++,WebSocket.__instances[s.__id]=s,s.readyState=WebSocket.CONNECTING,s.bufferedAmount=0,s.__events={},e?"string"==typeof e&&(e=[e]):e=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(s.__id,t,e,n||null,i||0,r||null)})},0)},WebSocket.prototype.send=function(t){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var e=WebSocket.__flash.send(this.__id,encodeURIComponent(t));return e<0||(this.bufferedAmount+=e,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(t,e,n){t in this.__events||(this.__events[t]=[]),this.__events[t].push(e)},WebSocket.prototype.removeEventListener=function(t,e,n){if(t in this.__events)for(var i=this.__events[t],r=i.length-1;r>=0;--r)if(i[r]===e){i.splice(r,1);break}},WebSocket.prototype.dispatchEvent=function(t){for(var e=this.__events[t.type]||[],n=0;n<e.length;++n)e[n](t);var i=this["on"+t.type];i&&i(t)},WebSocket.prototype.__handleEvent=function(t){var e;if("readyState"in t&&(this.readyState=t.readyState),"protocol"in t&&(this.protocol=t.protocol),"open"==t.type||"error"==t.type)e=this.__createSimpleEvent(t.type);else if("close"==t.type)e=this.__createSimpleEvent("close");else{if("message"!=t.type)throw"unknown event type: "+t.type;var n=decodeURIComponent(t.message);e=this.__createMessageEvent("message",n)}this.dispatchEvent(e)},WebSocket.prototype.__createSimpleEvent=function(t){if(document.createEvent&&window.Event){var e=document.createEvent("Event");return e.initEvent(t,!1,!1),e}return{type:t,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(t,e){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,e,null,null,window,null),n}return{type:t,data:e,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(t){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(t)})},WebSocket.__initialize=function(){if(!WebSocket.__flash)if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),window.WEB_SOCKET_SWF_LOCATION){var e=document.createElement("div");e.id="webSocketContainer",e.style.position="absolute",WebSocket.__isFlashLite()?(e.style.left="0px",e.style.top="0px"):(e.style.left="-100px",e.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",e.appendChild(n),document.body.appendChild(e),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(e){e.success||t.error("[WebSocket] swfobject.embedSWF failed")})}else t.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf")},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var t=0;t<WebSocket.__tasks.length;++t)WebSocket.__tasks[t]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var e=WebSocket.__flash.receiveEvents(),n=0;n<e.length;++n)WebSocket.__instances[e[n].webSocketId].__handleEvent(e[n])}catch(i){t.error(i)}},0),!0},WebSocket.__log=function(e){t.log(decodeURIComponent(e))},WebSocket.__error=function(e){t.error(decodeURIComponent(e))},WebSocket.__addTask=function(t){WebSocket.__flash?t():WebSocket.__tasks.push(t)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var t=window.navigator.mimeTypes["application/x-shockwave-flash"];return!!(t&&t.enabledPlugin&&t.enabledPlugin.filename)&&!!t.enabledPlugin.filename.match(/flashlite/i)},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))):t.error("Flash Player >= 10.0.0 is required.")}}(),function(t,e,n){function i(t){t&&(e.Transport.apply(this,arguments),this.sendBuffer=[])}function r(){}t.XHR=i,e.util.inherit(i,e.Transport),i.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},i.prototype.payload=function(t){for(var n=[],i=0,r=t.length;i<r;i++)n.push(e.parser.encodePacket(t[i]));this.send(e.parser.encodePayload(n))},i.prototype.send=function(t){return this.post(t),this},i.prototype.post=function(t){var e=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=r,e.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=r,e.posting=!1,200==this.status?e.socket.setBuffer(!1):e.onClose())},this.sendXHR.send(t)},i.prototype.close=function(){return this.onClose(),this},i.prototype.request=function(t){var n=e.util.request(this.socket.isXDomain()),i=e.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(t||"GET",this.prepareUrl()+i,!0),"POST"==t)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(r){}return n},i.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},i.check=function(t,n){try{if(e.util.request(n))return!0}catch(i){}return!1},i.xdomainCheck=function(){return i.check(null,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(t,e){function n(t){e.Transport.XHR.apply(this,arguments)}t.htmlfile=n,e.util.inherit(n,e.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new ActiveXObject("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var t=this.doc.createElement("div");t.className="socketio",this.doc.body.appendChild(t),this.iframe=this.doc.createElement("iframe"),t.appendChild(this.iframe);var n=this,i=e.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+i,e.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(t,e){this.onData(t);try{var n=e.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(i){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(t){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),e.Transport.XHR.prototype.close.call(this)},n.check=function(){if("ActiveXObject"in window)try{return new ActiveXObject("htmlfile")&&e.Transport.XHR.check()}catch(t){}return!1},n.xdomainCheck=function(){return!1},e.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(t,e,n){function i(){e.Transport.XHR.apply(this,arguments)}function r(){}t["xhr-polling"]=i,e.util.inherit(i,e.Transport.XHR),e.util.merge(i,e.Transport.XHR),i.prototype.name="xhr-polling",i.prototype.open=function(){return e.Transport.XHR.prototype.open.call(this),!1},i.prototype.get=function(){if(this.open){var t=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?this.xhr.onload=this.xhr.onerror=function(){this.onload=r,t.onData(this.responseText),t.get()}:this.xhr.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=r,200==this.status?(t.onData(this.responseText),t.get()):t.onClose())},this.xhr.send(null)}},i.prototype.onClose=function(){if(e.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=r;try{this.xhr.abort()}catch(t){}this.xhr=null}},i.prototype.ready=function(t,n){var i=this;e.util.defer(function(){n.call(i)})},e.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(t,e,n){var i=n.document&&"MozAppearance"in n.document.documentElement.style;function r(t){e.Transport["xhr-polling"].apply(this,arguments),this.index=e.j.length;var n=this;e.j.push(function(t){n._(t)})}t["jsonp-polling"]=r,e.util.inherit(r,e.Transport["xhr-polling"]),r.prototype.name="jsonp-polling",r.prototype.post=function(t){var n=this,i=e.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var r,s=document.createElement("form"),o=document.createElement("textarea"),a=this.iframeId="socketio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=a,s.method="POST",s.setAttribute("accept-charset","utf-8"),o.name="d",s.appendChild(o),document.body.appendChild(s),this.form=s,this.area=o}function c(){h(),n.socket.setBuffer(!1)}function h(){n.iframe&&n.form.removeChild(n.iframe);try{r=document.createElement('<iframe name="'+n.iframeId+'">')}catch(t){(r=document.createElement("iframe")).name=n.iframeId}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.prepareUrl()+i,h(),this.area.value=e.JSON.stringify(t);try{this.form.submit()}catch(u){}this.iframe.attachEvent?r.onreadystatechange=function(){"complete"==n.iframe.readyState&&c()}:this.iframe.onload=c,this.socket.setBuffer(!0)},r.prototype.get=function(){var t=this,n=document.createElement("script"),r=e.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+r,n.onerror=function(){t.onClose()};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(n,s),this.script=n,i&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},r.prototype._=function(t){return this.onData(t),this.open&&this.get(),this},r.prototype.ready=function(t,n){var r=this;if(!i)return n.call(this);e.util.load(function(){n.call(r)})},r.check=function(){return"document"in n},r.xdomainCheck=function(){return!0},e.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),JSON||(JSON={}),function(){function f(t){return t<10?"0"+t:t}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,i,r,s,o,a=gap,c=e[t];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(t)),"function"==typeof rep&&(c=rep.call(e,t,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(s=c.length,n=0;n<s;n+=1)o[n]=str(n,c)||"null";return r=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;n<s;n+=1)"string"==typeof rep[n]&&(r=str(i=rep[n],c))&&o.push(quote(i)+(gap?": ":":")+r);else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(r=str(i,c))&&o.push(quote(i)+(gap?": ":":")+r);return r=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,r}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var n,i,r=t[e];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&((i=walk(r,n))!==undefined?r[n]=i:delete r[n]);return reviver.call(t,e,r)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var base64=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={},i=0;i<64;)n[e.charAt(i)]=i,i++;return{encode:function(t){for(var n,i=0,r=0,s=t+"\0\0",o=s.length-2,a=new Array((o+2)/3<<2);i<o;)n=(255&s.charCodeAt(i++))<<16|(255&s.charCodeAt(i++))<<8|255&s.charCodeAt(i++),a[r++]=e.charAt(n>>18&63),a[r++]=e.charAt(n>>12&63),a[r++]=e.charAt(n>>6&63),a[r++]=e.charAt(63&n);for(;i>o;)a[--r]="=",i--;return a.join("")},decode:function(t){for(var e,i=0,r=0,s=t.replace(/[^A-Za-z0-9\+\/]/g,"")+"AAA",o=s.length-3,a=new Array(3*(o+3>>2)),c=String.fromCharCode;i<o;)e=n[s.charAt(i++)]<<18|n[s.charAt(i++)]<<12|n[s.charAt(i++)]<<6|n[s.charAt(i++)],a[r++]=c(e>>16&255),a[r++]=c(e>>8&255),a[r++]=c(255&e);return a.length=r-i+o,a.join("")}}}();for(bpe=0,mask=0,radix=mask+1,digitsStr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-",bpe=0;1<<bpe+1>1<<bpe;bpe++);function findPrimes(t){var e,n,i,r;for(n=new Array(t),e=0;e<t;e++)n[e]=0;for(n[0]=2,i=0;n[i]<t;){for(e=n[i]*n[i];e<t;e+=n[i])n[e]=1;for(n[++i]=n[i-1]+1;n[i]<t&&n[n[i]];n[i]++);}for(r=new Array(i),e=0;e<i;e++)r[e]=n[e];return r}function millerRabinInt(t,e){return mr_x1.length!=t.length&&(mr_x1=dup(t),mr_r=dup(t),mr_a=dup(t)),copyInt_(mr_a,e),millerRabin(t,mr_a)}function millerRabin(t,e){var n,i,r,s;for(mr_x1.length!=t.length&&(mr_x1=dup(t),mr_r=dup(t),mr_a=dup(t)),copy_(mr_a,e),copy_(mr_r,t),copy_(mr_x1,t),addInt_(mr_r,-1),addInt_(mr_x1,-1),r=0,n=0;n<mr_r.length;n++)for(i=1;i<mask;i<<=1)t[n]&i?(s=r<mr_r.length+bpe?r:0,n=mr_r.length,i=mask):r++;if(s&&rightShift_(mr_r,s),powMod_(mr_a,mr_r,t),!equalsInt(mr_a,1)&&!equals(mr_a,mr_x1)){for(i=1;i<=s-1&&!equals(mr_a,mr_x1);){if(squareMod_(mr_a,t),equalsInt(mr_a,1))return 0;i++}if(!equals(mr_a,mr_x1))return 0}return 1}function bitSize(t){var e,n,i;for(e=t.length-1;0==t[e]&&e>0;e--);for(n=0,i=t[e];i;i>>=1,n++);return n+=bpe*e}function expand(t,e){var n=int2bigInt(0,(t.length>e?t.length:e)*bpe,0);return copy_(n,t),n}function randTruePrime(t){var e=int2bigInt(0,t,0);return randTruePrime_(e,t),trim(e,1)}function randProbPrime(t){return randProbPrimeRounds(t,t>=600?2:t>=550?4:t>=500?5:t>=400?6:t>=350?7:t>=300?9:t>=250?12:t>=200?15:t>=150?18:t>=100?27:40)}function randProbPrimeRounds(t,e){var n,i,r;for(3e4,n=int2bigInt(0,t,0),0==primes.length&&(primes=findPrimes(3e4)),rpprb.length!=n.length&&(rpprb=dup(n));;){for(randBigInt_(n,t,0),n[0]|=1,r=0,i=0;i<primes.length&&primes[i]<=3e4;i++)if(0==modInt(n,primes[i])&&!equalsInt(n,primes[i])){r=1;break}for(i=0;i<e&&!r;i++){for(randBigInt_(rpprb,t,0);!greater(n,rpprb);)randBigInt_(rpprb,t,0);millerRabin(n,rpprb)||(r=1)}if(!r)return n}}function mod(t,e){var n=dup(t);return mod_(n,e),trim(n,1)}function addInt(t,e){var n=expand(t,t.length+1);return addInt_(n,e),trim(n,1)}function mult(t,e){var n=expand(t,t.length+e.length);return mult_(n,e),trim(n,1)}function powMod(t,e,n){var i=expand(t,n.length);return powMod_(i,trim(e,2),trim(n,2),0),trim(i,1)}function sub(t,e){var n=expand(t,t.length>e.length?t.length+1:e.length+1);return sub_(n,e),trim(n,1)}function add(t,e){var n=expand(t,t.length>e.length?t.length+1:e.length+1);return add_(n,e),trim(n,1)}function inverseMod(t,e){var n=expand(t,e.length);return inverseMod_(n,e)?trim(n,1):null}function multMod(t,e,n){var i=expand(t,n.length);return multMod_(i,e,n),trim(i,1)}function randTruePrime_(t,e){var n,i,r,s,o,a,c,h,u;if(0==primes.length&&(primes=findPrimes(3e4)),0==pows.length)for(pows=new Array(512),r=0;r<512;r++)pows[r]=Math.pow(2,r/511-1);if(.1,20,recLimit=20,s_i2.length!=t.length&&(s_i2=dup(t),s_R=dup(t),s_n1=dup(t),s_r2=dup(t),s_d=dup(t),s_x1=dup(t),s_x2=dup(t),s_b=dup(t),s_n=dup(t),s_i=dup(t),s_rm=dup(t),s_q=dup(t),s_a=dup(t),s_aa=dup(t)),e<=recLimit){for(n=(1<<(e+2>>1))-1,copyInt_(t,0),i=1;i;)for(i=0,t[0]=1|1<<e-1|Math.floor(Math.random()*(1<<e)),r=1;r<primes.length&&(primes[r]&n)==primes[r];r++)if(0==t[0]%primes[r]){i=1;break}carry_(t)}else{if(o=.1*e*e,e>40)for(s=1;e-e*s<=20;)s=pows[Math.floor(512*Math.random())];else s=.5;for(u=Math.floor(s*e)+1,randTruePrime_(s_q,u),copyInt_(s_i2,0),s_i2[Math.floor((e-2)/bpe)]|=1<<(e-2)%bpe,divide_(s_i2,s_q,s_i,s_rm),c=bitSize(s_i);;){for(;randBigInt_(s_R,c,0),!greater(s_i,s_R););for(addInt_(s_R,1),add_(s_R,s_i),copy_(s_n,s_q),mult_(s_n,s_R),multInt_(s_n,2),addInt_(s_n,1),copy_(s_r2,s_R),multInt_(s_r2,2),a=0,r=0;r<primes.length&&primes[r]<o;r++)if(0==modInt(s_n,primes[r])&&!equalsInt(s_n,primes[r])){a=1;break}if(a||millerRabinInt(s_n,2)||(a=1),!a){for(addInt_(s_n,-3),r=s_n.length-1;0==s_n[r]&&r>0;r--);for(h=0,w=s_n[r];w;w>>=1,h++);for(h+=bpe*r;randBigInt_(s_a,h,0),!greater(s_n,s_a););if(addInt_(s_n,3),addInt_(s_a,2),copy_(s_b,s_a),copy_(s_n1,s_n),addInt_(s_n1,-1),powMod_(s_b,s_n1,s_n),addInt_(s_b,-1),isZero(s_b)&&(copy_(s_b,s_a),powMod_(s_b,s_r2,s_n),addInt_(s_b,-1),copy_(s_aa,s_n),copy_(s_d,s_b),GCD_(s_d,s_n),equalsInt(s_d,1)))return void copy_(t,s_aa)}}}}function randBigInt(t,e){var n;return randBigInt_(n=int2bigInt(0,0,Math.floor((t-1)/bpe)+2),t,e),n}function randBigInt_(t,e,n){var i,r;for(i=0;i<t.length;i++)t[i]=0;for(r=Math.floor((e-1)/bpe)+1,i=0;i<r;i++)t[i]=Math.floor(Math.random()*(1<<bpe-1));t[r-1]&=(2<<(e-1)%bpe)-1,1==n&&(t[r-1]|=1<<(e-1)%bpe)}function GCD(t,e){var n;return GCD_(n=dup(t),dup(e)),n}function GCD_(e,n){var i,r,s,o,a,c,h,u,p;for(T.length!=e.length&&(T=dup(e)),p=1;p;){for(p=0,i=1;i<n.length;i++)if(n[i]){p=1;break}if(!p)break;for(i=e.length;!e[i]&&i>=0;i--);for(r=e[i],s=n[i],o=1,a=0,c=0,h=1;s+c&&s+h&&(u=Math.floor((r+o)/(s+c)),qp=Math.floor((r+a)/(s+h)),u==qp);)t=o-u*c,o=c,c=t,t=a-u*h,a=h,h=t,t=r-u*s,r=s,s=t;a?(copy_(T,e),linComb_(e,n,o,a),linComb_(n,T,h,c)):(mod_(e,n),copy_(T,e),copy_(e,n),copy_(n,T))}if(0!=n[0])for(t=modInt(e,n[0]),copyInt_(e,n[0]),n[0]=t;n[0];)e[0]%=n[0],t=e[0],e[0]=n[0],n[0]=t}function inverseMod_(t,e){var n=1+2*Math.max(t.length,e.length);if(!(1&t[0]||1&e[0]))return copyInt_(t,0),0;for(eg_u.length!=n&&(eg_u=new Array(n),eg_v=new Array(n),eg_A=new Array(n),eg_B=new Array(n),eg_C=new Array(n),eg_D=new Array(n)),copy_(eg_u,t),copy_(eg_v,e),copyInt_(eg_A,1),copyInt_(eg_B,0),copyInt_(eg_C,0),copyInt_(eg_D,1);;){for(;!(1&eg_u[0]);)halve_(eg_u),1&eg_A[0]||1&eg_B[0]?(add_(eg_A,e),halve_(eg_A),sub_(eg_B,t),halve_(eg_B)):(halve_(eg_A),halve_(eg_B));for(;!(1&eg_v[0]);)halve_(eg_v),1&eg_C[0]||1&eg_D[0]?(add_(eg_C,e),halve_(eg_C),sub_(eg_D,t),halve_(eg_D)):(halve_(eg_C),halve_(eg_D));if(greater(eg_v,eg_u)?(sub_(eg_v,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,eg_v),sub_(eg_A,eg_C),sub_(eg_B,eg_D)),equalsInt(eg_u,0))return negative(eg_C)&&add_(eg_C,e),copy_(t,eg_C),equalsInt(eg_v,1)?1:(copyInt_(t,0),0)}}function inverseModInt(t,e){for(var n=1,i=0;;){if(1==t)return n;if(0==t)return 0;if(i-=n*Math.floor(e/t),1==(e%=t))return i;if(0==e)return 0;n-=i*Math.floor(t/e),t%=e}}function inverseModInt_(t,e){return inverseModInt(t,e)}function eGCD_(t,e,n,i,r){var s=0,o=Math.max(t.length,e.length);for(eg_u.length!=o&&(eg_u=new Array(o),eg_A=new Array(o),eg_B=new Array(o),eg_C=new Array(o),eg_D=new Array(o));!(1&t[0]||1&e[0]);)halve_(t),halve_(e),s++;for(copy_(eg_u,t),copy_(n,e),copyInt_(eg_A,1),copyInt_(eg_B,0),copyInt_(eg_C,0),copyInt_(eg_D,1);;){for(;!(1&eg_u[0]);)halve_(eg_u),1&eg_A[0]||1&eg_B[0]?(add_(eg_A,e),halve_(eg_A),sub_(eg_B,t),halve_(eg_B)):(halve_(eg_A),halve_(eg_B));for(;!(1&n[0]);)halve_(n),1&eg_C[0]||1&eg_D[0]?(add_(eg_C,e),halve_(eg_C),sub_(eg_D,t),halve_(eg_D)):(halve_(eg_C),halve_(eg_D));if(greater(n,eg_u)?(sub_(n,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,n),sub_(eg_A,eg_C),sub_(eg_B,eg_D)),equalsInt(eg_u,0))return negative(eg_C)&&(add_(eg_C,e),sub_(eg_D,t)),multInt_(eg_D,-1),copy_(i,eg_C),copy_(r,eg_D),void leftShift_(n,s)}}function negative(t){return t[t.length-1]>>bpe-1&1}function greaterShift(t,e,n){var i,r=t.length,s=e.length;for(k=r+n<s?r+n:s,i=s-1-n;i<r&&i>=0;i++)if(t[i]>0)return 1;for(i=r-1+n;i<s;i++)if(e[i]>0)return 0;for(i=k-1;i>=n;i--){if(t[i-n]>e[i])return 1;if(t[i-n]<e[i])return 0}return 0}function greater(t,e){var n,i=t.length<e.length?t.length:e.length;for(n=t.length;n<e.length;n++)if(e[n])return 0;for(n=e.length;n<t.length;n++)if(t[n])return 1;for(n=i-1;n>=0;n--){if(t[n]>e[n])return 1;if(t[n]<e[n])return 0}return 0}function divide_(t,e,n,i){var r,s,o,a,c,h,u,p;for(copy_(i,t),s=e.length;0==e[s-1];s--);for(p=e[s-1],u=0;p;u++)p>>=1;for(leftShift_(e,u=bpe-u),leftShift_(i,u),r=i.length;0==i[r-1]&&r>s;r--);for(copyInt_(n,0);!greaterShift(e,i,r-s);)subShift_(i,e,r-s),n[r-s]++;for(o=r-1;o>=s;o--){for(i[o]==e[s-1]?n[o-s]=mask:n[o-s]=Math.floor((i[o]*radix+i[o-1])/e[s-1]);h=(c=(s>1?e[s-2]:0)*n[o-s])>>bpe,c&=mask,h=(a=h+n[o-s]*e[s-1])>>bpe,a&=mask,h==i[o]?a==i[o-1]?c>(o>1?i[o-2]:0):a>i[o-1]:h>i[o];)n[o-s]--;linCombShift_(i,e,-n[o-s],o-s),negative(i)&&(addShift_(i,e,o-s),n[o-s]--)}rightShift_(e,u),rightShift_(i,u)}function carry_(t){var e,n,i,r;for(n=t.length,i=0,e=0;e<n;e++)r=0,(i+=t[e])<0&&(i+=(r=-(i>>bpe))*radix),t[e]=i&mask,i=(i>>bpe)-r}function modInt(t,e){var n,i=0;for(n=t.length-1;n>=0;n--)i=(i*radix+t[n])%e;return i}function int2bigInt(t,e,n){var i;return i=n>(i=Math.ceil(e/bpe)+1)?n:i,buff=new Array(i),copyInt_(buff,t),buff}function str2bigInt(t,e,n){var i,r,s,o,a,c=t.length;if(-1==e){for(s=new Array(0);;){for(o=new Array(s.length+1),r=0;r<s.length;r++)o[r+1]=s[r];if(o[0]=parseInt(t,10),s=o,(i=t.indexOf(",",0))<1)break;if(0==(t=t.substring(i+1)).length)break}return s.length<n?(copy_(o=new Array(n),s),o):s}for(s=int2bigInt(0,e*c,0),r=0;r<c&&(i=digitsStr.indexOf(t.substring(r,r+1),0),e<=36&&i>=36&&(i-=26),!(i>=e||i<0));r++)multInt_(s,e),addInt_(s,i);for(c=s.length;c>0&&!s[c-1];c--);for(c=n>c+1?n:c+1,o=new Array(c),a=c<s.length?c:s.length,r=0;r<a;r++)o[r]=s[r];for(;r<c;r++)o[r]=0;return o}function equalsInt(t,e){var n;if(t[0]!=e)return 0;for(n=1;n<t.length;n++)if(t[n])return 0;return 1}function equals(t,e){var n,i=t.length<e.length?t.length:e.length;for(n=0;n<i;n++)if(t[n]!=e[n])return 0;if(t.length>e.length){for(;n<t.length;n++)if(t[n])return 0}else for(;n<e.length;n++)if(e[n])return 0;return 1}function isZero(t){var e;for(e=0;e<t.length;e++)if(t[e])return 0;return 1}function bigInt2str(t,e){var n,i,r="";if(s6.length!=t.length?s6=dup(t):copy_(s6,t),-1==e){for(n=t.length-1;n>0;n--)r+=t[n]+",";r+=t[0]}else for(;!isZero(s6);)i=divInt_(s6,e),r=digitsStr.substring(i,i+1)+r;return 0==r.length&&(r="0"),r}function dup(t){return buff=new Array(t.length),copy_(buff,t),buff}function copy_(t,e){var n,i=t.length<e.length?t.length:e.length;for(n=0;n<i;n++)t[n]=e[n];for(n=i;n<t.length;n++)t[n]=0}function copyInt_(t,e){var n,i;for(i=e,n=0;n<t.length;n++)t[n]=i&mask,i>>=bpe}function addInt_(t,e){var n,i,r,s;for(t[0]+=e,i=t.length,r=0,n=0;n<i;n++)if(s=0,(r+=t[n])<0&&(r+=(s=-(r>>bpe))*radix),t[n]=r&mask,!(r=(r>>bpe)-s))return}function rightShift_(t,e){var n,i=Math.floor(e/bpe);if(i){for(n=0;n<t.length-i;n++)t[n]=t[n+i];for(;n<t.length;n++)t[n]=0;e%=bpe}for(n=0;n<t.length-1;n++)t[n]=mask&(t[n+1]<<bpe-e|t[n]>>e);t[n]>>=e}function halve_(t){var e;for(e=0;e<t.length-1;e++)t[e]=mask&(t[e+1]<<bpe-1|t[e]>>1);t[e]=t[e]>>1|t[e]&radix>>1}function leftShift_(t,e){var n,i=Math.floor(e/bpe);if(i){for(n=t.length;n>=i;n--)t[n]=t[n-i];for(;n>=0;n--)t[n]=0;e%=bpe}if(e){for(n=t.length-1;n>0;n--)t[n]=mask&(t[n]<<e|t[n-1]>>bpe-e);t[n]=mask&t[n]<<e}}function multInt_(t,e){var n,i,r,s;if(e)for(i=t.length,r=0,n=0;n<i;n++)s=0,(r+=t[n]*e)<0&&(r+=(s=-(r>>bpe))*radix),t[n]=r&mask,r=(r>>bpe)-s}function divInt_(t,e){var n,i,r=0;for(n=t.length-1;n>=0;n--)i=r*radix+t[n],t[n]=Math.floor(i/e),r=i%e;return r}function linComb_(t,e,n,i){var r,s,o,a;for(o=t.length<e.length?t.length:e.length,a=t.length,s=0,r=0;r<o;r++)s+=n*t[r]+i*e[r],t[r]=s&mask,s>>=bpe;for(r=o;r<a;r++)s+=n*t[r],t[r]=s&mask,s>>=bpe}function linCombShift_(t,e,n,i){var r,s,o,a;for(o=t.length<i+e.length?t.length:i+e.length,a=t.length,s=0,r=i;r<o;r++)s+=t[r]+n*e[r-i],t[r]=s&mask,s>>=bpe;for(r=o;s&&r<a;r++)s+=t[r],t[r]=s&mask,s>>=bpe}function addShift_(t,e,n){var i,r,s,o;for(s=t.length<n+e.length?t.length:n+e.length,o=t.length,r=0,i=n;i<s;i++)r+=t[i]+e[i-n],t[i]=r&mask,r>>=bpe;for(i=s;r&&i<o;i++)r+=t[i],t[i]=r&mask,r>>=bpe}function subShift_(t,e,n){var i,r,s,o;for(s=t.length<n+e.length?t.length:n+e.length,o=t.length,r=0,i=n;i<s;i++)r+=t[i]-e[i-n],t[i]=r&mask,r>>=bpe;for(i=s;r&&i<o;i++)r+=t[i],t[i]=r&mask,r>>=bpe}function sub_(t,e){var n,i,r;for(r=t.length<e.length?t.length:e.length,i=0,n=0;n<r;n++)i+=t[n]-e[n],t[n]=i&mask,i>>=bpe;for(n=r;i&&n<t.length;n++)i+=t[n],t[n]=i&mask,i>>=bpe}function add_(t,e){var n,i,r;for(r=t.length<e.length?t.length:e.length,i=0,n=0;n<r;n++)i+=t[n]+e[n],t[n]=i&mask,i>>=bpe;for(n=r;i&&n<t.length;n++)i+=t[n],t[n]=i&mask,i>>=bpe}function mult_(t,e){var n;for(ss.length!=2*t.length&&(ss=new Array(2*t.length)),copyInt_(ss,0),n=0;n<e.length;n++)e[n]&&linCombShift_(ss,t,e[n],n);copy_(t,ss)}function mod_(t,e){s4.length!=t.length?s4=dup(t):copy_(s4,t),s5.length!=t.length&&(s5=dup(t)),divide_(s4,e,s5,t)}function multMod_(t,e,n){var i;for(s0.length!=2*t.length&&(s0=new Array(2*t.length)),copyInt_(s0,0),i=0;i<e.length;i++)e[i]&&linCombShift_(s0,t,e[i],i);mod_(s0,n),copy_(t,s0)}function squareMod_(t,e){var n,i,r,s,o;for(s=t.length;s>0&&!t[s-1];s--);for(o=s>e.length?2*s:2*e.length,s0.length!=o&&(s0=new Array(o)),copyInt_(s0,0),n=0;n<s;n++){for(r=s0[2*n]+t[n]*t[n],s0[2*n]=r&mask,r>>=bpe,i=n+1;i<s;i++)r=s0[n+i]+2*t[n]*t[i]+r,s0[n+i]=r&mask,r>>=bpe;s0[n+s]=r}mod_(s0,e),copy_(t,s0)}function trim(t,e){var n,i;for(n=t.length;n>0&&!t[n-1];n--);return copy_(i=new Array(n+e),t),i}function powMod_(t,e,n){var i,r,s,o;if(s7.length!=n.length&&(s7=dup(n)),0!=(1&n[0])){for(copyInt_(s7,0),s=n.length;s>0&&!n[s-1];s--);for(o=radix-inverseModInt(modInt(n,radix),radix),s7[s]=1,multMod_(t,s7,n),s3.length!=t.length?s3=dup(t):copy_(s3,t),i=e.length-1;i>0&!e[i];i--);if(0!=e[i]){for(r=1<<bpe-1;r&&!(e[i]&r);r>>=1);for(;;){if(!(r>>=1)){if(--i<0)return void mont_(t,one,n,o);r=1<<bpe-1}mont_(t,t,n,o),r&e[i]&&mont_(t,s3,n,o)}}else copyInt_(t,1)}else for(copy_(s7,t),copyInt_(t,1);!equalsInt(e,0);)1&e[0]&&multMod_(t,s7,n),divInt_(e,2),squareMod_(s7,n)}function mont_(t,e,n,i){var r,s,o,a,c,h,u=n.length,p=e.length;for(sa.length!=u&&(sa=new Array(u)),copyInt_(sa,0);u>0&&0==n[u-1];u--);for(;p>0&&0==e[p-1];p--);for(h=sa.length-1,r=0;r<u;r++){for(o=(c=sa[0]+t[r]*e[0])+(a=(c&mask)*i&mask)*n[0]>>bpe,c=t[r],s=1;s<p-4;)o+=sa[s]+a*n[s]+c*e[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s]+c*e[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s]+c*e[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s]+c*e[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s]+c*e[s],sa[s-1]=o&mask,o>>=bpe,s++;for(;s<p;)o+=sa[s]+a*n[s]+c*e[s],sa[s-1]=o&mask,o>>=bpe,s++;for(;s<u-4;)o+=sa[s]+a*n[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s],sa[s-1]=o&mask,o>>=bpe,s++,o+=sa[s]+a*n[s],sa[s-1]=o&mask,o>>=bpe,s++;for(;s<u;)o+=sa[s]+a*n[s],sa[s-1]=o&mask,o>>=bpe,s++;for(;s<h;)o+=sa[s],sa[s-1]=o&mask,o>>=bpe,s++;sa[s-1]=o&mask}greater(n,sa)||sub_(sa,n),copy_(t,sa)}bpe>>=1,mask=(1<<bpe)-1,radix=mask+1,one=int2bigInt(1,1,1),t=new Array(0),ss=t,s0=t,s1=t,s2=t,s3=t,s4=t,s5=t,s6=t,s7=t,T=t,sa=t,mr_x1=t,mr_r=t,mr_a=t,eg_v=t,eg_u=t,eg_A=t,eg_B=t,eg_C=t,eg_D=t,md_q1=t,md_q2=t,md_q3=t,md_r=t,md_r1=t,md_r2=t,md_tt=t,primes=t,pows=t,s_i=t,s_i2=t,s_R=t,s_rm=t,s_q=t,s_n1=t,s_a=t,s_r2=t,s_n=t,s_b=t,s_d=t,s_x1=t,s_x2=t,s_aa=t,rpprb=t;var blowfish=function(t){var e,n,i,r,s,o=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],a=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],c=[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],h=[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],u=[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462];function p(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function l(t,e){return(255&t.charCodeAt(e++))<<24|(255&t.charCodeAt(e++))<<16|(255&t.charCodeAt(e++))<<8|255&t.charCodeAt(e++)}function d(t,e){return p(l(t,0)^l(e,0))+p(l(t,4)^l(e,4))}function f(t){return(n[t>>24&255]+i[t>>16&255]^r[t>>8&255])+s[255&t]^0}function _(t){for(var n,i=0,r=l(t,0),s=l(t,4);i<16;)n=r^=e[i++],r=s^=f(r),s=n;return r^=e[i++],p(s^=e[i])+p(r)}function E(t){for(var n,i=17,r=l(t,0),s=l(t,4);i>1;)n=r^=e[i--],r=s^=f(r),s=n;return r^=e[i--],p(s^=e[i])+p(r)}function y(t){var p,d="\0\0\0\0\0\0\0\0";for(e=o.slice(),n=a.slice(),i=c.slice(),r=h.slice(),s=u.slice();t.length<72;)t+=t;for(p=0;p<18;)e[p]^=l(t,p<<2),p++;for(p=0;p<18;)d=_(d),e[p++]=l(d,0),e[p++]=l(d,4);for(p=0;p<256;)d=_(d),n[p++]=l(d,0),n[p++]=l(d,4);for(p=0;p<256;)d=_(d),i[p++]=l(d,0),i[p++]=l(d,4);for(p=0;p<256;)d=_(d),r[p++]=l(d,0),r[p++]=l(d,4);for(p=0;p<256;)d=_(d),s[p++]=l(d,0),s[p++]=l(d,4)}return{encrypt:function(t){var e,n,i,r=[],s=t.data||"",o=t.key||"\0",a=t.mode||"ecb",c=t.pchar||"";if(y(o),s=function(t){for(var e,n=0,i=t.length,r=String.fromCharCode,s=[];n<i;)(e=t.charCodeAt(n++))<128?s.push(r(e)):e<2048?s.push(r(e>>6&31|192,63&e|128)):e<65536?s.push(r(e>>12&15|224,e>>6&63|128,63&e|128)):e<2097152&&s.push(r(e>>18&7|240,e>>12&63|128,e>>6&63|128,63&e|128));return s.join("")}(s),s+=new Array((8-s.length%8)%8+1).join(c),"cbc"==a)for(i=t.iv||"\0\0\0\0\0\0\0\0",r.push(i),e=0;e<s.length;)n=_(d(s.substr(e,8),i)),r.push(n),i=n,e+=8;else for(e=0;e<s.length;)r.push(_(s.substr(e,8))),e+=8;return r.join("")},decrypt:function(t){var e,n,i,r=[],s=t.data||"",o=t.key||"\0",a=t.mode||"ecb",c=t.pchar||"";if(y(o),s+=new Array((8-s.length%8)%8+1).join("\0"),"cbc"==a)for(i=s.substr(0,8)||"\0\0\0\0\0\0\0\0",e=8;e<s.length;)n=s.substr(e,8),r.push(d(E(n),i)),i=n,e+=8;else for(e=0;e<s.length;)r.push(E(s.substr(e,8))),e+=8;return function(t){for(var e,n=0,i=t.length,r=String.fromCharCode,s=[];n<i;)0==(128&(e=t.charCodeAt(n++)))?s.push(r(255&e)):192==(224&e)?n<i&&s.push(r(e<<6&1984|63&t.charCodeAt(n++))):224==(240&e)?n+1<i&&s.push(r(e<<12&61440|t.charCodeAt(n++)<<6&4032|63&t.charCodeAt(n++))):240==(248&e)&&n+2<i&&s.push(r(e<<18&1835008|t.charCodeAt(n++)<<12&258048|t.charCodeAt(n++)<<6&4032|63&t.charCodeAt(n++)));return s.join("")}(s=r.join("").replace(new RegExp(c+"+$"),""))},mkIV:function(){return p(4294967296*Math.random())+p(4294967296*Math.random())}}}(),md5=function(t){var e=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],n=[3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745],i=""+new Array(64).join("\0");function r(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}function s(t,e){return 255&t.charCodeAt(e++)|(255&t.charCodeAt(e++))<<8|(255&t.charCodeAt(e++))<<16|t.charCodeAt(e++)<<24}return{bin:function(t){var o,a,c,h,u,p,l,d,f,_=1732584193,E=4023233417,y=2562383102,m=271733878,R=new Array(16);for(t+=i.slice(0,64-(t.length+8)%64)+r(t.length<<3)+r(0),d=0;d<t.length;d+=64){for(f=0;f<16;f++)R[f]=s(t,d+(f<<2));for(o=_,a=E,c=y,h=m,f=0;f<64;f++)f<16?(u=a&c|~a&h,p=f):f<32?(u=h&a|~h&c,p=5*f+1&15):f<48?(u=a^c^h,p=3*f+5&15):(u=c^(a|~h),p=7*f&15),l=o+u+n[f]+R[p]|0,o=h,h=c,c=a,a=(l=l<<e[f]|l>>>32-e[f])+a|0;_=_+o|0,E=E+a|0,y=y+c|0,m=m+h|0}return r(_)+r(E)+r(y)+r(m)}}}();(function(){var t=void 0,e=this;function n(n,i){var r,s=n.split("."),o=e;!(s[0]in o)&&o.execScript&&o.execScript("var "+s[0]);for(;s.length&&(r=s.shift());)s.length||i===t?o=o[r]?o[r]:o[r]={}:o[r]=i}var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function r(t){var e,n,r,s,o,a,c,h,u,p,l=t.length,d=0,f=Number.POSITIVE_INFINITY;for(h=0;h<l;++h)t[h]>d&&(d=t[h]),t[h]<f&&(f=t[h]);for(e=1<<d,n=new(i?Uint32Array:Array)(e),r=1,s=0,o=2;r<=d;){for(h=0;h<l;++h)if(t[h]===r){for(a=0,c=s,u=0;u<r;++u)a=a<<1|1&c,c>>=1;for(p=r<<16|h,u=a;u<e;u+=o)n[u]=p;++s}++r,s<<=1,o<<=1}return[n,d,f]}function s(t,e){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=i?new Uint8Array(t):t,this.m=!1,this.i=a,this.r=!1,!e&&(e={})||(e.index&&(this.a=e.index),e.bufferSize&&(this.h=e.bufferSize),e.bufferType&&(this.i=e.bufferType),e.resize&&(this.r=e.resize)),this.i){case o:this.b=32768,this.c=new(i?Uint8Array:Array)(32768+this.h+258);break;case a:this.b=0,this.c=new(i?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}var o=0,a=1,c={t:o,s:a};s.prototype.k=function(){for(;!this.m;){var e=A(this,3);switch(1&e&&(this.m=!0),e>>>=1){case 0:var n=this.input,s=this.a,c=this.c,h=this.b,u=n.length,p=t,d=c.length,f=t;if(this.d=this.f=0,s+1>=u)throw Error("invalid uncompressed block header: LEN");if(p=n[s++]|n[s++]<<8,s+1>=u)throw Error("invalid uncompressed block header: NLEN");if(p===~(n[s++]|n[s++]<<8))throw Error("invalid uncompressed block header: length verify");if(s+p>n.length)throw Error("input buffer is broken");switch(this.i){case o:for(;h+p>c.length;){if(p-=f=d-h,i)c.set(n.subarray(s,s+f),h),h+=f,s+=f;else for(;f--;)c[h++]=n[s++];this.b=h,c=this.e(),h=this.b}break;case a:for(;h+p>c.length;)c=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(i)c.set(n.subarray(s,s+p),h),h+=p,s+=p;else for(;p--;)c[h++]=n[s++];this.a=s,this.b=h,this.c=c;break;case 1:this.j(S,P);break;case 2:var _,E,y,m,R=A(this,5)+257,g=A(this,5)+1,O=A(this,4)+4,v=new(i?Uint8Array:Array)(l.length),b=t,T=t,I=t,N=t,D=t;for(D=0;D<O;++D)v[l[D]]=A(this,3);if(!i)for(D=O,O=v.length;D<O;++D)v[l[D]]=0;for(_=r(v),b=new(i?Uint8Array:Array)(R+g),D=0,m=R+g;D<m;)switch(T=C(this,_)){case 16:for(N=3+A(this,2);N--;)b[D++]=I;break;case 17:for(N=3+A(this,3);N--;)b[D++]=0;I=0;break;case 18:for(N=11+A(this,7);N--;)b[D++]=0;I=0;break;default:I=b[D++]=T}E=r(i?b.subarray(0,R):b.slice(0,R)),y=r(i?b.subarray(R):b.slice(R)),this.j(E,y);break;default:throw Error("unknown BTYPE: "+e)}}return this.n()};var h,u,p=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l=i?new Uint16Array(p):p,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],f=i?new Uint16Array(d):d,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],E=i?new Uint8Array(_):_,y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],m=i?new Uint16Array(y):y,R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],g=i?new Uint8Array(R):R,O=new(i?Uint8Array:Array)(288);for(h=0,u=O.length;h<u;++h)O[h]=143>=h?8:255>=h?9:279>=h?7:8;var v,b,S=r(O),T=new(i?Uint8Array:Array)(30);for(v=0,b=T.length;v<b;++v)T[v]=5;var P=r(T);function A(t,e){for(var n,i=t.f,r=t.d,s=t.input,o=t.a,a=s.length;r<e;){if(o>=a)throw Error("input buffer is broken");i|=s[o++]<<r,r+=8}return n=i&(1<<e)-1,t.f=i>>>e,t.d=r-e,t.a=o,n}function C(t,e){for(var n,i,r=t.f,s=t.d,o=t.input,a=t.a,c=o.length,h=e[0],u=e[1];s<u&&!(a>=c);)r|=o[a++]<<s,s+=8;if((i=(n=h[r&(1<<u)-1])>>>16)>s)throw Error("invalid code length: "+i);return t.f=r>>i,t.d=s-i,t.a=a,65535&n}function I(t,e){var n,i;switch(this.input=t,this.a=0,!e&&(e={})||(e.index&&(this.a=e.index),e.verify&&(this.A=e.verify)),n=t[this.a++],i=t[this.a++],15&n){case N:this.method=N;break;default:throw Error("unsupported compression method")}if(0!=((n<<8)+i)%31)throw Error("invalid fcheck flag:"+((n<<8)+i)%31);if(32&i)throw Error("fdict flag is not supported");this.q=new s(t,{index:this.a,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})}s.prototype.j=function(t,e){var n=this.c,i=this.b;this.o=t;for(var r,s,o,a,c=n.length-258;256!==(r=C(this,t));)if(256>r)i>=c&&(this.b=i,n=this.e(),i=this.b),n[i++]=r;else for(a=f[s=r-257],0<E[s]&&(a+=A(this,E[s])),r=C(this,e),o=m[r],0<g[r]&&(o+=A(this,g[r])),i>=c&&(this.b=i,n=this.e(),i=this.b);a--;)n[i]=n[i++-o];for(;8<=this.d;)this.d-=8,this.a--;this.b=i},s.prototype.w=function(t,e){var n=this.c,i=this.b;this.o=t;for(var r,s,o,a,c=n.length;256!==(r=C(this,t));)if(256>r)i>=c&&(c=(n=this.e()).length),n[i++]=r;else for(a=f[s=r-257],0<E[s]&&(a+=A(this,E[s])),r=C(this,e),o=m[r],0<g[r]&&(o+=A(this,g[r])),i+a>c&&(c=(n=this.e()).length);a--;)n[i]=n[i++-o];for(;8<=this.d;)this.d-=8,this.a--;this.b=i},s.prototype.e=function(){var t,e,n=new(i?Uint8Array:Array)(this.b-32768),r=this.b-32768,s=this.c;if(i)n.set(s.subarray(32768,n.length));else for(t=0,e=n.length;t<e;++t)n[t]=s[t+32768];if(this.g.push(n),this.l+=n.length,i)s.set(s.subarray(r,r+32768));else for(t=0;32768>t;++t)s[t]=s[r+t];return this.b=32768,s},s.prototype.z=function(t){var e,n,r,s=this.input.length/this.a+1|0,o=this.input,a=this.c;return t&&("number"==typeof t.p&&(s=t.p),"number"==typeof t.u&&(s+=t.u)),2>s?n=(r=(o.length-this.a)/this.o[2]/2*258|0)<a.length?a.length+r:a.length<<1:n=a.length*s,i?(e=new Uint8Array(n)).set(a):e=a,this.c=e},s.prototype.n=function(){var t,e,n,r,s,o=0,a=this.c,c=this.g,h=new(i?Uint8Array:Array)(this.l+(this.b-32768));if(0===c.length)return i?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(e=0,n=c.length;e<n;++e)for(r=0,s=(t=c[e]).length;r<s;++r)h[o++]=t[r];for(e=32768,n=this.b;e<n;++e)h[o++]=a[e];return this.g=[],this.buffer=h},s.prototype.v=function(){var t,e=this.b;return i?this.r?(t=new Uint8Array(e)).set(this.c.subarray(0,e)):t=this.c.subarray(0,e):(this.c.length>e&&(this.c.length=e),t=this.c),this.buffer=t},I.prototype.k=function(){var t,e,n=this.input;if(t=this.q.k(),this.a=this.q.a,this.A){e=(n[this.a++]<<24|n[this.a++]<<16|n[this.a++]<<8|n[this.a++])>>>0;var i=t;if("string"==typeof i){var r,s,o=i.split("");for(r=0,s=o.length;r<s;r++)o[r]=(255&o[r].charCodeAt(0))>>>0;i=o}for(var a,c=1,h=0,u=i.length,p=0;0<u;){u-=a=1024<u?1024:u;do{h+=c+=i[p++]}while(--a);c%=65521,h%=65521}if(e!==(h<<16|c)>>>0)throw Error("invalid adler-32 checksum")}return t};var N=8;n("Zlib.Inflate",I),n("Zlib.Inflate.prototype.decompress",I.prototype.k);var D,w,M,L,k={ADAPTIVE:c.s,BLOCK:c.t};if(Object.keys)D=Object.keys(k);else for(w in D=[],M=0,k)D[M++]=w;for(M=0,L=D.length;M<L;++M)n("Zlib.Inflate.BufferType."+(w=D[M]),k[w])}).call(this),window.epson||(window.epson={}),window.epson.ePOSDevice=ePOSDevice,window.epson.ePOSDeviceConfiguration=ePOSDeviceConfiguration}(window),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ejs=t()}}(function(){return function t(e,n,i){function r(o,a){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return r(n||t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){"use strict";var i=t("fs"),r=t("path"),s=t("./utils"),o=!1,a=t("../package.json").version,c="locals",h=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],u=h.concat("cache"),p=/^\uFEFF/;function l(t,e){var r,s,o=e.views,a=/^[A-Za-z]+:\\|^\//.exec(t);if(a&&a.length)r=n.resolveInclude(t.replace(/^\/*/,""),e.root||"/",!0);else if(e.filename&&(s=n.resolveInclude(t,e.filename),i.existsSync(s)&&(r=s)),r||Array.isArray(o)&&o.some(function(e){return s=n.resolveInclude(t,e,!0),i.existsSync(s)})&&(r=s),!r)throw new Error('Could not find the include file "'+e.escapeFunction(t)+'"');return r}function d(t,e){var i,r=t.filename,s=arguments.length>1;if(t.cache){if(!r)throw new Error("cache option requires a filename");if(i=n.cache.get(r))return i;s||(e=_(r).toString().replace(p,""))}else if(!s){if(!r)throw new Error("Internal EJS error: no file name or template provided");e=_(r).toString().replace(p,"")}return i=n.compile(e,t),t.cache&&n.cache.set(r,i),i}function f(t,e,i){var r;if(!i){if("function"==typeof n.promiseImpl)return new n.promiseImpl(function(n,i){try{n(r=d(t)(e))}catch(s){i(s)}});throw new Error("Please provide a callback function")}try{r=d(t)(e)}catch(s){return i(s)}i(null,r)}function _(t){return n.fileLoader(t)}function E(t,e,n,i,r){var s=e.split("\n"),o=Math.max(i-3,0),a=Math.min(s.length,i+3),c=r(n),h=s.slice(o,a).map(function(t,e){var n=e+o+1;return(n==i?" >> ":"    ")+n+"| "+t}).join("\n");throw t.path=c,t.message=(c||"ejs")+":"+i+"\n"+h+"\n\n"+t.message,t}function y(t){return t.replace(/;(\s*$)/,"$1")}function m(t,e){e=e||{};var i={};this.templateText=t,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",this.dependencies=[],i.client=e.client||!1,i.escapeFunction=e.escape||e.escapeFunction||s.escapeXML,i.compileDebug=!1!==e.compileDebug,i.debug=!!e.debug,i.filename=e.filename,i.openDelimiter=e.openDelimiter||n.openDelimiter||"<",i.closeDelimiter=e.closeDelimiter||n.closeDelimiter||">",i.delimiter=e.delimiter||n.delimiter||"%",i.strict=e.strict||!1,i.context=e.context,i.cache=e.cache||!1,i.rmWhitespace=e.rmWhitespace,i.root=e.root,i.outputFunctionName=e.outputFunctionName,i.localsName=e.localsName||n.localsName||c,i.views=e.views,i.async=e.async,i.strict?i._with=!1:i._with=void 0===e._with||e._with,this.opts=i,this.regex=this.createRegex()}n.cache=s.cache,n.fileLoader=i.readFileSync,n.localsName=c,n.promiseImpl=new Function("return this;")().Promise,n.resolveInclude=function(t,e,n){var i=r.dirname,s=r.extname,o=(0,r.resolve)(n?e:i(e),t);return s(t)||(o+=".ejs"),o},n.compile=function(t,e){return e&&e.scope&&(o||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),o=!0),e.context||(e.context=e.scope),delete e.scope),new m(t,e).compile()},n.render=function(t,e,n){var i=e||{},r=n||{};return 2==arguments.length&&s.shallowCopyFromList(r,i,h),d(r,t)(i)},n.renderFile=function(){var t,e,n,i=Array.prototype.slice.call(arguments),r=i.shift(),o={filename:r};return"function"==typeof arguments[arguments.length-1]&&(t=i.pop()),i.length?(e=i.shift(),i.length?s.shallowCopy(o,i.pop()):(e.settings&&(e.settings.views&&(o.views=e.settings.views),e.settings["view cache"]&&(o.cache=!0),(n=e.settings["view options"])&&s.shallowCopy(o,n)),s.shallowCopyFromList(o,e,u)),o.filename=r):e={},f(o,e,t)},n.Template=m,n.clearCache=function(){n.cache.reset()},m.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},m.prototype={createRegex:function(){var t="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",e=s.escapeRegExpChars(this.opts.delimiter),n=s.escapeRegExpChars(this.opts.openDelimiter),i=s.escapeRegExpChars(this.opts.closeDelimiter);return t=t.replace(/%/g,e).replace(/</g,n).replace(/>/g,i),new RegExp(t)},compile:function(){var t,e,n,i=this.opts,r="",o="",a=i.escapeFunction;this.source||(this.generateSource(),r+="  var __output = [], __append = __output.push.bind(__output);\n",i.outputFunctionName&&(r+="  var "+i.outputFunctionName+" = __append;\n"),!1!==i._with&&(r+="  with ("+i.localsName+" || {}) {\n",o+="  }\n"),o+='  return __output.join("");\n',this.source=r+this.source+o),t=i.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+(i.filename?JSON.stringify(i.filename):"undefined")+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,i.client&&(t="escapeFn = escapeFn || "+a.toString()+";\n"+t,i.compileDebug&&(t="rethrow = rethrow || "+E.toString()+";\n"+t)),i.strict&&(t='"use strict";\n'+t),i.debug&&console.log(t);try{if(i.async)try{n=new Function("return (async function(){}).constructor;")()}catch(h){throw h instanceof SyntaxError?new Error("This environment does not support async/await"):h}else n=Function;e=new n(i.localsName+", escapeFn, include, rethrow",t)}catch(h){throw h instanceof SyntaxError&&(i.filename&&(h.message+=" in "+i.filename),h.message+=" while compiling ejs\n\n",h.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",h.message+="https://github.com/RyanZim/EJS-Lint",h.async||(h.message+="\n",h.message+="Or, if you meant to create an async function, pass async: true as an option.")),h}if(i.client)return e.dependencies=this.dependencies,e;var c=function(t){return e.apply(i.context,[t||{},a,function(e,n){var r=s.shallowCopy({},t);return n&&(r=s.shallowCopy(r,n)),function(t,e){var n=s.shallowCopy({},e);return n.filename=l(t,n),d(n)}(e,i)(r)},E])};return c.dependencies=this.dependencies,c},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var t=this,e=this.parseTemplateText(),i=this.opts.delimiter,r=this.opts.openDelimiter,o=this.opts.closeDelimiter;e&&e.length&&e.forEach(function(a,c){var h,u,d,f,E,y;if(0===a.indexOf(r+i)&&0!==a.indexOf(r+i+i)&&(u=e[c+2])!=i+o&&u!="-"+i+o&&u!="_"+i+o)throw new Error('Could not find matching close tag for "'+a+'".');if((d=a.match(/^\s*include\s+(\S+)/))&&(h=e[c-1])&&(h==r+i||h==r+i+"-"||h==r+i+"_"))return f=s.shallowCopy({},t.opts),E=function(t,e){var n,i,r=s.shallowCopy({},e);i=_(n=l(t,r)).toString().replace(p,""),r.filename=n;var o=new m(i,r);return o.generateSource(),{source:o.source,filename:n,template:i}}(d[1],f),y=t.opts.compileDebug?"    ; (function(){\n      var __line = 1\n      , __lines = "+JSON.stringify(E.template)+"\n      , __filename = "+JSON.stringify(E.filename)+";\n      try {\n"+E.source+"      } catch (e) {\n        rethrow(e, __lines, __filename, __line, escapeFn);\n      }\n    ; }).call(this)\n":"    ; (function(){\n"+E.source+"    ; }).call(this)\n",t.source+=y,void t.dependencies.push(n.resolveInclude(d[1],f.filename));t.scanLine(a)})},parseTemplateText:function(){for(var t,e=this.templateText,n=this.regex,i=n.exec(e),r=[];i;)0!==(t=i.index)&&(r.push(e.substring(0,t)),e=e.slice(t)),r.push(i[0]),e=e.slice(i[0].length),i=n.exec(e);return e&&r.push(e),r},_addOutput:function(t){if(this.truncate&&(t=t.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!t)return t;t=(t=(t=(t=t.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+t+'")\n'},scanLine:function(t){var e,n=this.opts.delimiter,i=this.opts.openDelimiter,r=this.opts.closeDelimiter;switch(e=t.split("\n").length-1,t){case i+n:case i+n+"_":this.mode=m.modes.EVAL;break;case i+n+"=":this.mode=m.modes.ESCAPED;break;case i+n+"-":this.mode=m.modes.RAW;break;case i+n+"#":this.mode=m.modes.COMMENT;break;case i+n+n:this.mode=m.modes.LITERAL,this.source+='    ; __append("'+t.replace(i+n+n,i+n)+'")\n';break;case n+n+r:this.mode=m.modes.LITERAL,this.source+='    ; __append("'+t.replace(n+n+r,n+r)+'")\n';break;case n+r:case"-"+n+r:case"_"+n+r:this.mode==m.modes.LITERAL&&this._addOutput(t),this.mode=null,this.truncate=0===t.indexOf("-")||0===t.indexOf("_");break;default:if(this.mode){switch(this.mode){case m.modes.EVAL:case m.modes.ESCAPED:case m.modes.RAW:t.lastIndexOf("//")>t.lastIndexOf("\n")&&(t+="\n")}switch(this.mode){case m.modes.EVAL:this.source+="    ; "+t+"\n";break;case m.modes.ESCAPED:this.source+="    ; __append(escapeFn("+y(t)+"))\n";break;case m.modes.RAW:this.source+="    ; __append("+y(t)+")\n";break;case m.modes.COMMENT:break;case m.modes.LITERAL:this._addOutput(t)}}else this._addOutput(t)}this.opts.compileDebug&&e&&(this.currentLine+=e,this.source+="    ; __line = "+this.currentLine+"\n")}},n.escapeXML=s.escapeXML,n.__express=n.renderFile,t.extensions&&(t.extensions[".ejs"]=function(t,e){var i=e||t.filename,r={filename:i,client:!0},s=_(i).toString(),o=n.compile(s,r);t._compile("module.exports = "+o.toString()+";",i)}),n.VERSION=a,n.name="ejs","undefined"!=typeof window&&(window.ejs=n)},{"../package.json":6,"./utils":2,fs:3,path:4}],2:[function(t,e,n){"use strict";var i=/[|\\{}()[\]^$+*?.]/g;n.escapeRegExpChars=function(t){return t?String(t).replace(i,"\\$&"):""};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},s=/[&<>'"]/g;function o(t){return r[t]||t}n.escapeXML=function(t){return null==t?"":String(t).replace(s,o)},n.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},n.shallowCopy=function(t,e){for(var n in e=e||{})t[n]=e[n];return t},n.shallowCopyFromList=function(t,e,n){for(var i=0;i<n.length;i++){var r=n[i];void 0!==e[r]&&(t[r]=e[r])}return t},n.cache={_data:{},set:function(t,e){this._data[t]=e},get:function(t){return this._data[t]},remove:function(t){delete this._data[t]},reset:function(){this._data={}}}},{}],3:[function(t,e,n){},{}],4:[function(t,e,n){(function(t){function e(t,e){for(var n=0,i=t.length-1;i>=0;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(t){return i.exec(t).slice(1)};function s(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}n.resolve=function(){for(var n="",i=!1,r=arguments.length-1;r>=-1&&!i;r--){var o=r>=0?arguments[r]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(n=o+"/"+n,i="/"===o.charAt(0))}return(i?"/":"")+(n=e(s(n.split("/"),function(t){return!!t}),!i).join("/"))||"."},n.normalize=function(t){var i=n.isAbsolute(t),r="/"===o(t,-1);return(t=e(s(t.split("/"),function(t){return!!t}),!i).join("/"))||i||(t="."),t&&r&&(t+="/"),(i?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(s(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var r=i(t.split("/")),s=i(e.split("/")),o=Math.min(r.length,s.length),a=o,c=0;c<o;c++)if(r[c]!==s[c]){a=c;break}var h=[];for(c=a;c<r.length;c++)h.push("..");return(h=h.concat(s.slice(a))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=r(t),n=e[0],i=e[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},n.basename=function(t,e){var n=r(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return r(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:5}],5:[function(t,e,n){var i,r,s=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var h,u=[],p=!1,l=-1;function d(){p&&h&&(p=!1,h.length?u=h.concat(u):l=-1,u.length&&f())}function f(){if(!p){var t=c(d);p=!0;for(var e=u.length;e;){for(h=u,u=[];++l<e;)h&&h[l].run();l=-1,e=u.length}h=null,p=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function _(t,e){this.fun=t,this.array=e}function E(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new _(t,e)),1!==u.length||p||c(f)},_.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=E,s.addListener=E,s.once=E,s.off=E,s.removeListener=E,s.removeAllListeners=E,s.emit=E,s.prependListener=E,s.prependOnceListener=E,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],6:[function(t,e,n){e.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"2.6.1",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",contributors:["Timothy Gu <timothygu99@gmail.com> (https://timothygu.github.io)"],license:"Apache-2.0",main:"./lib/ejs.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{},devDependencies:{browserify:"^13.1.1",eslint:"^4.14.0","git-directory-deploy":"^1.5.1",istanbul:"~0.4.3",jake:"^8.0.16",jsdoc:"^3.4.0","lru-cache":"^4.0.1",mocha:"^5.0.5","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"jake test",lint:'eslint "**/*.js" Jakefile',coverage:"istanbul cover node_modules/mocha/bin/_mocha",doc:"jake doc",devdoc:"jake doc[dev]"}}},{}]},{},[1])(1)});